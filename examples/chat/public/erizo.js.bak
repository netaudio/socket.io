var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.inherits=function(m,r){function k(){}k.prototype=r.prototype;m.superClass_=r.prototype;m.prototype=new k;m.prototype.constructor=m;for(var f in r)if(Object.defineProperties){var h=Object.getOwnPropertyDescriptor(r,f);h&&Object.defineProperty(m,f,h)}else m[f]=r[f]};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(m,r,k){m!=Array.prototype&&m!=Object.prototype&&(m[r]=k.value)};$jscomp.getGlobal=function(m){return"undefined"!=typeof window&&window===m?m:"undefined"!=typeof global&&null!=global?global:m};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};
$jscomp.symbolCounter_=0;$jscomp.Symbol=function(m){return $jscomp.SYMBOL_PREFIX+(m||"")+$jscomp.symbolCounter_++};$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var m=$jscomp.global.Symbol.iterator;m||(m=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[m]&&$jscomp.defineProperty(Array.prototype,m,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};
$jscomp.arrayIterator=function(m){var r=0;return $jscomp.iteratorPrototype(function(){return r<m.length?{done:!1,value:m[r++]}:{done:!0}})};$jscomp.iteratorPrototype=function(m){$jscomp.initSymbolIterator();m={next:m};m[$jscomp.global.Symbol.iterator]=function(){return this};return m};$jscomp.makeIterator=function(m){$jscomp.initSymbolIterator();var r=m[Symbol.iterator];return r?r.call(m):$jscomp.arrayIterator(m)};
$jscomp.arrayFromIterator=function(m){for(var r,k=[];!(r=m.next()).done;)k.push(r.value);return k};$jscomp.arrayFromIterable=function(m){return m instanceof Array?m:$jscomp.arrayFromIterator($jscomp.makeIterator(m))};$jscomp.owns=function(m,r){return Object.prototype.hasOwnProperty.call(m,r)};
$jscomp.polyfill=function(m,r,k,f){if(r){k=$jscomp.global;m=m.split(".");for(f=0;f<m.length-1;f++){var h=m[f];h in k||(k[h]={});k=k[h]}m=m[m.length-1];f=k[m];r=r(f);r!=f&&null!=r&&$jscomp.defineProperty(k,m,{configurable:!0,writable:!0,value:r})}};
$jscomp.polyfill("WeakMap",function(m){function r(a){$jscomp.owns(a,f)||$jscomp.defineProperty(a,f,{value:{}})}function k(a){var b=Object[a];b&&(Object[a]=function(a){r(a);return b(a)})}if(function(){if(!m||!Object.seal)return!1;try{var a=Object.seal({}),b=Object.seal({}),n=new m([[a,2],[b,3]]);if(2!=n.get(a)||3!=n.get(b))return!1;n.delete(a);n.set(b,4);return!n.has(a)&&4==n.get(b)}catch(e){return!1}}())return m;var f="$jscomp_hidden_"+Math.random().toString().substring(2);k("freeze");k("preventExtensions");
k("seal");var h=0,d=function(a){this.id_=(h+=Math.random()+1).toString();if(a){$jscomp.initSymbol();$jscomp.initSymbolIterator();a=$jscomp.makeIterator(a);for(var b;!(b=a.next()).done;)b=b.value,this.set(b[0],b[1])}};d.prototype.set=function(a,b){r(a);if(!$jscomp.owns(a,f))throw Error("WeakMap key fail: "+a);a[f][this.id_]=b;return this};d.prototype.get=function(a){return $jscomp.owns(a,f)?a[f][this.id_]:void 0};d.prototype.has=function(a){return $jscomp.owns(a,f)&&$jscomp.owns(a[f],this.id_)};d.prototype.delete=
function(a){return $jscomp.owns(a,f)&&$jscomp.owns(a[f],this.id_)?delete a[f][this.id_]:!1};return d},"es6-impl","es3");$jscomp.MapEntry=function(){};
$jscomp.polyfill("Map",function(m){if(!$jscomp.ASSUME_NO_NATIVE_MAP&&function(){if(!m||!m.prototype.entries||"function"!=typeof Object.seal)return!1;try{var a=Object.seal({x:4}),n=new m($jscomp.makeIterator([[a,"s"]]));if("s"!=n.get(a)||1!=n.size||n.get({x:4})||n.set({x:4},"t")!=n||2!=n.size)return!1;var e=n.entries(),d=e.next();if(d.done||d.value[0]!=a||"s"!=d.value[1])return!1;d=e.next();return d.done||4!=d.value[0].x||"t"!=d.value[1]||!e.next().done?!1:!0}catch(l){return!1}}())return m;$jscomp.initSymbol();
$jscomp.initSymbolIterator();var r=new WeakMap,k=function(a){this.data_={};this.head_=d();this.size=0;if(a){a=$jscomp.makeIterator(a);for(var b;!(b=a.next()).done;)b=b.value,this.set(b[0],b[1])}};k.prototype.set=function(a,d){var b=f(this,a);b.list||(b.list=this.data_[b.id]=[]);b.entry?b.entry.value=d:(b.entry={next:this.head_,previous:this.head_.previous,head:this.head_,key:a,value:d},b.list.push(b.entry),this.head_.previous.next=b.entry,this.head_.previous=b.entry,this.size++);return this};k.prototype.delete=
function(a){a=f(this,a);return a.entry&&a.list?(a.list.splice(a.index,1),a.list.length||delete this.data_[a.id],a.entry.previous.next=a.entry.next,a.entry.next.previous=a.entry.previous,a.entry.head=null,this.size--,!0):!1};k.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=d();this.size=0};k.prototype.has=function(a){return!!f(this,a).entry};k.prototype.get=function(a){return(a=f(this,a).entry)&&a.value};k.prototype.entries=function(){return h(this,function(a){return[a.key,
a.value]})};k.prototype.keys=function(){return h(this,function(a){return a.key})};k.prototype.values=function(){return h(this,function(a){return a.value})};k.prototype.forEach=function(a,d){for(var b=this.entries(),n;!(n=b.next()).done;)n=n.value,a.call(d,n[1],n[0],this)};k.prototype[Symbol.iterator]=k.prototype.entries;var f=function(b,d){var e=d&&typeof d;"object"==e||"function"==e?r.has(d)?e=r.get(d):(e=""+ ++a,r.set(d,e)):e="p_"+d;var n=b.data_[e];if(n&&$jscomp.owns(b.data_,e))for(b=0;b<n.length;b++){var l=
n[b];if(d!==d&&l.key!==l.key||d===l.key)return{id:e,list:n,index:b,entry:l}}return{id:e,list:n,index:-1,entry:void 0}},h=function(a,d){var b=a.head_;return $jscomp.iteratorPrototype(function(){if(b){for(;b.head!=a.head_;)b=b.previous;for(;b.next!=b.head;)return b=b.next,{done:!1,value:d(b)};b=null}return{done:!0,value:void 0}})},d=function(){var a={};return a.previous=a.next=a.head=a},a=0;return k},"es6-impl","es3");
$jscomp.polyfill("Array.from",function(m){return m?m:function(m,k,f){$jscomp.initSymbolIterator();k=null!=k?k:function(a){return a};var h=[],d=m[Symbol.iterator];if("function"==typeof d)for(m=d.call(m);!(d=m.next()).done;)h.push(k.call(f,d.value));else for(var d=m.length,a=0;a<d;a++)h.push(k.call(f,m[a]));return h}},"es6-impl","es3");
$jscomp.iteratorFromArray=function(m,r){$jscomp.initSymbolIterator();m instanceof String&&(m+="");var k=0,f={next:function(){if(k<m.length){var h=k++;return{value:r(h,m[h]),done:!1}}f.next=function(){return{done:!0,value:void 0}};return f.next()}};f[Symbol.iterator]=function(){return f};return f};$jscomp.polyfill("Array.prototype.keys",function(m){return m?m:function(){return $jscomp.iteratorFromArray(this,function(m){return m})}},"es6-impl","es3");$jscomp.FORCE_POLYFILL_PROMISE=!1;
$jscomp.polyfill("Promise",function(m){function r(){this.batch_=null}function k(a){return a instanceof h?a:new h(function(b,d){b(a)})}if(m&&!$jscomp.FORCE_POLYFILL_PROMISE)return m;r.prototype.asyncExecute=function(a){null==this.batch_&&(this.batch_=[],this.asyncExecuteBatch_());this.batch_.push(a);return this};r.prototype.asyncExecuteBatch_=function(){var a=this;this.asyncExecuteFunction(function(){a.executeBatch_()})};var f=$jscomp.global.setTimeout;r.prototype.asyncExecuteFunction=function(a){f(a,
0)};r.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var a=this.batch_;this.batch_=[];for(var b=0;b<a.length;++b){var d=a[b];delete a[b];try{d()}catch(e){this.asyncThrow_(e)}}}this.batch_=null};r.prototype.asyncThrow_=function(a){this.asyncExecuteFunction(function(){throw a;})};var h=function(a){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];var b=this.createResolveAndReject_();try{a(b.resolve,b.reject)}catch(n){b.reject(n)}};h.prototype.createResolveAndReject_=
function(){function a(a){return function(e){d||(d=!0,a.call(b,e))}}var b=this,d=!1;return{resolve:a(this.resolveTo_),reject:a(this.reject_)}};h.prototype.resolveTo_=function(a){if(a===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(a instanceof h)this.settleSameAsPromise_(a);else{a:switch(typeof a){case "object":var b=null!=a;break a;case "function":b=!0;break a;default:b=!1}b?this.resolveToNonPromiseObj_(a):this.fulfill_(a)}};h.prototype.resolveToNonPromiseObj_=function(a){var b=
void 0;try{b=a.then}catch(n){this.reject_(n);return}"function"==typeof b?this.settleSameAsThenable_(b,a):this.fulfill_(a)};h.prototype.reject_=function(a){this.settle_(2,a)};h.prototype.fulfill_=function(a){this.settle_(1,a)};h.prototype.settle_=function(a,b){if(0!=this.state_)throw Error("Cannot settle("+a+", "+b|"): Promise already settled in state"+this.state_);this.state_=a;this.result_=b;this.executeOnSettledCallbacks_()};h.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var a=
this.onSettledCallbacks_,b=0;b<a.length;++b)a[b].call(),a[b]=null;this.onSettledCallbacks_=null}};var d=new r;h.prototype.settleSameAsPromise_=function(a){var b=this.createResolveAndReject_();a.callWhenSettled_(b.resolve,b.reject)};h.prototype.settleSameAsThenable_=function(a,b){var d=this.createResolveAndReject_();try{a.call(b,d.resolve,d.reject)}catch(e){d.reject(e)}};h.prototype.then=function(a,b){function d(a,c){return"function"==typeof a?function(c){try{e(a(c))}catch(t){p(t)}}:c}var e,p,l=new h(function(a,
c){e=a;p=c});this.callWhenSettled_(d(a,e),d(b,p));return l};h.prototype.catch=function(a){return this.then(void 0,a)};h.prototype.callWhenSettled_=function(a,b){function n(){switch(e.state_){case 1:a(e.result_);break;case 2:b(e.result_);break;default:throw Error("Unexpected state: "+e.state_);}}var e=this;null==this.onSettledCallbacks_?d.asyncExecute(n):this.onSettledCallbacks_.push(function(){d.asyncExecute(n)})};h.resolve=k;h.reject=function(a){return new h(function(b,d){d(a)})};h.race=function(a){return new h(function(b,
d){for(var e=$jscomp.makeIterator(a),n=e.next();!n.done;n=e.next())k(n.value).callWhenSettled_(b,d)})};h.all=function(a){var b=$jscomp.makeIterator(a),d=b.next();return d.done?k([]):new h(function(a,n){function l(b){return function(l){g[b]=l;c--;0==c&&a(g)}}var g=[],c=0;do g.push(void 0),c++,k(d.value).callWhenSettled_(l(g.length-1),n),d=b.next();while(!d.done)})};return h},"es6-impl","es3");$jscomp.polyfill("Number.MAX_SAFE_INTEGER",function(){return 9007199254740991},"es6-impl","es3");
$jscomp.polyfill("Array.prototype.values",function(m){return m?m:function(){return $jscomp.iteratorFromArray(this,function(m,k){return k})}},"es6","es3");$jscomp.findInternal=function(m,r,k){m instanceof String&&(m=String(m));for(var f=m.length,h=0;h<f;h++){var d=m[h];if(r.call(k,d,h,m))return{i:h,v:d}}return{i:-1,v:void 0}};$jscomp.polyfill("Array.prototype.find",function(m){return m?m:function(m,k){return $jscomp.findInternal(this,m,k).v}},"es6-impl","es3");
$jscomp.polyfill("Object.is",function(m){return m?m:function(m,k){return m===k?0!==m||1/m===1/k:m!==m&&k!==k}},"es6-impl","es3");$jscomp.polyfill("Array.prototype.includes",function(m){return m?m:function(m,k){var f=this;f instanceof String&&(f=String(f));var h=f.length;for(k=k||0;k<h;k++)if(f[k]==m||Object.is(f[k],m))return!0;return!1}},"es7","es3");
$jscomp.checkStringArgs=function(m,r,k){if(null==m)throw new TypeError("The 'this' value for String.prototype."+k+" must not be null or undefined");if(r instanceof RegExp)throw new TypeError("First argument to String.prototype."+k+" must not be a regular expression");return m+""};$jscomp.polyfill("String.prototype.includes",function(m){return m?m:function(m,k){return-1!==$jscomp.checkStringArgs(this,m,"includes").indexOf(m,k||0)}},"es6-impl","es3");
$jscomp.polyfill("Object.assign",function(m){return m?m:function(m,k){for(var f=1;f<arguments.length;f++){var h=arguments[f];if(h)for(var d in h)$jscomp.owns(h,d)&&(m[d]=h[d])}return m}},"es6-impl","es3");$jscomp.polyfill("String.prototype.startsWith",function(m){return m?m:function(m,k){var f=$jscomp.checkStringArgs(this,m,"startsWith");m+="";var h=f.length,d=m.length;k=Math.max(0,Math.min(k|0,f.length));for(var a=0;a<d&&k<h;)if(f[k++]!=m[a++])return!1;return a>=d}},"es6-impl","es3");
$jscomp.polyfill("String.prototype.endsWith",function(m){return m?m:function(m,k){var f=$jscomp.checkStringArgs(this,m,"endsWith");m+="";void 0===k&&(k=f.length);k=Math.max(0,Math.min(k|0,f.length));for(var h=m.length;0<h&&0<k;)if(f[--k]!=m[--h])return!1;return 0>=h}},"es6-impl","es3");
var Erizo=function(m){function r(f){if(k[f])return k[f].exports;var h=k[f]={i:f,l:!1,exports:{}};m[f].call(h.exports,h,h.exports,r);h.l=!0;return h.exports}var k={};r.m=m;r.c=k;r.d=function(f,h,d){r.o(f,h)||Object.defineProperty(f,h,{configurable:!1,enumerable:!0,get:d})};r.n=function(f){var h=f&&f.__esModule?function(){return f["default"]}:function(){return f};r.d(h,"a",h);return h};r.o=function(f,h){return Object.prototype.hasOwnProperty.call(f,h)};r.p="";return r(r.s=24)}([function(m,r,k){var f=
function(){var h="";var d=function(a){console.log.apply(console,[].concat($jscomp.arrayFromIterable(a)))};var a=function(a,b){for(var g=[],c=1;c<arguments.length;++c)g[c-1]=arguments[c];c=h;a===f.DEBUG?c+="DEBUG":a===f.TRACE?c+="TRACE":a===f.INFO?c+="INFO":a===f.WARNING?c+="WARNING":a===f.ERROR&&(c+="ERROR");g=[c+": "].concat(g);if(void 0!==f.panel){for(var c="",l=0;l<g.length;l+=1)c+=g[l];f.panel.value=f.panel.value+"\n"+c}else d.apply(f,[g])},b=function(b,l,g,c){for(var e=[],d=3;d<arguments.length;++d)e[d-
3]=arguments[d];void 0===l&&g>=f.logLevel?a.apply(null,[].concat([g,"("+b+")"],$jscomp.arrayFromIterable(e))):g>=l&&a.apply(null,[].concat([g,"("+b+")"],$jscomp.arrayFromIterable(e)))},n=function(a){this.name=a};n.prototype.setLogLevel=function(a){this.level=a};n.prototype.debug=function(a){for(var l=[],g=0;g<arguments.length;++g)l[g-0]=arguments[g];b.apply(null,[].concat([this.name,this.level,f.DEBUG],$jscomp.arrayFromIterable(l)))};n.prototype.trace=function(a){for(var l=[],g=0;g<arguments.length;++g)l[g-
0]=arguments[g];b.apply(null,[].concat([this.name,this.level,f.TRACE],$jscomp.arrayFromIterable(l)))};n.prototype.info=function(a){for(var l=[],g=0;g<arguments.length;++g)l[g-0]=arguments[g];b.apply(null,[].concat([this.name,this.level,f.INFO],$jscomp.arrayFromIterable(l)))};n.prototype.warning=function(a){for(var l=[],g=0;g<arguments.length;++g)l[g-0]=arguments[g];b.apply(null,[].concat([this.name,this.level,f.WARNING],$jscomp.arrayFromIterable(l)))};n.prototype.error=function(a){for(var l=[],g=
0;g<arguments.length;++g)l[g-0]=arguments[g];b.apply(null,[].concat([this.name,this.level,f.ERROR],$jscomp.arrayFromIterable(l)))};var e=new Map;return{logLevel:0,DEBUG:0,TRACE:1,INFO:2,WARNING:3,ERROR:4,NONE:5,setLogLevel:function(a){var b=a;a>f.NONE?b=f.NONE:a<f.DEBUG&&(b=f.DEBUG);f.logLevel=b},setOutputFunction:function(a){d=a},setLogPrefix:function(a){h=a},module:function(a){if(e.has(a))return e.get(a);var b=new n(a);e.set(a,b);return b}}}();r.a=f},function(m,r,k){k.d(r,"b",function(){return h});
k.d(r,"c",function(){return d});k.d(r,"d",function(){return a});k.d(r,"e",function(){return n});k.d(r,"f",function(){return e});k.d(r,"a",function(){return b});var f=k(0).a.module("EventDispatcher"),h=function(){var a={},b={};a.addEventListener=function(a,c){void 0===b[a]&&(b[a]=[]);b[a].push(c)};a.removeEventListener=function(a,c){b[a]&&(c=b[a].indexOf(c),-1!==c&&b[a].splice(c,1))};a.removeAllListeners=function(){b={}};a.dispatchEvent=function(a){if(!a||!a.type)throw Error("Undefined event");for(var c=
b[a.type]||[],c=c.slice(0),g=0;g<c.length;g+=1)try{c[g](a)}catch(t){f.info("Error triggering event: "+a.type+", error: "+t)}};a.on=a.addEventListener;a.off=a.removeEventListener;a.emit=a.dispatchEvent;return a},d=function(){this.emitter=h()};d.prototype.addEventListener=function(a,b){this.emitter.addEventListener(a,b)};d.prototype.removeEventListener=function(a,b){this.emitter.removeEventListener(a,b)};d.prototype.dispatchEvent=function(a){this.emitter.dispatchEvent(a)};d.prototype.on=function(a,
b){this.addEventListener(a,b)};d.prototype.off=function(a,b){this.removeEventListener(a,b)};d.prototype.emit=function(a){this.dispatchEvent(a)};var a=function(a){var b={};b.type=a.type;return b},b=function(b){var e=a(b);e.stream=b.stream;e.state=b.state;return e},n=function(b){var e=a(b);e.streams=b.streams;e.message=b.message;return e},e=function(b){var e=a(b);e.stream=b.stream;e.msg=b.msg;e.origin=b.origin;e.bandwidth=b.bandwidth;e.attrs=b.attrs;return e}},function(m,r,k){var f=k(6)("ACTIVE","PASSIVE",
"ACTPASS","INACTIVE");f.byValue=function(h){return f[h.toUpperCase()]};f.toString=function(h){switch(h){case f.ACTIVE:return"active";case f.PASSIVE:return"passive";case f.ACTPASS:return"actpass";case f.INACTIVE:return"inactive";default:return null}};f.reverse=function(h){switch(h){case f.ACTIVE:return f.PASSIVE;case f.PASSIVE:return f.ACTIVE;case f.ACTPASS:return f.PASSIVE;case f.INACTIVE:return f.INACTIVE;default:return f.ACTIVE}};m.exports=f},function(m,r,k){var f=k(6)("SEND","RECV");f.byValue=
function(h){return f[h.toUpperCase()]};f.toString=function(h){switch(h){case f.SEND:return"send";case f.RECV:return"recv";default:return"unknown"}};f.reverse=function(h){switch(h){case f.SEND:return f.RECV;case f.RECV:return f.SEND;default:return f.SEND}};m.exports=f},function(m,r,k){var f=k(6)("SENDRECV","SENDONLY","RECVONLY","INACTIVE");f.byValue=function(h){return f[h.toUpperCase()]};f.toString=function(h){switch(h){case f.SENDRECV:return"sendrecv";case f.SENDONLY:return"sendonly";case f.RECVONLY:return"recvonly";
case f.INACTIVE:return"inactive";default:return"unknown"}};f.reverse=function(h){switch(h){case f.SENDRECV:return f.SENDRECV;case f.SENDONLY:return f.RECVONLY;case f.RECVONLY:return f.SENDONLY;case f.INACTIVE:return f.INACTIVE;default:return f.SENDRECV}};m.exports=f},function(m,r,k){var f=k(1);r.a=function(){var h=Object(f.b)({});h.url="";return h}},function(m,r){function k(f){for(var h=[],d=0;d<arguments.length;++d)h[d-0]=arguments[d];var a=this;if(!(this instanceof k))return new (Function.prototype.bind.apply(k,
[null].concat(Array.prototype.slice.call(h))));Array.from(h).forEach(function(b){$jscomp.initSymbol();a[b]=Symbol.for("LICODE_SEMANTIC_SDP_"+b)})}m.exports=k},function(m,r,k){r.a=function(){var f={},h={};f.add=function(d,a){h[d]=a};f.get=function(d){return h[d]};f.has=function(d){return void 0!==h[d]};f.size=function(){return Object.keys(h).length};f.forEach=function(d){for(var a=Object.keys(h),b=0;b<a.length;b+=1){var n=a[b];d(h[n],n)}};f.keys=function(){return Object.keys(h)};f.remove=function(d){delete h[d]};
f.clear=function(){h={}};return f}},function(m,r,k){(function(f){var h=k(0).a.module("ConnectionHelpers"),d=function(){var a="none";"undefined"!==typeof f&&f.exports?a="fake":null!==window.navigator.userAgent.match("Firefox")?a="mozilla":null!==window.navigator.userAgent.match("Chrome")?(a="chrome-stable",null!==window.navigator.userAgent.match("Electron")&&(a="electron")):null!==window.navigator.userAgent.match("Safari")?a="safari":null!==window.navigator.userAgent.match("AppleWebKit")&&(a="safari");
return a};r.a={GetUserMedia:function(a,b,n){b=void 0===b?function(){}:b;n=void 0===n?function(){}:n;var e,p=function(a,b,g){navigator.mediaDevices.getUserMedia(a).then(b).catch(g)},l=function(a,b,g){navigator.mediaDevices.getDisplayMedia(a).then(b).catch(g)},g=function(){switch(d()){case "electron":h.debug("message: Screen sharing in Electron");e={};e.video=a.video||{};e.video.mandatory=a.video.mandatory||{};e.video.mandatory.chromeMediaSource="desktop";e.video.mandatory.chromeMediaSourceId=a.desktopStreamId;
p(e,b,n);break;case "mozilla":h.debug("message: Screen sharing in Firefox");e={};void 0!==a.video?(e.video=a.video,e.video.mediaSource||(e.video.mediaSource="window")):e={audio:a.audio,video:{mediaSource:"window"}};p(e,b,n);break;case "chrome-stable":h.debug("message: Screen sharing in Chrome");e={};if(a.desktopStreamId)e.video=a.video||{mandatory:{}},e.video.mandatory=e.video.mandatory||{},e.video.mandatory.chromeMediaSource="desktop",e.video.mandatory.chromeMediaSourceId=a.desktopStreamId,p(e,b,
n);else{var c="okeephmleflklcdebijnponpabbmmgeo";a.extensionId&&(h.debug("message: extensionId supplied, extensionId: "+a.extensionId),c=a.extensionId);h.debug("message: Screen access on chrome stable looking for extension");try{chrome.runtime.sendMessage(c,{getStream:!0},function(c){void 0===c?(h.error("message: Access to screen denied"),n({code:"Access to screen denied"})):(c=c.streamId,void 0!==a.video.mandatory?(e.video=a.video||{mandatory:{}},e.video.mandatory.chromeMediaSource="desktop",e.video.mandatory.chromeMediaSourceId=
c):e={video:{mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:c}}},p(e,b,n))})}catch(u){h.debug("message: Screensharing plugin is not accessible"),n({code:"no_plugin_present"})}}break;default:h.error("message: This browser does not support ScreenSharing")}};a.screen?a.desktopStreamId||a.extensionId?(h.debug("message: Screen access requested using GetUserMedia"),g()):(h.debug("message: Screen access requested using GetDisplayMedia"),l(a,b,n)):"undefined"!==typeof f&&f.exports?h.error("message: Video/audio streams not supported in erizofc yet"):
(h.debug("message: Calling getUserMedia, config: "+JSON.stringify(a)),p(a,b,n))},getBrowser:d}}).call(r,k(41)(m))},function(m,r,k){var f=this;m=k(28);var h=k.n(m);m=k(2);var d=k.n(m);m=k(4);var a=k.n(m),b=k(36),n=k(21);m=k(0);var e=k(38),p=m.a.module("BaseStack");r.a=function(l){var g={},c=new e.a(3E4,function(){if(l.onEnqueueingTimeout)l.onEnqueueingTimeout()});g._queue=c;var u,t,q,x,y=-1,w=[],v=function(a){for(var b=[],c=0;c<arguments.length;++c)b[c-0]=arguments[c];w.push([].concat(["Negotiation:"],
$jscomp.arrayFromIterable(b)).reduce(function(a,b){return a+" "+b}))};g.getNegotiationLogs=function(){return w.reduce(function(a,b){return a+"'\n'"+b})};p.debug("message: Starting Base stack, spec: "+JSON.stringify(l));g.pcConfig={iceServers:[],sdpSemantics:"plan-b"};g.con={};void 0!==l.iceServers&&(g.pcConfig.iceServers=l.iceServers);!0===l.forceTurn&&(g.pcConfig.iceTransportPolicy="relay");g.audio=l.audio;g.video=l.video;void 0===g.audio&&(g.audio=!0);void 0===g.video&&(g.video=!0);l.remoteCandidates=
[];l.localCandidates=[];l.remoteDescriptionSet=!1;g.mediaConstraints={offerToReceiveVideo:void 0!==g.video&&!1!==g.video,offerToReceiveAudio:void 0!==g.audio&&!1!==g.audio};var z=function(a){g.peerConnectionFsm.error(a)};g.peerConnection=new RTCPeerConnection(g.pcConfig,g.con);var k=0;g.peerConnection.onnegotiationneeded=function(){var a=g.audio?1:0,a=a+(g.video?1:0);0===k%a&&(v("onnegotiationneeded - createOffer"),(a=g.peerConnectionFsm.createOffer(!1))&&a.catch(z.bind(f)));k+=1};var m=function(){u.sdp=
g.enableSimulcast(u.sdp);u.type="answer";q=h.a.SDPInfo.processString(u.sdp);n.a.setMaxBW(q,l);var b=g.remoteSdp.getStreams().size,c=q.getStreams().size,e=a.a.SENDRECV,e=0<b&&0<c?a.a.SENDRECV:0<b&&0===c?a.a.RECVONLY:0===b&&0<c?a.a.SENDONLY:a.a.INACTIVE;q.getMedias().forEach(function(a){a.setDirection(e)});u.sdp=q.toString();g.localSdp=q},C=function(){u.sdp=g.enableSimulcast(u.sdp);u.type="offer";q=h.a.SDPInfo.processString(u.sdp);n.a.setMaxBW(q,l);q.medias.forEach(function(a){a.getSetup()!==d.a.ACTPASS&&
a.setSetup(d.a.ACTPASS)});u.sdp=q.toString();g.localSdp=q},A=function(a,b){u=b;C();l.callback({type:u.type,sdp:u.sdp,receivedSessionVersion:y,config:{maxVideoBW:l.maxVideoBW}})},I=function(a){u=a;m();l.callback({type:u.type,sdp:u.sdp,receivedSessionVersion:y,config:{maxVideoBW:l.maxVideoBW}});p.debug("message: Setting local description, localDesc: "+JSON.stringify(u));v("processOffer - Local Description",u.type);return g.peerConnection.setLocalDescription(u).then(function(){g.setSimulcastLayersBitrate()})};
g.enqueuedCalls={negotiationQueue:{createOffer:c.protectFunction(function(a,b){a=void 0===a?!1:a;b=void 0===b?!1:b;v("queue - createOffer");c.startEnqueuing();a||b||(g.mediaConstraints={offerToReceiveVideo:!1,offerToReceiveAudio:!1});(a=g.peerConnectionFsm.createOffer(a))?a.catch(z.bind(f)):(c.stopEnqueuing(),c.nextInQueue())}),processOffer:c.protectFunction(function(a){v("queue - processOffer");c.startEnqueuing();(a=g.peerConnectionFsm.processOffer(a))?a.catch(z.bind(f)):(c.stopEnqueuing(),c.nextInQueue())}),
negotiateMaxBW:c.protectFunction(function(a,b){v("queue - negotiateMaxBW");(a=g.peerConnectionFsm.negotiateMaxBW(a,b))?a.catch(z.bind(f)):c.nextInQueue()}),processNewCandidate:c.protectFunction(function(a){v("queue - processNewCandidate");try{var b="object"===typeof a.candidate?a.candidate:JSON.parse(a.candidate);if("end"===b.candidate)c.nextInQueue();else{b.candidate=b.candidate.replace(/a=/g,"");b.sdpMLineIndex=parseInt(b.sdpMLineIndex,10);var e=new RTCIceCandidate(b);l.remoteDescriptionSet?(c.startEnqueuing(),
g.peerConnectionFsm.addIceCandidate(e).catch(z.bind(f))):l.remoteCandidates.push(e)}}catch(E){p.error("message: Error parsing candidate, candidate: "+a.candidate+", message: "+E.message)}}),addStream:c.protectFunction(function(a){v("queue - addStream");c.startEnqueuing();(a=g.peerConnectionFsm.addStream(a))?a.catch(z.bind(f)):(c.stopEnqueuing(),c.nextInQueue())}),removeStream:c.protectFunction(function(a){v("queue - removeStream");c.startEnqueuing();(a=g.peerConnectionFsm.removeStream(a))?a.catch(z.bind(f)):
(c.stopEnqueuing(),c.nextInQueue())}),close:c.protectFunction(function(){v("queue - close");c.startEnqueuing();var a=g.peerConnectionFsm.close();a?a.catch(z.bind(f)):(c.stopEnqueuing(),c.nextInQueue())})}};g.protectedCalls={protectedAddStream:function(a){try{g.peerConnection.addStream(a)}catch(J){setTimeout(function(){c.stopEnqueuing();c.nextInQueue()},0)}return Promise.resolve()},protectedRemoveStream:function(a){try{g.peerConnection.removeStream(a),setTimeout(function(){c.stopEnqueuing();c.nextInQueue()},
0)}catch(J){setTimeout(function(){c.stopEnqueuing();c.nextInQueue()},0)}return Promise.resolve()},protectedCreateOffer:function(a){a=void 0===a?!1:a;c.startEnqueuing();v("Creating offer",g.mediaConstraints);var b=[];return g.prepareCreateOffer(a).then(function(){return g.peerConnection.createOffer(g.mediaConstraints)}).then(A.bind(null,a)).catch(function(a){b.push("in protectedCreateOffer-createOffer, error: "+a)}).then(function(){return 0!==b.length?Promise.reject(b):Promise.resolve()})},protectedProcessOffer:function(a){p.debug("message: Protected process Offer, message: "+
a+", localDesc: "+JSON.stringify(u));var b=(x=h.a.SDPInfo.processString(a.sdp))&&x.origin&&x.origin.sessionVersion;if(y>=b)return p.warning("message: processOffer discarding old sdp"+(", sessionVersion: "+b+", latestSessionVersion: "+y)),v("processOffer - dropped"),l.callback({type:"offer-dropped"}),setTimeout(function(){c.stopEnqueuing();c.nextInQueue()},0),Promise.resolve();y=b;n.a.setMaxBW(x,l);x.medias.forEach(function(a){a.getSetup()!==d.a.ACTPASS&&a.setSetup(d.a.ACTPASS)});a.sdp=x.toString();
g.remoteSdp=x;var e=[];v("processOffer - Remote Description",a.type);return g.peerConnection.setRemoteDescription(a).then(function(){l.remoteDescriptionSet=!0;v("processOffer - Create Answer")}).then(function(){return g.peerConnection.createAnswer(g.mediaConstraints)}).catch(function(a){e.push("in: protectedProcessOffer-createAnswer, error: "+a)}).then(I.bind(f)).catch(function(a){e.push("in: protectedProcessOffer-setLocalDescForAnswer, error: "+a)}).then(function(){v("processOffer - Stop enqueueing");
setTimeout(function(){c.stopEnqueuing();c.nextInQueue()},0);return 0!==e.length?Promise.reject(e):Promise.resolve()})},protectedProcessAnswer:function(a){var b=(x=h.a.SDPInfo.processString(a.sdp))&&x.origin&&x.origin.sessionVersion;if(y>=b)return p.warning("message: processAnswer discarding old sdp"+(", sessionVersion: "+b+", latestSessionVersion: "+y)),v("processAnswer - dropped"),l.callback({type:"answer-dropped"}),setTimeout(function(){c.stopEnqueuing();c.nextInQueue()},0),Promise.resolve();y=
b;p.debug("message: Set remote and local description");n.a.setMaxBW(x,l);g.setStartVideoBW(x);g.setHardMinVideoBW(x);a.sdp=x.toString();C();v("processAnswer - Local Description",u.type);g.remoteSdp=x;t=a;var e=[];return g.peerConnection.setLocalDescription(u).then(function(){g.setSimulcastLayersBitrate();v("processAnswer - Remote Description",a.type);g.peerConnection.setRemoteDescription(new RTCSessionDescription(a))}).then(function(){l.remoteDescriptionSet=!0;for(p.debug("message: Candidates to be added, size: "+
l.remoteCandidates.length);0<l.remoteCandidates.length;)g.peerConnectionFsm.addIceCandidate(l.remoteCandidates.shift()).catch(z.bind(f));for(p.debug("message: Local candidates to send, size: "+l.localCandidates.length);0<l.localCandidates.length;)l.callback({type:"candidate",candidate:l.localCandidates.shift()})}).catch(function(a){v("precessAnswer - error",a);e.push("in: protectedProcessAnswer, error: "+a)}).then(function(){v("processAnswer - Stop enqueuing");setTimeout(function(){c.stopEnqueuing();
c.nextInQueue()},0);return 0!==e.length?Promise.reject(e):Promise.resolve()})},protectedNegotiateMaxBW:function(a,b){if(a.Sdp||a.maxAudioBW){c.startEnqueuing();var e=[];C();v("protectedNegotiateBW - Local Description",u.type);g.peerConnection.setLocalDescription(u).then(function(){g.setSimulcastLayersBitrate();x=h.a.SDPInfo.processString(t.sdp);n.a.setMaxBW(x,l);t.sdp=x.toString();g.remoteSdp=x;v("protectedNegotiateBW - Remote Description",t.type);return g.peerConnection.setRemoteDescription(new RTCSessionDescription(t))}).then(function(){l.remoteDescriptionSet=
!0;l.callback({type:"offer-noanswer",sdp:u.sdp,receivedSessionVersion:y})}).catch(function(a){b("error","updateSpec");e.push("in: protectedNegotiateMaxBW error: "+a)}).then(function(){setTimeout(function(){c.stopEnqueuing();c.nextInQueue()},0);return 0!==e.length?Promise.reject(e):Promise.resolve()})}},protectedAddIceCandidate:function(a){var b=[];return g.peerConnection.addIceCandidate(a).catch(function(a){b.push("in: protectedAddIceCandidate, error: "+a)}).then(function(){setTimeout(function(){c.stopEnqueuing();
c.nextInQueue()},0);return 0!==b.length?Promise.reject(b):Promise.resolve()})},protectedClose:function(){g.peerConnection.close();setTimeout(function(){c.stopEnqueuing();c.nextInQueue()},0);return Promise.resolve()}};g.peerConnection.onicecandidate=function(a){(a=a.candidate)?(a={sdpMLineIndex:a.sdpMLineIndex,sdpMid:a.sdpMid,candidate:a.candidate},a.candidate.match(/a=/)||(a.candidate="a\x3d"+a.candidate)):(p.debug("message: Gathered all candidates and sending END candidate"),a={sdpMLineIndex:-1,
sdpMid:"end",candidate:"end"});l.remoteDescriptionSet?l.callback({type:"candidate",candidate:a,receivedSessionVersion:y}):(l.localCandidates.push(a),p.debug("message: Storing candidates, size: "+l.localCandidates.length))};g.setStartVideoBW=function(a){p.error("message: startVideoBW not implemented for this browser");return a};g.setHardMinVideoBW=function(a){p.error("message: hardMinVideoBw not implemented for this browser");return a};g.enableSimulcast=function(a){p.error("message: Simulcast not implemented");
return a};g.updateSimulcastLayersBitrate=function(a){g.simulcast&&(g.simulcast.spatialLayerBitrates=a,g.setSimulcastLayersBitrate())};g.setSimulcastLayersBitrate=function(){p.error("message: Simulcast not implemented")};g.setSimulcast=function(a){g.simulcast=a};g.setVideo=function(a){g.video=a};g.setAudio=function(a){g.audio=a};g.updateSpec=function(a,b,c){c=void 0===c?function(){}:c;var e=l.p2p&&a.maxVideoBW,q=!l.p2p&&a.maxVideoBW;a.maxVideoBW&&(p.debug("message: Maxvideo Requested, value: "+a.maxVideoBW+
", limit: "+l.limitMaxVideoBW),a.maxVideoBW>l.limitMaxVideoBW&&(a.maxVideoBW=l.limitMaxVideoBW),l.maxVideoBW=a.maxVideoBW,p.debug("message: Maxvideo Result, value: "+a.maxVideoBW+", limit: "+l.limitMaxVideoBW));a.maxAudioBW&&(a.maxAudioBW>l.limitMaxAudioBW&&(a.maxAudioBW=l.limitMaxAudioBW),l.maxAudioBW=a.maxAudioBW);(e||a.maxAudioBW)&&g.enqueuedCalls.negotiationQueue.negotiateMaxBW(a,c);if(q||a.minVideoBW||void 0!==a.slideShowMode||void 0!==a.muteStream||void 0!==a.qualityLayer||void 0!==a.slideShowBelowLayer||
void 0!==a.video)p.debug("message: Configuration changed, maxVideoBW: "+a.maxVideoBW+(", minVideoBW: "+a.minVideoBW+", slideShowMode: "+a.slideShowMode)+(", muteStream: "+JSON.stringify(a.muteStream)+", videoConstraints: "+JSON.stringify(a.video))+(", slideShowBelowMinLayer: "+a.slideShowBelowLayer)),l.callback({type:"updatestream",config:a},b)};g.createOffer=g.enqueuedCalls.negotiationQueue.createOffer;g.sendOffer=g.enqueuedCalls.negotiationQueue.createOffer.bind(null,!0,!0);g.addStream=g.enqueuedCalls.negotiationQueue.addStream;
g.removeStream=g.enqueuedCalls.negotiationQueue.removeStream;g.close=g.enqueuedCalls.negotiationQueue.close;g.processSignalingMessage=function(a){v("processSignalingMessage, type: ",a.type);"offer"===a.type?g.enqueuedCalls.negotiationQueue.processOffer(a):"answer"===a.type?g.peerConnectionFsm.processAnswer(a):"candidate"===a.type?g.enqueuedCalls.negotiationQueue.processNewCandidate(a):"error"===a.type&&p.error("message: Received error signaling message, state: "+a.previousType+(", isEnqueuing: "+
c.isEnqueueing()))};g.peerConnectionFsm=new b.a(g.protectedCalls);return g}},function(m,r){var k=m.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:"username sessionId sessionVersion netType ipVer address".split(" "),format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start",
"stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w\/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-\.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(f){return f.encoding?"rtpmap:%d %s/%s/%s":f.rate?
"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(f){return null!=f.address?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%d trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,
names:["payload","type","subtype"],format:function(f){return null!=f.subtype?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))? (\S*)(?: (\S*))?/,names:["value","direction","uri","config"],format:function(f){return"extmap:%d"+(f.direction?"/%s":"%v")+" %s"+(f.config?" %s":"")}},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(f){return null!=f.sessionConfig?"crypto:%d %s %s %s":"crypto:%d %s %s"}},
{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",
reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:"foundation component transport priority ip port type raddr rport tcptype generation network-id network-cost".split(" "),format:function(f){var h="candidate:%s %d %s %d %s %d typ %s"+(null!=f.raddr?" raddr %s rport %d":
"%v%v");h+=null!=f.tcptype?" tcptype %s":"%v";null!=f.generation&&(h+=" generation %d");h+=null!=f["network-id"]?" network-id %d":"%v";return h+=null!=f["network-cost"]?" network-cost %d":"%v"}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(f){var h=
"ssrc:%d";null!=f.attribute&&(h+=" %s",null!=f.value&&(h+=":%s"));return h}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",
reg:/^sctpmap:([\w_\/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(f){return null!=f.maxMessageSize?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(f){return f.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:/^imageattr:(\d+|\*)[\s\t]+(send|recv)[\s\t]+(\*|\[\S+\](?:[\s\t]+\[\S+\])*)(?:[\s\t]+(recv|send)[\s\t]+(\*|\[\S+\](?:[\s\t]+\[\S+\])*))?/,
names:["pt","dir1","attrs1","dir2","attrs2"],format:function(f){return"imageattr:%s %s %s"+(f.dir2?" %s %s":"")}},{name:"simulcast",reg:/^simulcast:(send|recv) ([a-zA-Z0-9\-_~;,]+)(?:\s?(send|recv) ([a-zA-Z0-9\-_~;,]+))?$/,names:["dir1","list1","dir2","list2"],format:function(f){return"simulcast:%s %s"+(f.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},
{push:"invalid",names:["value"]}]};Object.keys(k).forEach(function(f){k[f].forEach(function(f){f.reg||(f.reg=/(.*)/);f.format||(f.format="%s")})})},function(m,r){var k=function(f,h,d,a,b,n,e,p,l,g){this.foundation=f;this.componentId=h;this.transport=d;this.priority=a;this.address=b;this.port=n;this.type=e;this.generation=p;this.relAddr=l;this.relPort=g};k.prototype.clone=function(){return new k(this.foundation,this.componentId,this.transport,this.priority,this.address,this.port,this.type,this.generation,
this.relAddr,this.relPort)};k.prototype.plain=function(){var f={foundation:this.foundation,componentId:this.componentId,transport:this.transport,priority:this.priority,address:this.address,port:this.port,type:this.type,generation:this.generation};this.relAddr&&(f.relAddr=this.relAddr);this.relPort&&(f.relPort=this.relPort);return f};k.prototype.getFoundation=function(){return this.foundation};k.prototype.getComponentId=function(){return this.componentId};k.prototype.getTransport=function(){return this.transport};
k.prototype.getPriority=function(){return this.priority};k.prototype.getAddress=function(){return this.address};k.prototype.getPort=function(){return this.port};k.prototype.getType=function(){return this.type};k.prototype.getGeneration=function(){return this.generation};k.prototype.getRelAddr=function(){return this.relAddr};k.prototype.getRelPort=function(){return this.relPort};m.exports=k},function(m,r){var k=function(f,h,d,a,b,n){this.codec=f;this.type=h;this.rate=d;this.encoding=a;this.params=
b||{};this.feedback=n||[]};k.prototype.clone=function(){var f=new k(this.codec,this.type,this.rate,this.encoding,this.params,this.feedback);this.rtx&&f.setRTX(this.rtx);return f};k.prototype.plain=function(){return{codec:this.codec,type:this.type,rate:this.rate,encoding:this.encoding,params:this.params,feedback:this.feedback}};k.prototype.setRTX=function(f){this.rtx=f};k.prototype.getType=function(){return this.type};k.prototype.setType=function(f){this.type=f};k.prototype.getCodec=function(){return this.codec};
k.prototype.getParams=function(){return this.params};k.prototype.setParam=function(f,h){this.params[f]=h};k.prototype.hasRTX=function(){return this.rtx};k.prototype.getRTX=function(){return this.rtx};k.prototype.getRate=function(){return this.rate};k.prototype.getEncoding=function(){return this.encoding};k.prototype.getFeedback=function(){return this.feedback};k.mapFromNames=function(f,h){var d=new Map,a=96;f.forEach(function(b){b=b.toLowerCase();var n="pcmu"===b?0:"pcma"===b?8:a+=1;n=new k(b,n);
h&&"ulpfec"!==b&&"flexfec-03"!==b&&"red"!==b&&(a+=1,n.setRTX(a));d.set(n.getCodec().toLowerCase(),n)});return d};m.exports=k},function(m,r,k){var f=k(2),h=function(d,a,b){this.setup=d;this.hash=a;this.fingerprint=b};h.prototype.clone=function(){return new h(this.setup,this.hash,this.fingerprint)};h.prototype.plain=function(){return{setup:f.toString(this.setup),hash:this.hash,fingerprint:this.fingerprint}};h.prototype.getFingerprint=function(){return this.fingerprint};h.prototype.getHash=function(){return this.hash};
h.prototype.getSetup=function(){return this.setup};h.prototype.setSetup=function(d){this.setup=d};m.exports=h},function(m,r){function k(d){d=new Uint8Array(d);for(var a=0;a<d.length;a+=1)d[a]=Math.floor(256*Math.random()+0);return d}function f(d){return Array.prototype.map.call(new Uint8Array(d),function(a){return("00"+a.toString(16)).slice(-2)}).join("")}var h=function(d,a,b){this.ufrag=d;this.pwd=a;this.opts=b;this.endOfCandidates=this.lite=!1};h.prototype.clone=function(){var d=new h(this.ufrag,
this.pwd,this.opts);d.setLite(this.lite);d.setEndOfCandidates(this.endOfCandidates);return d};h.prototype.plain=function(){var d={ufrag:this.ufrag,pwd:this.pwd};this.lite&&(d.lite=this.lite);this.endOfCandidates&&(d.endOfCandidates=this.endOfCandidates);return d};h.prototype.getUfrag=function(){return this.ufrag};h.prototype.getPwd=function(){return this.pwd};h.prototype.isLite=function(){return this.lite};h.prototype.getOpts=function(){return this.opts};h.prototype.setLite=function(d){this.lite=
d};h.prototype.isEndOfCandidates=function(){return this.endOfCandidates};h.prototype.setEndOfCandidates=function(d){this.endOfCandidates=d};h.generate=function(){var d=new h,a=k(8),b=k(24);d.ufrag=f(a);d.pwd=f(b);return d};m.exports=h},function(m,r,k){var f=k(16),h=k(4),d=k(3),a=function(a,d,e){this.id=a;this.type=e;this.port=d;this.direction=h.SENDRECV;this.extensions=new Map;this.codecs=new Map;this.rids=new Map;this.simulcast_03=this.simulcast=null;this.bitrate=0;this.connection=this.dtls=this.ice=
null;this.candidates=[]};a.prototype.clone=function(){var b=new a(this.id,this.port,this.type);b.setDirection(this.direction);b.setBitrate(this.bitrate);b.setConnection(this.connection);this.codecs.forEach(function(a){b.addCodec(a.clone())});this.extensions.forEach(function(a,e){b.addExtension(e,a)});this.rids.forEach(function(a,e){b.addRID(e,a.clone())});this.simulcast&&b.setSimulcast(this.simulcast.clone());this.xGoogleFlag&&b.setXGoogleFlag(this.xGoogleFlag);this.ice&&b.setICE(this.ice.clone());
this.dtls&&b.setDTLS(this.dtls.clone());this.candidates.forEach(function(a){b.addCandidate(a.clone())});this.setup&&b.setSetup(this.setup);return b};a.prototype.plain=function(){var a={id:this.id,port:this.port,type:this.type,connection:this.connection,direction:h.toString(this.direction),xGoogleFlag:this.xGoogleFlag,extensions:{},rids:[],codecs:[],candidates:[]};this.bitrate&&(a.bitrate=this.bitrate);this.codecs.forEach(function(b){a.codecs.push(b.plain())});this.extensions.forEach(function(b){a.extensions.push(b.plain())});
this.rids.forEach(function(b){a.rids.push(b.plain())});this.simulcast&&(a.simulcast=this.simulcast.plain());this.candidates.forEach(function(b){a.candidates.push(b.plain())});a.ice=this.ice&&this.ice.plain();a.dtls=this.dtls&&this.dtls.plain();return a};a.prototype.getType=function(){return this.type};a.prototype.getPort=function(){return this.port};a.prototype.getId=function(){return this.id};a.prototype.addExtension=function(a,d){this.extensions.set(a,d)};a.prototype.addRID=function(a){this.rids.set(a.getId(),
a)};a.prototype.addCodec=function(a){this.codecs.set(a.getType(),a)};a.prototype.getCodecForType=function(a){return this.codecs.get(a)};a.prototype.getCodec=function(a){var b;this.codecs.forEach(function(e){e.getCodec().toLowerCase()===a.toLowerCase()&&(b=e)});return b};a.prototype.hasCodec=function(a){return null!==this.getCodec(a)};a.prototype.getCodecs=function(){return this.codecs};a.prototype.getExtensions=function(){return this.extensions};a.prototype.getRIDs=function(){return this.rids};a.prototype.getRID=
function(a){return this.rids.get(a)};a.prototype.getBitrate=function(){return this.bitrate};a.prototype.setBitrate=function(a){this.bitrate=a};a.prototype.getDirection=function(){return this.direction};a.prototype.setDirection=function(a){this.direction=a};a.prototype.getDTLS=function(){return this.dtls};a.prototype.setDTLS=function(a){this.dtls=a};a.prototype.getICE=function(){return this.ice};a.prototype.setICE=function(a){this.ice=a};a.prototype.addCandidate=function(a){this.candidates.push(a)};
a.prototype.addCandidates=function(a){var b=this;a.forEach(function(a){b.addCandidate(a)})};a.prototype.getCandidates=function(){return this.candidates};a.prototype.setXGoogleFlag=function(a){this.xGoogleFlag=a};a.prototype.getXGoogleFlag=function(){return this.xGoogleFlag};a.prototype.getConnection=function(){return this.connection};a.prototype.setConnection=function(a){this.connection=a};a.prototype.answer=function(b){var n=new a(this.id,this.port,this.type);n.setDirection(h.reverse(this.direction));
b.codecs&&this.codecs.forEach(function(a){if(b.codecs.has(a.getCodec().toLowerCase())){var g=b.codecs.get(a.getCodec().toLowerCase()).clone();g.setType(a.getType());g.hasRTX()&&g.setRTX(a.getRTX());n.addCodec(g)}});this.extensions.forEach(function(a,g){b.extensions.has(g)&&n.addExtension(g,a)});if(b.simulcast&&this.simulcast){var e=new f,p=this.simulcast.getSimulcastStreams(d.SEND);p&&p.forEach(function(a){var b=[];a.forEach(function(a){b.push(a.clone())});e.addSimulcastAlternativeStreams(d.RECV,
b)});(p=this.simulcast.getSimulcastStreams(d.RECV))&&p.forEach(function(a){var b=[];a.forEach(function(a){b.push(a.clone())});e.addSimulcastAlternativeStreams(d.SEND,b)});this.rids.forEach(function(a){var b=a.clone();b.setDirection(d.reverse(a.getDirection()));n.addRID(b)});n.setSimulcast(e)}return n};a.prototype.getSimulcast=function(){return this.simulcast};a.prototype.setSimulcast=function(a){this.simulcast=a};a.prototype.getSimulcast03=function(){return this.simulcast_03};a.prototype.setSimulcast03=
function(a){this.simulcast_03=a};a.prototype.getSetup=function(){return this.setup};a.prototype.setSetup=function(a){this.setup=a};m.exports=a},function(m,r,k){var f=k(3),h=function(){this.send=[];this.recv=[];this.plainString=null};h.prototype.clone=function(){var d=new h;this.send.forEach(function(a){var b=[];a.forEach(function(a){b.push(a.clone())});d.addSimulcastAlternativeStreams(f.SEND,b)});this.recv.forEach(function(a){var b=[];a.forEach(function(a){b.push(a.clone())});d.addSimulcastAlternativeStreams(f.RECV,
b)});return d};h.prototype.plain=function(){var d={send:[],recv:[]};this.send.forEach(function(a){var b=[];a.forEach(function(a){b.push(a.plain())});d.send.push(b)});this.recv.forEach(function(a){var b=[];a.forEach(function(a){b.push(a.plain())});d.recv.push(b)});return d};h.prototype.addSimulcastAlternativeStreams=function(d,a){return d===f.SEND?this.send.push(a):this.recv.push(a)};h.prototype.addSimulcastStream=function(d,a){return d===f.SEND?this.send.push([a]):this.recv.push([a])};h.prototype.getSimulcastStreams=
function(d){return d===f.SEND?this.send:this.recv};h.prototype.setSimulcastPlainString=function(d){this.plainString=d};h.prototype.getSimulcastPlainString=function(){return this.plainString};m.exports=h},function(m,r){var k=function(f,h){var d=this;this.semantics=f;this.ssrcs=[];h.forEach(function(a){d.ssrcs.push(parseInt(a,10))})};k.prototype.clone=function(){return new k(this.semantics,this.ssrcs)};k.prototype.plain=function(){var f={semantics:this.semantics,ssrcs:[]};f.ssrcs=this.ssrcs;return f};
k.prototype.getSemantics=function(){return this.semantics};k.prototype.getSSRCs=function(){return this.ssrcs};m.exports=k},function(m,r){var k=function(f){this.ssrc=f};k.prototype.clone=function(){var f=new k(this.ssrc);f.setCName(this.cname);f.setStreamId(this.streamId);this.setTrackId(this.trackId)};k.prototype.plain=function(){var f={ssrc:this.ssrc};this.cname&&(f.cname=this.cname);this.label&&(f.label=this.label);this.mslabel&&(f.mslabel=this.mslabel);this.streamId&&(f.streamId=this.streamId);
this.trackId&&(f.trackid=this.trackId);return f};k.prototype.getCName=function(){return this.cname};k.prototype.setCName=function(f){this.cname=f};k.prototype.getStreamId=function(){return this.streamId};k.prototype.setStreamId=function(f){this.streamId=f};k.prototype.getTrackId=function(){return this.trackId};k.prototype.setTrackId=function(f){this.trackId=f};k.prototype.getMSLabel=function(){return this.mslabel};k.prototype.setMSLabel=function(f){this.mslabel=f};k.prototype.getLabel=function(){return this.label};
k.prototype.setLabel=function(f){this.label=f};k.prototype.getSSRC=function(){return this.ssrc};m.exports=k},function(m,r){var k=function(f){this.id=f;this.tracks=new Map};k.prototype.clone=function(){var f=new k(this.id);this.tracks.forEach(function(h){f.addTrack(h.clone())});return f};k.prototype.plain=function(){var f={id:this.id,tracks:[]};this.tracks.forEach(function(h){f.tracks.push(h.plain())});return f};k.prototype.getId=function(){return this.id};k.prototype.addTrack=function(f){this.tracks.set(f.getId(),
f)};k.prototype.getFirstTrack=function(f){var h;this.tracks.forEach(function(d){d.getMedia().toLowerCase()===f.toLowerCase()&&(h=d)});return h};k.prototype.getTracks=function(){return this.tracks};k.prototype.removeAllTracks=function(){this.tracks.clear()};k.prototype.getTrack=function(f){return this.tracks.get(f)};m.exports=k},function(m,r){var k=function(f,h){this.media=f;this.id=h;this.ssrcs=[];this.groups=[];this.encodings=[]};k.prototype.clone=function(){var f=new k(this.media,this.id);this.mediaId&&
f.setMediaId(this.mediaId);this.ssrcs.forEach(function(h){f.addSSRC(h)});this.groups.forEach(function(h){f.addSourceGroup(h.clone())});this.encodings.forEach(function(h){var d=[];h.forEach(function(a){d.push(a.cloned())});f.addAlternativeEncoding(d)});return f};k.prototype.plain=function(){var f={media:this.media,id:this.id,ssrcs:[],groups:[],encodings:[]};this.mediaId&&(f.mediaId=this.mediaId);this.ssrcs.forEach(function(h){f.ssrcs.push(h)});this.groups.forEach(function(h){f.groups.push(h.plain())});
this.encodings.forEach(function(h){var d=[];h.forEach(function(a){d.push(a.plain())});f.encodings.push(d)});return f};k.prototype.getMedia=function(){return this.media};k.prototype.setMediaId=function(f){this.mediaId=f};k.prototype.getMediaId=function(){return this.mediaId};k.prototype.getId=function(){return this.id};k.prototype.addSSRC=function(f){this.ssrcs.push(f)};k.prototype.getSSRCs=function(){return this.ssrcs};k.prototype.addSourceGroup=function(f){this.groups.push(f)};k.prototype.getSourceGroup=
function(f){var h;this.groups.forEach(function(d){d.getSemantics().toLowerCase()===f.toLowerCase()&&(h=d)});return h};k.prototype.getSourceGroups=function(){return this.groups};k.prototype.hasSourceGroup=function(f){var h=!1;this.groups.forEach(function(d){d.getSemantics().toLowerCase()===f.toLowerCase()&&(h=!0)});return h};k.prototype.getEncodings=function(){return this.encodings};k.prototype.addAlternaticeEncodings=function(f){this.encodings.push(f)};k.prototype.setEncodings=function(f){this.encodings=
f};m.exports=k},function(m,r,k){r.a={addSim:function(f){var h="a\x3dssrc-group:SIM";f.forEach(function(d){h+=" "+d});return h+"\r\n"},addGroup:function(f,h){return"a\x3dssrc-group:FID "+f+" "+h+"\r\n"},addSpatialLayer:function(f,h,d,a,b,n){return"a\x3dssrc:"+b+" cname:"+f+"\r\n"+("a\x3dssrc:"+b+" msid:"+h+"\r\n")+("a\x3dssrc:"+b+" mslabel:"+d+"\r\n")+("a\x3dssrc:"+b+" label:"+a+"\r\n")+("a\x3dssrc:"+n+" cname:"+f+"\r\n")+("a\x3dssrc:"+n+" msid:"+h+"\r\n")+("a\x3dssrc:"+n+" mslabel:"+d+"\r\n")+("a\x3dssrc:"+
n+" label:"+a+"\r\n")},setMaxBW:function(f,h){if(h.p2p){if(h.video&&h.maxVideoBW){var d=f.getMedia("video");d&&d.setBitrate(h.maxVideoBW)}h.audio&&h.maxAudioBW&&(f=f.getMedia("audio"))&&f.setBitrate(h.maxAudioBW)}},enableOpusNacks:function(f){var h=f.match(/a=rtpmap:(.*)opus.*\r\n/);null!==h&&(f=f.replace(h[0],h[0]+"a\x3drtcp-fb:"+h[1]+"nack\r\n"));return f},setParamForCodecs:function(f,h,d,a){f.medias.forEach(function(b){b.id===h&&b.codecs.forEach(function(b){b.setParam(d,a)})})}}},function(m,r,
k){var f=this,h=k(1),d=k(8),a=k(7),b=k(44),n=k(45),e=k(47),p=k(0).a.module("Stream");r.a=function(l,g){var c=Object(h.b)(g);c.stream=g.stream;c.url=g.url;c.recording=g.recording;c.room=void 0;c.showing=!1;c.local=!1;c.video=g.video;c.audio=g.audio;c.screen=g.screen;c.videoSize=g.videoSize;c.videoFrameRate=g.videoFrameRate;c.extensionId=g.extensionId;c.desktopStreamId=g.desktopStreamId;c.audioMuted=!1;c.videoMuted=!1;c.unsubscribing={callbackReceived:!1,pcEventReceived:!1};c.p2p=!1;c.ConnectionHelpers=
void 0===l?d.a:l;void 0!==c.url&&(g.label="ei_"+b.a.getRandomValue());var u=function(a){a.stream.id===c.getLabel()&&c.emit(Object(h.f)({type:"added",stream:a.stream}))},t=function(a){a.stream.id===c.getLabel()&&c.emit(Object(h.f)({type:"removed",stream:c}))},q=function(a){c.emit(Object(h.f)({type:"icestatechanged",msg:a}))};if(!(void 0===c.videoSize||c.videoSize instanceof Array&&4===c.videoSize.length))throw Error("Invalid Video Size");if(void 0===g.local||!0===g.local)c.local=!0;c.getID=function(){return c.local&&
!g.streamID?"local":g.streamID};c.getLabel=function(){return c.stream&&c.stream.id?c.stream.id:g.label};c.getAttributes=function(){return g.attributes};c.setAttributes=function(a){c.local?c.emit(Object(h.f)({type:"internal-set-attributes",stream:c,attrs:a})):p.error("message: Failed to set attributes data, reason: Stream has not been published, "+c.toLog())};c.toLog=function(){var a="streamId: "+c.getID()+", label: "+c.getLabel();Object.keys(g.attributes).forEach(function(b){a=a+", "+b+": "+g.attributes[b]});
return a};c.updateLocalAttributes=function(a){g.attributes=a};c.hasAudio=function(){return!1!==g.audio&&void 0!==g.audio};c.hasVideo=function(){return!1!==g.video&&void 0!==g.video};c.hasData=function(){return!1!==g.data&&void 0!==g.data};c.hasScreen=function(){return g.screen};c.hasMedia=function(){return g.audio||g.video||g.screen};c.isExternal=function(){return void 0!==c.url||void 0!==c.recording};c.addPC=function(b,g){g?(c.p2p=!0,void 0===c.pc&&(c.pc=Object(a.a)()),c.pc.add(g,b),b.on("ice-state-change",
q)):(c.pc&&(c.pc.off("add-stream",u),c.pc.off("remove-stream",t),c.pc.off("ice-state-change",q)),c.pc=b,c.pc.on("add-stream",u),c.pc.on("remove-stream",t),c.pc.on("ice-state-change",q))};c.sendData=function(a){c.local&&c.hasData()?c.emit(Object(h.f)({type:"internal-send-data",stream:c,msg:a})):p.error("message: Failed to send data, reason: Stream has not been published, "+c.toLog())};c.init=function(){try{if((g.audio||g.video||g.screen)&&void 0===g.url){p.debug("message: Requested access to local media, "+
c.toLog());var a=g.video;!0===a||!0===g.screen?(a=!0===a||null===a?{}:a,void 0!==c.videoSize&&(a.width={min:c.videoSize[0],max:c.videoSize[2]},a.height={min:c.videoSize[1],max:c.videoSize[3]}),void 0!==c.videoFrameRate&&(a.frameRate={min:c.videoFrameRate[0],max:c.videoFrameRate[1]})):!0===g.screen&&void 0===a&&(a=!0);c.ConnectionHelpers.GetUserMedia({video:a,audio:g.audio,fake:g.fake,screen:g.screen,extensionId:c.extensionId,desktopStreamId:c.desktopStreamId},function(a){p.debug("message: User has granted access to local media, "+
c.toLog());c.stream=a;c.dispatchEvent(Object(h.f)({type:"access-accepted"}));c.stream.getTracks().forEach(function(a){p.debug("message: getTracks, track: "+a.kind+", "+c.toLog());a.onended=function(){c.stream.getTracks().forEach(function(a){a.onended=null});var b=Object(h.f)({type:"stream-ended",stream:c,msg:a.kind});c.dispatchEvent(b)}})},function(a){p.error("message: Failed to get access to local media, "+c.toLog()+", error: "+a.name+", message: "+a.message);a=Object(h.f)({type:"access-denied",
msg:a});c.dispatchEvent(a)})}else{var b=Object(h.f)({type:"access-accepted"});c.dispatchEvent(b)}}catch(F){p.error("message: Failed to get access to local media, "+c.toLog()+", error: "+F),a=Object(h.f)({type:"access-denied",msg:F}),c.dispatchEvent(a)}};c.close=function(){c.local&&(void 0!==c.room&&c.room.unpublish(c),c.hide(),void 0!==c.stream&&c.stream.getTracks().forEach(function(a){a.onended=null;a.stop()}),c.stream=void 0);c.pc&&!c.p2p?(c.pc.off("add-stream",u),c.pc.off("remove-stream",t),c.pc.off("ice-state-change",
q)):c.pc&&c.p2p&&c.pc.forEach(function(a){a.off("add-stream",u);a.off("remove-stream",t);a.off("ice-state-change",q)});c.removeAllListeners()};c.play=function(a,b){b=b||{};c.elementID=a;c.hasVideo()||c.hasScreen()?void 0!==a&&(a=Object(n.a)({id:c.getID(),stream:c,elementID:a,options:b}),c.player=a,c.showing=!0):c.hasAudio()&&(a=Object(e.a)({id:c.getID(),stream:c,elementID:a,options:b}),c.player=a,c.showing=!0)};c.stop=function(){if(c.showing&&void 0!==c.player){try{c.player.destroy()}catch(v){p.warning("message: Exception when destroying Player, error: "+
v.message+", "+c.toLog())}c.showing=!1}};c.show=c.play;c.hide=c.stop;var x=function(){if(void 0!==c.player&&void 0!==c.stream){var a=c.player.video,b=document.defaultView.getComputedStyle(a),g=parseInt(b.getPropertyValue("width"),10),e=parseInt(b.getPropertyValue("height"),10),q=parseInt(b.getPropertyValue("left"),10),b=parseInt(b.getPropertyValue("top"),10);var l="object"===typeof c.elementID&&"function"===typeof c.elementID.appendChild?c.elementID:document.getElementById(c.elementID);var d=document.defaultView.getComputedStyle(l);
l=parseInt(d.getPropertyValue("width"),10);var d=parseInt(d.getPropertyValue("height"),10),f=document.createElement("canvas");f.id="testing";f.width=l;f.height=d;f.setAttribute("style","display: none");f.getContext("2d").drawImage(a,q,b,g,e);return f}return null};c.getVideoFrameURL=function(a){var b=x();return null!==b?a?b.toDataURL(a):b.toDataURL():null};c.getVideoFrame=function(){var a=x();return null!==a?a.getContext("2d").getImageData(0,0,a.width,a.height):null};c.checkOptions=function(a,b){if(!0===
b){if(a.audio||a.screen)p.warning("message: Cannot update type of subscription, "+c.toLog()),a.audio=void 0,a.screen=void 0}else!1===c.local&&(!0===a.video&&!1===c.hasVideo()&&(p.warning("message: Trying to subscribe to video when there is no video, "+c.toLog()),a.video=!1),!0===a.audio&&!1===c.hasAudio()&&(p.warning("message: Trying to subscribe to audio when there is no audio, "+c.toLog()),a.audio=!1));!1!==c.local||c.hasVideo()||!0!==a.slideShowMode||(p.warning("message: Cannot enable slideShowMode without video, "+
c.toLog()),a.slideShowMode=!1)};var y=function(a){a=void 0===a?function(){}:a;if(c.room&&c.room.p2p)p.warning("message: muteAudio/muteVideo are not implemented in p2p streams, "+c.toLog()),a("error");else{c.stream&&c.pc||(p.warning("message: muteAudio/muteVideo cannot be called until a stream is published or subscribed, "+c.toLog()),a("error"));for(var b=0;b<c.stream.getVideoTracks().length;b+=1)c.stream.getVideoTracks()[b].enabled=!c.videoMuted;b={muteStream:{audio:c.audioMuted,video:c.videoMuted}};
c.checkOptions(b,!0);c.pc.updateSpec(b,c.getID(),a)}};c.muteAudio=function(a,b){c.audioMuted=a;y(void 0===b?function(){}:b)};c.muteVideo=function(a,b){c.videoMuted=a;y(void 0===b?function(){}:b)};c._setStaticQualityLayer=function(a,b,g){g=void 0===g?function(){}:g;c.room&&c.room.p2p?(p.warning("message: setStaticQualityLayer is not implemented in p2p streams, "+c.toLog()),g("error")):(a={qualityLayer:{spatialLayer:a,temporalLayer:b}},c.checkOptions(a,!0),c.pc.updateSpec(a,c.getID(),g))};c._setDynamicQualityLayer=
function(a){if(c.room&&c.room.p2p)p.warning("message: setDynamicQualityLayer is not implemented in p2p streams, "+c.toLog()),a("error");else{var b={qualityLayer:{spatialLayer:-1,temporalLayer:-1}};c.checkOptions(b,!0);c.pc.updateSpec(b,c.getID(),a)}};c._enableSlideShowBelowSpatialLayer=function(a,b,g){b=void 0===b?0:b;g=void 0===g?function(){}:g;c.room&&c.room.p2p?(p.warning("message: enableSlideShowBelowSpatialLayer is not implemented in p2p streams, "+c.toLog()),g("error")):(a={slideShowBelowLayer:{enabled:a,
spatialLayer:b}},c.checkOptions(a,!0),p.debug("message: Calling updateSpec, "+c.toLog()+", config: "+JSON.stringify(a)),c.pc.updateSpec(a,c.getID(),g))};c._setMinSpatialLayer=c._enableSlideShowBelowSpatialLayer.bind(f,!0);var w=function(a,b,g){!0!==b&&(b=!1);a="string"===typeof a?[a]:a;a=a instanceof Array?a:[];0<a.length&&c.room.sendControlMessage(c,"control",{name:"controlhandlers",enable:g,publisherSide:b,handlers:a})};c.disableHandlers=function(a,b){w(a,b,!1)};c.enableHandlers=function(a,b){w(a,
b,!0)};c.updateSimulcastLayersBitrate=function(a){c.pc&&c.local&&c.pc.updateSimulcastLayersBitrate(a)};c.updateConfiguration=function(a,b){b=void 0===b?function(){}:b;if(void 0!==a)if(c.pc)if(c.checkOptions(a,!0),c.local)if(c.room.p2p)for(var g=0;g<c.pc.length;g+=1)c.pc[g].updateSpec(a,c.getID(),b);else c.pc.updateSpec(a,c.getID(),b);else c.pc.updateSpec(a,c.getID(),b);else b("This stream has no peerConnection attached, ignoring")};return c}},function(m,r,k){var f=k(5),h=k(46);r.a=function(d){var a=
Object(f.a)({}),b;a.elementID=d.elementID;a.id=d.id;a.div=document.createElement("div");a.div.setAttribute("id","bar_"+a.id);a.div.setAttribute("class","licode_bar");a.bar=document.createElement("div");a.bar.setAttribute("style","width: 100%; height: 15%; max-height: 30px; position: absolute; bottom: 0; right: 0; background-color: rgba(255,255,255,0.62)");a.bar.setAttribute("id","subbar_"+a.id);a.bar.setAttribute("class","licode_subbar");a.link=document.createElement("a");a.link.setAttribute("href",
"http://www.lynckia.com/");a.link.setAttribute("class","licode_link");a.link.setAttribute("target","_blank");a.logo=document.createElement("img");a.logo.setAttribute("style","width: 100%; height: 100%; max-width: 30px; position: absolute; top: 0; left: 2px;");a.logo.setAttribute("class","licode_logo");a.logo.setAttribute("alt","Lynckia");a.logo.setAttribute("src",a.url+"/assets/star.svg");var n=function(e){var d=e;"block"!==e?d="none":clearTimeout(b);a.div.setAttribute("style","width: 100%; height: 100%; position: relative; bottom: 0; right: 0; display: "+
d)};a.display=function(){n("block")};a.hide=function(){b=setTimeout(n,1E3)};document.getElementById(a.elementID).appendChild(a.div);a.div.appendChild(a.bar);a.bar.appendChild(a.link);a.link.appendChild(a.logo);d.stream.screen||void 0!==d.options&&void 0!==d.options.speaker&&!0!==d.options.speaker||(a.speaker=Object(h.a)({elementID:"subbar_"+a.id,id:a.id,stream:d.stream,media:d.media}));a.display();a.hide();return a}},function(m,r,k){Object.defineProperty(r,"__esModule",{value:!0});m=k(25);var f=k(1),
h=k(22),d=k(0);k(49);k={Room:m.a.bind(null,void 0,void 0,void 0),LicodeEvent:f.d,RoomEvent:f.e,StreamEvent:f.f,ConnectionEvent:f.a,Stream:h.a.bind(null,void 0),Logger:d.a};r["default"]=k},function(m,r,k){var f=k(26),h=k(8),d=k(1),a=k(42),b=k(22),n=k(7),e=k(48),p=k(0).a.module("Room");r.a=function(l,g,c,u){var t=Object(d.b)(u);t.remoteStreams=Object(n.a)();t.localStreams=Object(n.a)();t.roomID="";t.state=0;t.p2p=!1;t.minConnectionQualityLevel="";t.ConnectionHelpers=void 0===g?h.a:g;t.erizoConnectionManager=
void 0===c?new f.a:new c.ErizoConnectionManager;var q=Object(a.a)(l);t.socket=q;var x=t.remoteStreams,y=t.localStreams,w=function(){return"roomId: "+(0<t.roomID.length?t.roomID:"undefined")},v=function(a){a.removeAllListeners();a.pc&&!t.p2p&&a.pc.removeStream(a);p.debug("message: Removed stream, "+a.toLog()+", "+w());a.stream&&(a.hide(),a.stop(),a.close(),delete a.stream);a.pc&&(a.local&&t.p2p?a.pc.forEach(function(b,c){b.close();a.pc.remove(c)}):(t.erizoConnectionManager.maybeCloseConnection(a.pc),
delete a.pc))},z=function(a,b){p.info("message: Stream subscribed, "+a.toLog()+", "+w());a.stream=b.stream;t.p2p||a.pc.addStream(a);a.state="subscribed";a=Object(d.f)({type:"stream-subscribed",stream:a});t.dispatchEvent(a)},k=function(a){p.debug("message: Unsubscribing Stream, "+a.toLog()+", unsubscribing: "+a.unsubscribing+", "+w());a&&a.unsubscribing.callbackReceived&&(a.unsubscribing.pcEventReceived||a.failed)?(p.info("message: Stream fully unsubscribed, "+a.toLog()+", "+w()),a.unsubscribing.callbackReceived=
!1,a.unsubscribing.pcEventReceived=!1,v(a),delete a.failed,a.state="unsubscribed",a=Object(d.f)({type:"stream-unsubscribed",stream:a}),t.dispatchEvent(a)):p.debug("message: Not dispatching stream unsubscribed yet, "+a.toLog()+", "+w())},m=function(){var a=Object(d.a)({type:"connection-failed"});t.dispatchEvent(a)},C=function(a,b,c){0!==t.state&&a&&!a.failed&&(a.failed=!0,b=Object(d.f)({type:"stream-failed",msg:b||"Stream failed after connection",stream:a,origin:void 0===c?"unknown":c}),t.dispatchEvent(b),
b=a.pc,a.local?t.unpublish(a):a.unsubscribing.callbackReceived?k(a):t.unsubscribe(a),b&&u.singlePC&&t.erizoConnectionManager.maybeCloseConnection(b,!0))},A=function(a,b){return{callback:function(c,g){q.sendSDP("streamMessageP2P",{streamId:a.getID(),streamIds:g,peerSocket:b,msg:c})},audio:a.hasAudio(),video:a.hasVideo(),iceServers:t.iceServers,maxAudioBW:a.maxAudioBW,maxVideoBW:a.maxVideoBW,limitMaxAudioBW:u.maxAudioBW,limitMaxVideoBW:u.maxVideoBW,forceTurn:a.forceTurn,p2p:!0}},I=function(a,b){var c=
t.erizoConnectionManager.getOrBuildErizoConnection(A(a,b));a.addPC(c);c.on("connection-failed",function(){m(c)});a.on("added",z.bind(null,a));a.on("icestatechanged",function(b){p.debug("message: icestatechanged, "+a.toLog()+", iceConnectionState: "+b.msg.state+", "+w());"failed"===b.msg.state&&C(a,"ICE Connection Failed","ice-client")})},r=function(a,b){var c=t.erizoConnectionManager.getOrBuildErizoConnection(A(a,b));a.addPC(c,b);c.on("connection-failed",function(){m(c)});a.on("icestatechanged",function(c){p.debug("message: icestatechanged, streamId: "+
a.getID()+", iceConnectionState: "+c.msg.state+", "+w());"failed"===c.msg.state&&(a.pc.get(b).close(),a.pc.remove(b))});c.addStream(a)},J=function(a){t.remoteStreams.forEach(function(b){b.local||b.getLabel()!==a||(b.unsubscribing.pcEventReceived=!0,k(b))})},D=function(a,b,c,g,e){var l={callback:function(g,e){e=void 0===e?a.getID():e;p.debug("message: Sending message, data: "+JSON.stringify(g)+", "+a.toLog()+", "+w());g&&g.type&&"updatestream"===g.type?q.sendSDP("streamMessage",{streamId:e,erizoId:c,
msg:g,browser:a.pc&&a.pc.browser},void 0,function(){}):q.sendSDP("connectionMessage",{connectionId:b,erizoId:c,msg:g,browser:a.pc&&a.pc.browser},void 0,function(){})},connectionId:b,nop2p:!0,audio:g.audio&&a.hasAudio(),video:g.video&&a.hasVideo(),maxAudioBW:g.maxAudioBW,maxVideoBW:g.maxVideoBW,limitMaxAudioBW:u.maxAudioBW,limitMaxVideoBW:u.maxVideoBW,label:a.getLabel(),iceServers:t.iceServers,forceTurn:a.forceTurn,p2p:!1,streamRemovedListener:J};e||(l.simulcast=g.simulcast,l.startVideoBW=g.startVideoBW,
l.hardMinVideoBW=g.hardMinVideoBW);return l},E=function(a,b,c,g){var e=D(a,b,c,g,!0),q=t.erizoConnectionManager.getOrBuildErizoConnection(e,c,u.singlePC);a.addPC(q);q.on("connection-failed",function(){m(q)});a.on("added",z.bind(null,a));a.on("icestatechanged",function(b){p.debug("message: icestatechanged, "+a.toLog()+", iceConnectionState: "+b.msg.state+", "+w());"failed"===b.msg.state&&(C(a,"ICE Connection Failed","ice-client"),u.singlePC&&e.callback({type:"failed"}))})},M=function(a,b,c,g){var e=
D(a,b,c,g),q=t.erizoConnectionManager.getOrBuildErizoConnection(e,c,u.singlePC);a.addPC(q);q.on("connection-failed",function(){m(q)});a.on("icestatechanged",function(b){p.debug("message: icestatechanged, "+a.toLog()+", iceConnectionState: "+b.msg.state+", "+w());"failed"===b.msg.state&&(C(a,"ICE Connection Failed","ice-client"),u.singlePC&&e.callback({type:"failed"}))});a.pc.addStream(a)},Q=function(a){var b=a.streamIds,c=a.erizoId,g=a.connectionId,e=a.options,q;switch(a.type){case "multiple-initializing":b.forEach(function(a){q=
x.get(a);E(q,g,c,e)})}},R=function(a){a=a.streamIds;var b;a.forEach(function(a){b=x.get(a)});a.forEach(function(a){b=x.get(a);v(b);delete b.failed})},S=function(a){var b=a.evt.level,c=Number.MAX_SAFE_INTEGER,g="";y.forEach(function(e){!e.failed&&e.pc&&(e.pc.connectionId===a.connectionId&&e.pc.setQualityLevel(b),e=e.pc.getQualityLevel(),e.index<c&&(c=e.index,g=e.message))});x.forEach(function(e){e.failed&&e.pc&&(e.pc.connectionId===a.connectionId&&e.pc.setQualityLevel(b),e=e.pc.getQualityLevel(),e.index<
c&&(c=e.index,g=e.message))});g!==t.minConnectionQualityLevel&&(t.minConnectionQualityLevel=g,t.dispatchEvent(Object(d.e)({type:"quality-level",message:g})))},N=function(a){var b=a.stream;a=a.msg;b.local?q.sendMessage("sendDataStream",{id:b.getID(),msg:a}):p.error("message: You can not send data through a remote stream, "+b.toLog()+", "+w())},O=function(a){var b=a.stream;a=a.attrs;b.local?(b.updateLocalAttributes(a),q.sendMessage("updateStreamAttributes",{id:b.getID(),attrs:a})):p.error("message: You can not update attributes in a remote stream, "+
b.toLog()+", "+w())};l=function(a,b){b.args?a.apply(null,[].concat($jscomp.arrayFromIterable(b.args))):a()};var K=function(a,b,c){return{state:a,data:b.hasData(),audio:b.hasAudio(),video:b.hasVideo(),label:b.getLabel(),screen:b.hasScreen(),attributes:b.getAttributes(),metadata:c.metadata,createOffer:c.createOffer,muteStream:c.muteStream}},L=function(a,b,c,g){g=void 0===g?function(){}:g;null===a?(p.error("message: Error when publishing the stream, "+b.toLog()+", "+w()+", error: "+c),g(void 0,c)):(p.info("message: Stream published, "+
b.toLog()+", "+w()),b.getID=function(){return a},b.on("internal-send-data",N),b.on("internal-set-attributes",O),y.add(a,b),b.room=t,g(a))},T=function(a,b,c){c=void 0===c?function(){}:c;if(a.url){var g="url";var e=a.url}else g="recording",e=a.recording;p.debug("message: Checking publish options, "+a.toLog()+", "+w());a.checkOptions(b);q.sendSDP("publish",K(g,a,b),e,function(b,g){L(b,a,g,c)})},U=function(a,b,c){c=void 0===c?function(){}:c;a.maxAudioBW=b.maxAudioBW;a.maxVideoBW=b.maxVideoBW;q.sendSDP("publish",
K("p2p",a,b),void 0,function(b,g){L(b,a,g,c)})},V=function(a,b,c){c=void 0===c?function(){}:c;q.sendSDP("publish",K("data",a,b),void 0,function(b,g){L(b,a,g,c)})},W=function(a,b,c){c=void 0===c?function(){}:c;p.debug("message: Publishing to Erizo Normally, createOffer: "+b.createOffer+", "+w());var g=K("erizo",a,b);g.minVideoBW=b.minVideoBW;g.maxVideoBW=b.maxVideoBW;g.scheme=b.scheme;q.sendSDP("publish",g,void 0,function(g,e,q,l){null===g?(p.error("message: Error publishing stream, "+a.toLog()+", "+
w()+", error: "+l),c(void 0,l)):(L(g,a,l,void 0),M(a,q,e,b),c(g))})},B=function(a,b){a=b&&a.hasVideo();var c=b&&b.width,g=b&&b.height;b=b&&b.frameRate;return c||g||b?{width:c,height:g,frameRate:b}:a},X=function(a,b,c){c=void 0===c?function(){}:c;b.maxVideoBW=b.maxVideoBW||u.defaultVideoBW;b.maxVideoBW>u.maxVideoBW&&(b.maxVideoBW=u.maxVideoBW);b.audio=void 0===b.audio?!0:b.audio;b.video=void 0===b.video?!0:b.video;b.data=void 0===b.data?!0:b.data;b.offerFromErizo=void 0===b.offerFromErizo?!0:b.offerFromErizo;
a.checkOptions(b);var g={streamId:a.getID(),audio:b.audio&&a.hasAudio(),video:B(a,b.video),maxVideoBW:b.maxVideoBW,data:b.data&&a.hasData(),browser:t.ConnectionHelpers.getBrowser(),createOffer:b.createOffer,offerFromErizo:b.offerFromErizo,metadata:b.metadata,muteStream:b.muteStream,slideShowMode:b.slideShowMode};q.sendSDP("subscribe",g,void 0,function(g,e,q,l){null===g?(p.error("message: Error subscribing to stream, "+a.toLog()+", "+w()+", error: "+l),a.state="unsubscribed",c(void 0,l)):(p.debug("message: Subscriber added, "+
a.toLog()+", "+w()+", erizoId: "+e+", connectionId: "+q),E(a,q,e,b),b.offerFromErizo||a.pc.sendOffer(),c(!0))})},Y=function(a,b,c){c=void 0===c?function(){}:c;q.sendSDP("subscribe",{streamId:a.getID(),data:b.data,metadata:b.metadata},void 0,function(b,g){null===b?(p.error("message: Error subscribing to stream, "+a.toLog()+", "+w()+", error: "+g),a.state="unsubscribed",c(void 0,g)):(p.debug("message: Stream subscribed, "+a.toLog()+", "+w()),b=Object(d.f)({type:"stream-subscribed",stream:a}),t.dispatchEvent(b),
c(!0))})};t.connect=function(a){a=void 0===a?{}:a;var c=e.a.decodeBase64(u.token);0!==t.state&&p.warning("message: Room already connected, roomId: "+t.roomID+", "+w());t.state=1;p.info("message: Connecting to room, tokenId: "+c.tokenId+", "+w());q.connect(JSON.parse(c),a,function(a){var c=[],g=a.streams||[],e=a.id;t.p2p=a.p2p;t.iceServers=a.iceServers;t.state=2;u.singlePC=a.singlePC;u.defaultVideoBW=a.defaultVideoBW;u.maxVideoBW=a.maxVideoBW;for(var q=Object.keys(g),l=0;l<q.length;l+=1){var f=g[q[l]];
a=Object(b.a)(t.ConnectionHelpers,{streamID:f.id,local:!1,audio:f.audio,video:f.video,data:f.data,label:f.label,screen:f.screen,attributes:f.attributes});a.room=t;a.state="unsubscribed";c.push(a);x.add(f.id,a)}t.roomID=e;p.info("message: Connected to room, "+w());c=Object(d.e)({type:"room-connected",streams:c});t.dispatchEvent(c)},function(a){p.error("message: Error connecting to room, "+w()+", error: "+a);a=Object(d.e)({type:"room-error",message:a});t.dispatchEvent(a)})};t.disconnect=function(){p.info("message: Disconnection requested, "+
w());var a=Object(d.e)({type:"room-disconnected",message:"expected-disconnection"});t.dispatchEvent(a)};t.publish=function(a,b,c){b=void 0===b?{}:b;c=void 0===c?function(){}:c;p.info("message: Publishing stream, "+a.toLog()+", "+w());b.maxVideoBW=b.maxVideoBW||u.defaultVideoBW;b.maxVideoBW>u.maxVideoBW&&(b.maxVideoBW=u.maxVideoBW);void 0===b.minVideoBW&&(b.minVideoBW=0);b.minVideoBW>u.defaultVideoBW&&(b.minVideoBW=u.defaultVideoBW);a.forceTurn=b.forceTurn;b.simulcast=b.simulcast||!1;b.muteStream=
{audio:a.audioMuted,video:a.videoMuted};a&&a.local&&!a.failed&&!y.has(a.getID())?a.hasMedia()?a.isExternal()?T(a,b,c):t.p2p?U(a,b,c):W(a,b,c):a.hasData()&&V(a,b,c):(p.error("message: Trying to publish invalid stream, "+a.toLog()+", "+w()),c(void 0,"Invalid Stream"))};t.startRecording=function(a,b){b=void 0===b?function(){}:b;void 0===a?(p.error("message: Trying to start recording on an invalid stream, "+a.toLog()+", "+w()),b(void 0,"Invalid Stream")):(p.debug("message: Start Recording stream, "+a.toLog()+
", "+w()),q.sendMessage("startRecorder",{to:a.getID()},function(c,g){null===c?(p.error("message: Error on start recording, "+a.toLog()+", "+w()+", error: "+g),b(void 0,g)):(p.debug("message: Start recording, id: "+c+", "+w()),b(c))}))};t.stopRecording=function(a,b){b=void 0===b?function(){}:b;q.sendMessage("stopRecorder",{id:a},function(c,g){null===c?(p.error("message: Error on stop recording, recordingId: "+a+", "+w()+", error: "+g),b(void 0,g)):(p.debug("message: Stop recording, id: "+a+", "+w()),
b(!0))})};t.unpublish=function(a,b){b=void 0===b?function(){}:b;if(a&&a.local){q.sendMessage("unpublish",a.getID(),function(c,g){null===c?(p.error("message: Error unpublishing stream, "+a.toLog()+", "+w()+", error: "+g),b(void 0,g)):(p.info("message: Stream unpublished, "+a.toLog()+", "+w()),delete a.failed,b(!0))});p.info("message: Unpublishing stream, "+a.toLog()+", "+w());a.room=void 0;if(a.hasMedia()&&!a.isExternal()){var c=y.has(a.getID())?y.get(a.getID()):a;v(c)}y.remove(a.getID());a.getID=
function(){};a.off("internal-send-data",N);a.off("internal-set-attributes",O)}else c="message: Cannot unpublish because stream does not exist or is not local, "+a.toLog()+", "+w(),p.error(c),b(void 0,c)};t.sendControlMessage=function(a,b,c){a&&a.getID()&&(b={type:"control",action:c},q.sendSDP("streamMessage",{streamId:a.getID(),msg:b}))};t.subscribe=function(a,b,c){b=void 0===b?{}:b;c=void 0===c?function(){}:c;if(!a||a.local||a.failed)b="Error on subscribe",a.state="unsubscribed",a?a.local?(p.warning("message: Cannot subscribe to local stream, "+
a.toLog()+", "+w()),b="Local copy of stream"):a.failed&&(p.warning("message: Cannot subscribe to failed stream, "+a.toLog()+", "+w()+","+("unsubscribing: "+a.unsubscribing+", failed: "+a.failed)),b="Failed stream"):(p.warning("message: Cannot subscribe to invalid stream, "+a.toLog()+", "+w()),b="Invalid or undefined stream"),c(void 0,b);else if("unsubscribed"!==a.state)p.warning("message: Cannot subscribe to a subscribed stream, "+a.toLog()+", "+w()),c(void 0,"Stream already subscribed");else{a.state=
"subscribing";if(a.hasMedia())if(a.hasVideo()||a.hasScreen()||(b.video=!1),a.hasAudio()||(b.audio=!1),b.muteStream={audio:a.audioMuted,video:a.videoMuted},a.forceTurn=b.forceTurn,t.p2p){var g=x.get(a.getID());g.maxAudioBW=b.maxAudioBW;g.maxVideoBW=b.maxVideoBW;q.sendSDP("subscribe",{streamId:a.getID(),metadata:b.metadata});c(!0)}else X(a,b,c);else if(a.hasData()&&!1!==b.data)Y(a,b,c);else{p.warning("message: There is nothing to subscribe to in stream, "+a.toLog()+", "+w());a.state="unsubscribed";
c(void 0,"Nothing to subscribe to");return}p.info("message: Subscribing to stream, "+a.toLog()+", "+w())}};t.unsubscribe=function(a,b){b=void 0===b?function(){}:b;void 0!==q&&(a&&!a.local?"subscribed"!==a.state?(p.warning("message: Cannot unsubscribe to a stream that is not subscribed, "+a.toLog()+", "+w()),b(void 0,"Stream not subscribed")):(a.state="unsubscribing",p.info("message: Subscribing to stream, "+a.toLog()+", "+w()),q.sendMessage("unsubscribe",a.getID(),function(c,g){null===c?(a.state=
"subscribed",b(void 0,g)):(b(!0),a.unsubscribing.callbackReceived=!0,k(a))},function(){a.state="subscribed";p.error("message: Error calling unsubscribe, "+a.toLog()+", "+w())})):(a.state="unsubscribed",b(void 0,"Error unsubscribing, stream does not exist or is not local")))};t.autoSubscribe=function(a,b,c,g){q&&q.sendMessage("autoSubscribe",{selectors:a,negativeSelectors:b,options:c},function(a){a&&g(a)})};t.getStreamStats=function(a,b){b=void 0===b?function(){}:b;if(!q)return"Error getting stats - no socket";
if(!a)return"Error getting stats - no stream";q.sendMessage("getStreamStats",a.getID(),function(a){a&&b(a)})};t.getStreamsByAttribute=function(a,b){var c=[];x.forEach(function(g){void 0!==g.getAttributes()&&g.getAttributes()[a]===b&&c.push(g)});return c};t.on("room-disconnected",function(){t.state=0;q.state=q.DISCONNECTED;t.erizoConnectionManager.ErizoConnectionsMap.forEach(function(a){Object.keys(a).forEach(function(b){a[b].close()})});x.forEach(function(a,b){v(a);x.remove(b);a&&!a.failed&&(a=Object(d.f)({type:"stream-removed",
stream:a}),t.dispatchEvent(a))});x=Object(n.a)();y.forEach(function(a,b){v(a);y.remove(b)});y=Object(n.a)();try{q.disconnect()}catch(P){p.debug("message: Socket already disconnected, "+w()+", error: "+P)}p.info("message: Disconnected from room, roomId: "+t.roomID+", "+w());q=void 0});q.on("onAddStream",l.bind(null,function(a){if(!x.has(a.id)){var c=Object(b.a)(t.Connection,{streamID:a.id,local:y.has(a.id),audio:a.audio,video:a.video,data:a.data,label:a.label,screen:a.screen,attributes:a.attributes});
c.room=t;c.state="unsubscribed";x.add(a.id,c);a=Object(d.f)({type:"stream-added",stream:c});t.dispatchEvent(a)}}));q.on("stream_message_erizo",l.bind(null,function(a){"auto-streams-subscription"===a.context?Q(a.mess):"auto-streams-unsubscription"===a.context?R(a.mess):p.debug("message: Failed applying a stream message from erizo, "+w()+", msg: "+JSON.stringify(a))}));q.on("stream_message_p2p",l.bind(null,function(a){var b=y.get(a.streamId);b&&!b.failed?b.pc.get(a.peerSocket).processSignalingMessage(a.msg):
(b=x.get(a.streamId),b.pc||I(b,a.peerSocket),b.pc.processSignalingMessage(a.msg))}));q.on("connection_message_erizo",l.bind(null,function(a){if("quality_level"===a.evt.type)S(a);else{var b=t.erizoConnectionManager.getErizoConnection(a.connectionId);b?b.processSignalingMessage(a.evt):p.warning("message: Received signaling message to unknown connectionId, connectionId: "+a.connectionId+", "+w())}}));q.on("publish_me",l.bind(null,function(a){var b=y.get(a.streamId);r(b,a.peerSocket)}));q.on("unpublish_me",
l.bind(null,function(a){var b=y.get(a.streamId);b&&(a=a.peerSocket,void 0!==b.pc&&b.pc.has(a)&&(b.pc.get(a).close(),b.pc.remove(a)))}));q.on("onBandwidthAlert",l.bind(null,function(a){p.debug("message: Bandwidth Alert, streamId: "+a.streamID+", bwMessage: "+a.message+", bandwidth: "+a.bandwidth+", "+w());if(a.streamID){var b=x.get(a.streamID);b&&!b.failed&&(a=Object(d.f)({type:"bandwidth-alert",stream:b,msg:a.message,bandwidth:a.bandwidth}),b.dispatchEvent(a))}}));q.on("onDataStream",l.bind(null,
function(a){var b=x.get(a.id);a=Object(d.f)({type:"stream-data",msg:a.msg,stream:b});b.dispatchEvent(a)}));q.on("onUpdateAttributeStream",l.bind(null,function(a){var b=x.get(a.id),c=Object(d.f)({type:"stream-attributes-update",attrs:a.attrs,stream:b});b.updateLocalAttributes(a.attrs);b.dispatchEvent(c)}));q.on("onRemoveStream",l.bind(null,function(a){var b=y.get(a.id);if(b)C(b,"Stream removed from server","server");else if(b=x.get(a.id))p.info("message: Stream removed, "+b.toLog()+", "+w()),v(b),
x.remove(a.id),a=Object(d.f)({type:"stream-removed",stream:b}),t.dispatchEvent(a)}));q.on("disconnect",l.bind(null,function(){p.info("message: Socket disconnected, reason: lost connection to ErizoController, "+w());if(0!==t.state){p.error("message: Unexpected disconnection from ErizoController, "+w());var a=Object(d.e)({type:"room-disconnected",message:"unexpected-disconnection"});t.dispatchEvent(a)}}));q.on("reconnecting",l.bind(null,function(){p.info("message: Socket reconnecting, reason: lost connection to ErizoController, "+
w());var a=Object(d.e)({type:"room-reconnecting",message:"reconnecting"});t.dispatchEvent(a)}));q.on("reconnected",l.bind(null,function(){p.info("message: Socket reconnected, reason: restablished connection to ErizoController, "+w());var a=Object(d.e)({type:"room-reconnected",message:"reconnected"});t.dispatchEvent(a)}));q.on("connection_failed",l.bind(null,function(a){if(a.streamId){var b="message: ICE Connection Failed, type: "+a.type+", streamId: "+a.streamId+", state: "+t.state+", "+w();p.error(b);
a="publish"===a.type?y.get(a.streamId):x.get(a.streamId);C(a,b,"ice-server")}}));q.on("error",l.bind(null,function(a){p.error("message: Cannot connect to erizo Controller, "+w()+", error: "+a);a=Object(d.e)({type:"room-error",message:a});t.dispatchEvent(a)}));return t}},function(m,r,k){var f=k(27),h=k(39),d=k(40);m=k(0);var a=k(1),b=k(7),n=k(8),e=a.c,p=103,l=["high-packet-losses","low-packet-losses","good"],g=m.a.module("ErizoConnection"),c=function(c,l){var q=e.call(this)||this;q.stack={};q.erizoId=
l;q.streamsMap=Object(b.a)();p+=1;c.sessionId=p;q.sessionId=p;q.connectionId=c.connectionId;q.qualityLevel="good";g.debug("message: Building a new Connection, "+q.toLog());c.onEnqueueingTimeout=function(){q.emit(Object(a.a)({type:"connection-failed",id:q.connectionId}))};c.streamRemovedListener||(c.streamRemovedListener=function(){});q.streamRemovedListener=c.streamRemovedListener;q.browser=n.a.getBrowser();if("fake"===q.browser)g.warning("message: Publish/subscribe video/audio streams not supported in erizofc yet, "+
q.toLog()),q.stack=Object(d.a)(c);else if("mozilla"===q.browser)g.debug("message: Firefox Stack, "+q.toLog()),q.stack=Object(h.a)(c);else if("safari"===q.browser)g.debug("message: Safari using Chrome Stable Stack, "+q.toLog()),q.stack=Object(f.a)(c);else if("chrome-stable"===q.browser||"electron"===q.browser)g.debug("message: Chrome Stable Stack, "+q.toLog()),q.stack=Object(f.a)(c);else throw g.error("message: No stack available for this browser, "+q.toLog()),Error("WebRTC stack not available");q.stack.updateSpec||
(q.stack.updateSpec=function(a,b){b=void 0===b?function(){}:b;g.error("message: Update Configuration not implemented in this browser, "+q.toLog());b("unimplemented")});q.stack.setSignallingCallback||(q.stack.setSignallingCallback=function(){g.error("message: setSignallingCallback is not implemented in this stack, "+q.toLog())});q.stack.peerConnection&&(q.peerConnection=q.stack.peerConnection,q.stack.peerConnection.onaddstream=function(b){q.emit(Object(a.a)({type:"add-stream",stream:b.stream}))},q.stack.peerConnection.onremovestream=
function(b){q.emit(Object(a.a)({type:"remove-stream",stream:b.stream}));q.streamRemovedListener(b.stream.id)},q.stack.peerConnection.oniceconnectionstatechange=function(){q.emit(Object(a.a)({type:"ice-state-change",state:q.stack.peerConnection.iceConnectionState}))});return q};$jscomp.inherits(c,e);c.prototype.toLog=function(){return"connectionId: "+this.connectionId+", sessionId: "+this.sessionId+", qualityLevel: "+this.qualityLevel+", erizoId: "+this.erizoId};c.prototype.close=function(){g.debug("message: Closing ErizoConnection, "+
this.toLog());this.streamsMap.clear();this.stack.close()};c.prototype.createOffer=function(a,b){this.stack.createOffer(a,b)};c.prototype.sendOffer=function(){this.stack.sendOffer()};c.prototype.addStream=function(a){g.debug("message: Adding stream to Connection, "+this.toLog()+", "+a.toLog());this.streamsMap.add(a.getID(),a);a.local&&this.stack.addStream(a.stream)};c.prototype.removeStream=function(a){var b=a.getID();this.streamsMap.has(b)?(this.streamsMap.remove(b),a.local?this.stack.removeStream(a.stream):
0===this.streamsMap.size()&&this.streamRemovedListener(a.getLabel())):g.debug("message: Cannot remove stream not in map, "+this.toLog()+", "+a.toLog())};c.prototype.processSignalingMessage=function(a){this.stack.processSignalingMessage(a)};c.prototype.sendSignalingMessage=function(a){this.stack.sendSignalingMessage(a)};c.prototype.setSimulcast=function(a){this.stack.setSimulcast(a)};c.prototype.setVideo=function(a){this.stack.setVideo(a)};c.prototype.setAudio=function(a){this.stack.setAudio(a)};c.prototype.updateSpec=
function(a,b,c){this.stack.updateSpec(a,b,c)};c.prototype.updateSimulcastLayersBitrate=function(a){this.stack.updateSimulcastLayersBitrate(a)};c.prototype.setQualityLevel=function(a){this.qualityLevel=l[a]};c.prototype.getQualityLevel=function(){return{message:this.qualityLevel,index:l.indexOf(this.qualityLevel)}};k=function(){this.ErizoConnectionsMap=new Map};k.prototype.getErizoConnection=function(a){var b;this.ErizoConnectionsMap.forEach(function(c){Object.keys(c).forEach(function(g){c[g].connectionId===
a&&(b=c[g])})});return b};k.prototype.getOrBuildErizoConnection=function(a,b,e){e=void 0===e?!1:e;g.debug("message: getOrBuildErizoConnection, erizoId: "+b+", singlePC: "+e);if(void 0===b)return new c(a);if(e)this.ErizoConnectionsMap.has(b)?e=this.ErizoConnectionsMap.get(b):(e={},this.ErizoConnectionsMap.set(b,e)),e["single-pc"]||(e["single-pc"]=new c(a,b)),e=e["single-pc"];else if(e=new c(a,b),this.ErizoConnectionsMap.has(b))this.ErizoConnectionsMap.get(b)[e.sessionId]=e;else{var q={};q[e.sessionId]=
e;this.ErizoConnectionsMap.set(b,q)}a.simulcast&&e.setSimulcast(a.simulcast);a.video&&e.setVideo(a.video);a.audio&&e.setVideo(a.audio);return e};k.prototype.maybeCloseConnection=function(a,b){b=void 0===b?!1:b;g.debug("message: Trying to remove connection, "+a.toLog());if(0===a.streamsMap.size()||b)g.debug("message: No streams in connection, "+a.toLog()),void 0!==this.ErizoConnectionsMap.get(a.erizoId)&&this.ErizoConnectionsMap.get(a.erizoId)["single-pc"]&&!b?g.debug("message: Will not remove empty connection, "+
a.toLog()+", reason: It is singlePC"):(a.close(),void 0!==this.ErizoConnectionsMap.get(a.erizoId)&&(delete this.ErizoConnectionsMap.get(a.erizoId)["single-pc"],delete this.ErizoConnectionsMap.get(a.erizoId)[a.sessionId]))};r.a=k},function(m,r,k){var f=k(9),h=k(21),d=k(0).a.module("ChromeStableStack");r.a=function(a){d.debug("message: Starting Chrome stable stack, spec: "+JSON.stringify(a));var b=Object(f.a)(a);b.mediaConstraints={offerToReceiveVideo:!0,offerToReceiveAudio:!0};b.enableSimulcast=function(a){var e=
a;if(!b.simulcast||null!==e.match(/a=ssrc-group:SIM/g))return e;a=e.match(/a=ssrc-group:FID ([0-9]*) ([0-9]*)\r?\n/);if(!a||0>=a.length)return e;var l=b.simulcast.numSpatialLayers||2;var g=parseInt(a[1],10),c=parseInt(a[2],10),d=e.match(new RegExp("a\x3dssrc:"+a[1]+" cname:(.*)\r?\n"))[1],f=e.match(new RegExp("a\x3dssrc:"+a[1]+" msid:(.*)\r?\n"))[1],q=e.match(new RegExp("a\x3dssrc:"+a[1]+" mslabel:(.*)\r?\n"))[1],n=e.match(new RegExp("a\x3dssrc:"+a[1]+" label:(.*)\r?\n"))[1];e.match(new RegExp("a\x3dssrc:"+
a[1]+".*\r?\n","g")).forEach(function(a){e=e.replace(a,"")});e.match(new RegExp("a\x3dssrc:"+a[2]+".*\r?\n","g")).forEach(function(a){e=e.replace(a,"")});for(var y=[g],w=[c],v=1;v<l;v+=1)y.push(g+1E3*v),w.push(c+1E3*v);l=h.a.addSim(y);for(v=0;v<y.length;v+=1)g=y[v],c=w[v],l+=h.a.addGroup(g,c);for(v=0;v<y.length;v+=1)g=y[v],c=w[v],l+=h.a.addSpatialLayer(d,f,q,n,g,c);return e.replace(a[0],l+"a\x3dx-google-flag:conference\r\n")};var n=function(a){if("function"!==typeof a.getParameters||"function"!==
typeof a.setParameters)d.warning("message: Cannot set simulcast layers bitrate, reason: get/setParameters not available");else{var e=a.getParameters();Object.keys(b.simulcast.spatialLayerBitrates).forEach(function(a){void 0!==e.encodings[a]&&(d.debug("message: Setting bitrate for layer, layer: "+a+", bps: "+b.simulcast.spatialLayerBitrates[a]),e.encodings[a].maxBitrate=b.simulcast.spatialLayerBitrates[a])});a.setParameters(e).then(function(a){d.debug("message: Success setting simulcast layer bitrates, result: "+
a)}).catch(function(a){d.warning("message: Error setting simulcast layer bitrates, error: "+a)})}};b.prepareCreateOffer=function(){return Promise.resolve()};b.setSimulcastLayersBitrate=function(){d.debug("message: Maybe set simulcast Layers bitrate, simulcast: "+JSON.stringify(b.simulcast));b.simulcast&&b.simulcast.spatialLayerBitrates&&b.peerConnection.getSenders().forEach(function(a){"video"===a.track.kind&&n(a)})};b.setStartVideoBW=function(e){b.video&&a.startVideoBW&&(d.debug("message: startVideoBW, requested: "+
a.startVideoBW),h.a.setParamForCodecs(e,"video","x-google-start-bitrate",a.startVideoBW))};b.setHardMinVideoBW=function(e){b.video&&a.hardMinVideoBW&&(d.debug("message: hardMinVideoBW, requested: "+a.hardMinVideoBW),h.a.setParamForCodecs(e,"video","x-google-min-bitrate",a.hardMinVideoBW))};return b}},function(m,r,k){r=k(29);var f=k(11),h=k(12),d=k(13),a=k(14),b=k(15),n=k(2),e=k(17),p=k(18),l=k(19),g=k(20);k=k(4);m.exports={SDPInfo:r,CandidateInfo:f,CodecInfo:h,DTLSInfo:d,ICEInfo:a,MediaInfo:b,Setup:n,
SourceGroupInfo:e,SourceInfo:p,StreamInfo:l,TrackInfo:g,Direction:k}},function(m,r,k){function f(a,b){var c=new Map;b.rtp.forEach(function(g){var e=g.payload,q=g.codec,l=g.rate;g=g.encoding;var d={},f=[];b.fmtp.forEach(function(a){a.payload===e&&a.config.split(";").forEach(function(a){a=a.split("\x3d");d[a[0].trim()]=(a[1]||"").trim()})});b.rtcpFb&&b.rtcpFb.forEach(function(a){a.payload===e&&f.push({type:a.type,subtype:a.subtype})});"RTX"===q.toUpperCase()?c.set(parseInt(d.apt,10),e):a.addCodec(new p(q,
e,l,g,d,f))});c.forEach(function(b,c){(c=a.getCodecForType(c))&&c.setRTX(b)})}function h(a,b){(b=b.rids)&&b.forEach(function(b){var c=new C(b.id,q.byValue(b.direction)),g=[],e=new Map;if(b.params){var l=n.parseParams(b.params);Object.keys(l).forEach(function(a){"pt"===a?g=l[a].split(","):e.set(a,l[a])});c.setFormats(g);c.setParams(e)}a.addRID(c)})}function d(a,b,c){var g=b.simulcast["dir"+a];a=b.simulcast["list"+a];if(g){var e=q.byValue(g);n.parseSimulcastStreamList(a).forEach(function(a){var b=[];
a.forEach(function(a){b.push(new G(a.scid,a.paused))});c.addSimulcastAlternativeStreams(e,b)})}}function a(a,b){var c=[];if(b.simulcast){var g=new F;d("1",b,g);d("2",b,g);g.getSimulcastStreams(q.SEND).forEach(function(b){var g=[];b.forEach(function(b){var c=new z(b.getId(),b.isPaused());if(b=a.getRID(c.getId()))b.getFormats().forEach(function(b){(b=a.getCodecForType(b))&&c.addCodec(b)}),c.setParams(b.getParams()),g.push(c)});g.length&&c.push(g)});a.setSimulcast(g)}b.simulcast_03&&(g=new F,g.setSimulcastPlainString(b.simulcast_03.value),
a.setSimulcast03(g));return c}function b(a,b,c){var g=new Map,e=c.type;if(c.ssrcs){var q,l,d;c.ssrcs.forEach(function(c){var f=c.id,h=c.attribute;c=c.value;d=g.get(f);d||(d=new y(f),g.set(d.getSSRC(),d));"cname"===h.toLowerCase()?d.setCName(c):"mslabel"===h.toLowerCase()?d.setMSLabel(c):"label"===h.toLowerCase()?d.setLabel(c):"msid"===h.toLowerCase()&&(h=c.split(" "),f=h[0],h=h[1],d.setStreamId(f),d.setTrackId(h),l=b.getStream(f),l||(l=new w(f),b.addStream(l)),q=l.getTrack(h),q||(q=new v(e,h),q.setEncodings(a),
l.addTrack(q)),q.addSSRC(d))})}if(c.msid){var f=c.msid.split(" "),h=f[0],n=f[1],f=b.getStream(h);f||(f=new w(h),b.addStream(f));var p=f.getTrack(n);p||(p=new v(e,n),p.setMediaId(c.mid),p.setEncodings(a),f.addTrack(p));g.forEach(function(a,b){a=g.get(b);a.getStreamId()||(a.setStreamId(h),a.setTrackId(n),p.addSSRC(a))})}c.ssrcGroups&&c.ssrcGroups.forEach(function(a){var c=a.ssrcs.split(" ");a=new x(a.semantics,c);c=g.get(parseInt(c[0],10));b.getStream(c.getStreamId()).getTrack(c.getTrackId()).addSourceGroup(a)})}
var n=k(30),e=k(11),p=k(12),l=k(13),g=k(14),c=k(15),u=k(2),t=k(4),q=k(3),x=k(17),y=k(18),w=k(19),v=k(20),z=k(33),F=k(16),G=k(34),C=k(35),A=function(a){this.version=a||1;this.name="sdp-semantic";this.streams=new Map;this.medias=[];this.candidates=[];this.dtls=this.ice=this.connection=null};A.prototype.clone=function(){var a=new A(this.version);a.name=this.name;a.setConnection(this.connection);this.medias.forEach(function(b){a.addMedia(b.clone())});this.streams.forEach(function(b){a.addStream(b.clone())});
this.candidates.forEach(function(b){a.addCandidate(b.clone())});a.setICE(this.ice.clone());a.setDTLS(this.dtls.clone());return a};A.prototype.plain=function(){var a={version:this.version,name:this.name,streams:[],medias:[],candidates:[],connection:this.connection};this.medias.forEach(function(b){a.medias.push(b.plain())});this.streams.forEach(function(b){a.streams.push(b.plain())});this.candidates.forEach(function(b){a.candidates.push(b.plain())});a.ice=this.ice&&this.ice.plain();a.dtls=this.dtls&&
this.dtls.plain();return a};A.prototype.setVersion=function(a){this.version=a};A.prototype.setOrigin=function(a){this.origin=a};A.prototype.setName=function(a){this.name=a};A.prototype.getConnection=function(){return this.connection};A.prototype.setConnection=function(a){this.connection=a};A.prototype.setTiming=function(a){this.timing=a};A.prototype.addMedia=function(a){this.medias.push(a)};A.prototype.getMedia=function(a){var b;this.medias.forEach(function(c){c.getType().toLowerCase()===a.toLowerCase()&&
(b=c)});return b};A.prototype.getMedias=function(a){if(!a)return this.medias;var b=[];this.medias.forEach(function(c){c.getType().toLowerCase()===a.toLowerCase()&&b.push(c)});return b};A.prototype.getMediaById=function(a){var b;this.medias.forEach(function(c){c.getId().toLowerCase()===a.toLowerCase()&&(b=c)});return b};A.prototype.getVersion=function(){return this.version};A.prototype.getDTLS=function(){return this.dtls};A.prototype.setDTLS=function(a){this.dtls=a};A.prototype.getICE=function(){return this.ice};
A.prototype.setICE=function(a){this.ice=a};A.prototype.addCandidate=function(a){this.candidates.push(a)};A.prototype.addCandidates=function(a){var b=this;a.forEach(function(a){b.addCandidate(a)})};A.prototype.getCandidates=function(){return this.candidates};A.prototype.getStream=function(a){return this.streams.get(a)};A.prototype.getStreams=function(){return this.streams};A.prototype.getFirstStream=function(){return 0<this.streams.values().length?this.streams.values()[0]:null};A.prototype.addStream=
function(a){this.streams.set(a.getId(),a)};A.prototype.removeStream=function(a){this.streams.delete(a.getId())};A.prototype.toJSON=function(){var a={version:0,media:[]};a.version=this.version||0;a.origin=this.origin||{username:"-",sessionId:(new Date).getTime(),sessionVersion:this.version,netType:"IN",ipVer:4,address:"127.0.0.1"};a.name=this.name||"semantic-sdp";a.connection=this.getConnection();a.timing=this.timing||{start:0,stop:0};var b=this.getICE();b&&(b.isLite()&&(a.icelite="ice-lite"),a.iceOptions=
b.getOpts(),a.iceUfrag=b.getUfrag(),a.icePwd=b.getPwd());a.msidSemantic=this.msidSemantic||{semantic:"WMS",token:"*"};a.groups=[];var c={type:"BUNDLE",mids:[]},g=this.getDTLS();g&&(a.fingerprint={type:g.getHash(),hash:g.getFingerprint()},a.setup=u.toString(g.getSetup()));this.medias.forEach(function(e){var l={type:e.getType(),port:e.getPort(),protocol:"UDP/TLS/RTP/SAVPF",fmtp:[],rtp:[],rtcpFb:[],ext:[],bandwidth:[],candidates:[],ssrcGroups:[],ssrcs:[],rids:[]};l.direction=t.toString(e.getDirection());
l.rtcpMux="rtcp-mux";l.connection=e.getConnection();l.xGoogleFlag=e.getXGoogleFlag();l.mid=e.getId();c.mids.push(e.getId());l.rtcp=e.rtcp;0<e.getBitrate()&&l.bandwidth.push({type:"AS",limit:e.getBitrate()});e.getCandidates().forEach(function(a){l.candidates.push({foundation:a.getFoundation(),component:a.getComponentId(),transport:a.getTransport(),priority:a.getPriority(),ip:a.getAddress(),port:a.getPort(),type:a.getType(),relAddr:a.getRelAddr(),relPort:a.getRelPort(),generation:a.getGeneration()})});
if(b=e.getICE())b.isLite()&&(l.icelite="ice-lite"),l.iceOptions=b.getOpts(),l.iceUfrag=b.getUfrag(),l.icePwd=b.getPwd(),b.isEndOfCandidates()&&(l.endOfCandidates=b.isEndOfCandidates());if(g=e.getDTLS())l.fingerprint={type:g.getHash(),hash:g.getFingerprint()},l.setup=u.toString(g.getSetup());e.setup&&(l.setup=u.toString(e.setup));e.getCodecs().forEach(function(a){l.rtp.push({payload:a.getType(),codec:a.getCodec(),rate:a.getRate(),encoding:a.getEncoding()});var b=a.getParams();0<Object.keys(b).length&&
l.fmtp.push({payload:a.getType(),config:Object.keys(b).map(function(a){return a+(b[a]?"\x3d"+b[a]:"")}).join(";")});a.getFeedback().forEach(function(b){l.rtcpFb.push({payload:a.getType(),type:b.type,subtype:b.subtype})});a.hasRTX()&&(l.rtp.push({payload:a.getRTX(),codec:"rtx",rate:a.getRate(),encoding:a.getEncoding()}),l.fmtp.push({payload:a.getRTX(),config:"apt\x3d"+a.getType()}))});var d=[];l.rtp.forEach(function(a){d.push(a.payload)});l.payloads=d.join(" ");e.getExtensions().forEach(function(a,
b){l.ext.push({value:b,uri:a})});e.getRIDs().forEach(function(a){var b={id:a.getId(),direction:q.toString(a.getDirection()),params:""};a.getFormats().length&&(b.params="pt\x3d"+a.getFormats().join(","));a.getParams().forEach(function(a,c){b.params+=""+(b.params.length?";":"")+c+"\x3d"+a});l.rids.push(b)});var f=e.getSimulcast();e=e.getSimulcast03();if(f){var h=1;l.simulcast={};var n=f.getSimulcastStreams(q.SEND),f=f.getSimulcastStreams(q.RECV);if(n&&n.length){var x="";n.forEach(function(a){var b=
"";a.forEach(function(a){b+=(b.length?",":"")+(a.isPaused()?"~":"")+a.getId()});x+=(x.length?";":"")+b});l.simulcast["dir"+h]="send";l.simulcast["list"+h]=x;h+=1}if(f&&f.length){var p=[];f.forEach(function(a){var b="";a.forEach(function(a){b+=(b.length?",":"")+(a.isPaused()?"~":"")+a.getId()});p+=(p.length?";":"")+b});l.simulcast["dir"+h]="recv";l.simulcast["list"+h]=p;h+=1}}e&&(l.simulcast_03={value:e.getSimulcastPlainString()});a.media.push(l)});c.mids.sort();a.media.sort(function(a,b){return a.mid<
b.mid?-1:a.mid>b.mid?1:0});for(var e=$jscomp.makeIterator(this.streams.values()),l=e.next();!l.done;l=e.next())for(var l=l.value,d=$jscomp.makeIterator(l.getTracks().values()),f=d.next();!f.done;f=d.next())for(var f=f.value,h={},n=$jscomp.makeIterator(a.media),x=n.next();!x.done;h={md:h.md},x=n.next())if(h.md=x.value,f.getMediaId()){if(f.getMediaId()===h.md.mid){f.getSourceGroups().forEach(function(a){return function(b){a.md.ssrcGroups.push({semantics:b.getSemantics(),ssrcs:b.getSSRCs().join(" ")})}}(h));
f.getSSRCs().forEach(function(a){return function(b){a.md.ssrcs.push({id:b.ssrc,attribute:"cname",value:b.getCName()})}}(h));l.getId()&&f.getId()&&(h.md.msid=l.getId()+" "+f.getId());break}}else if(h.md.type.toLowerCase()===f.getMedia().toLowerCase()){f.getSourceGroups().forEach(function(a){return function(b){a.md.ssrcGroups.push({semantics:b.getSemantics(),ssrcs:b.getSSRCs().join(" ")})}}(h));f.getSSRCs().forEach(function(a){return function(b){a.md.ssrcs.push({id:b.ssrc,attribute:"cname",value:b.getCName()});
b.getStreamId()&&b.getTrackId()&&a.md.ssrcs.push({id:b.ssrc,attribute:"msid",value:b.getStreamId()+" "+b.getTrackId()});b.getMSLabel()&&a.md.ssrcs.push({id:b.ssrc,attribute:"mslabel",value:b.getMSLabel()});b.getLabel()&&a.md.ssrcs.push({id:b.ssrc,attribute:"label",value:b.getLabel()})}}(h));break}c.mids=c.mids.join(" ");a.groups.push(c);return a};A.prototype.toString=function(){var a=this.toJSON();return n.write(a)};A.processString=function(a){a=n.parse(a);return A.process(a)};A.process=function(q){var d=
new A;d.setVersion(q.version);d.setTiming(q.timing);d.setConnection(q.connection);d.setOrigin(q.origin);d.msidSemantic=q.msidSemantic;d.name=q.name;var n=q.iceUfrag,x=q.icePwd,p=q.iceOptions;(n||x||p)&&d.setICE(new g(n,x,p));var v=q.fingerprint;if(v){var y=v.type,z=v.hash,w=null;q.setup&&(w=u.byValue(q.setup));d.setDTLS(new l(w,y,z))}q.media.forEach(function(q){var y=new c(q.mid,q.port,q.type);y.setXGoogleFlag(q.xGoogleFlag);y.rtcp=q.rtcp;y.setConnection(q.connection);q.bandwidth&&0<q.bandwidth.length&&
q.bandwidth.forEach(function(a){"AS"===a.type&&y.setBitrate(a.limit)});n=q.iceUfrag;x=q.icePwd;p=q.iceOptions;if(n||x||p){var z=new g(n,x,p);q.endOfCandidates&&z.setEndOfCandidates("end-of-candidates");y.setICE(z)}if(v=q.fingerprint){var z=v.type,w=v.hash,k=u.ACTPASS;q.setup&&(k=u.byValue(q.setup));y.setDTLS(new l(k,z,w))}q.setup&&y.setSetup(u.byValue(q.setup));z=t.SENDRECV;q.direction&&(z=t.byValue(q.direction.toUpperCase()));y.setDirection(z);(z=q.candidates)&&z.forEach(function(a){y.addCandidate(new e(a.foundation,
a.component,a.transport,a.priority,a.ip,a.port,a.type,a.generation,a.relAddr,a.relPort))});f(y,q);(z=q.ext)&&z.forEach(function(a){y.addExtension(a.value,a.uri)});h(y,q);z=a(y,q);b(z,d,q);d.addMedia(y)});return d};m.exports=A},function(m,r,k){m=k(31);k=k(32);r.write=k;r.parse=m.parse;r.parseFmtpConfig=m.parseFmtpConfig;r.parseParams=m.parseParams;r.parsePayloads=m.parsePayloads;r.parseRemoteCandidates=m.parseRemoteCandidates;r.parseImageAttributes=m.parseImageAttributes;r.parseSimulcastStreamList=
m.parseSimulcastStreamList},function(m,r,k){var f=function(a){return String(Number(a))===a?Number(a):a},h=k(10),d=RegExp.prototype.test.bind(/^([a-z])=(.*)/);r.parse=function(a){var b={},e=[],p=b;a.split(/(\r\n|\r|\n)/).filter(d).forEach(function(a){var b=a[0],c=a.slice(2);"m"===b&&(e.push({rtp:[],fmtp:[]}),p=e[e.length-1]);for(a=0;a<(h[b]||[]).length;a+=1){var l=h[b][a];if(l.reg.test(c)){b=l;a=p;l=c;c=b.name&&b.names;b.push&&!a[b.push]?a[b.push]=[]:c&&!a[b.name]&&(a[b.name]={});var c=b.push?{}:c?
a[b.name]:a,l=l.match(b.reg),d=c,q=b.names,n=b.name;if(n&&!q)d[n]=f(l[1]);else for(n=0;n<q.length;n+=1)null!=l[n+1]&&(d[q[n]]=f(l[n+1]));b.push&&a[b.push].push(c);break}}});b.media=e;return b};var a=function(a,d){d=d.split(/=(.+)/,2);2===d.length&&(a[d[0]]=f(d[1]));return a};r.parseParams=function(b){return b.split(/\;\s?/).reduce(a,{})};r.parseFmtpConfig=r.parseParams;r.parsePayloads=function(a){return a.split(" ").map(Number)};r.parseRemoteCandidates=function(a){var b=[];a=a.split(" ").map(f);for(var e=
0;e<a.length;e+=3)b.push({component:a[e],ip:a[e+1],port:a[e+2]});return b};r.parseImageAttributes=function(b){return b.split(" ").map(function(b){return b.substring(1,b.length-1).split(",").reduce(a,{})})};r.parseSimulcastStreamList=function(a){return a.split(";").map(function(a){return a.split(",").map(function(a){var b=!1;"~"!==a[0]?a=f(a):(a=f(a.substring(1,a.length)),b=!0);return{scid:a,paused:b}})})}},function(m,r,k){var f=k(10),h=/%[sdv%]/g,d=function(a){var b=1,e=arguments,g=e.length;return a.replace(h,
function(a){if(b>=g)return a;var c=e[b];b+=1;switch(a){case "%%":return"%";case "%s":return String(c);case "%d":return Number(c);case "%v":return""}})},a=function(a,b,l){var g=b.format instanceof Function?b.format(b.push?l:l[b.name]):b.format;a=[a+"\x3d"+g];if(b.names)for(g=0;g<b.names.length;g+=1){var c=b.names[g];b.name?a.push(l[b.name][c]):a.push(l[b.names[g]])}else a.push(l[b.name]);return d.apply(null,a)},b="vosiuepcbtrza".split(""),n=["i","c","b","a"];m.exports=function(e,d){d=d||{};null==e.version&&
(e.version=0);null==e.name&&(e.name=" ");e.media.forEach(function(a){null==a.payloads&&(a.payloads="")});var l=d.innerOrder||n,g=[];(d.outerOrder||b).forEach(function(b){f[b].forEach(function(c){c.name in e&&null!=e[c.name]?g.push(a(b,c,e)):c.push in e&&null!=e[c.push]&&e[c.push].forEach(function(e){g.push(a(b,c,e))})})});e.media.forEach(function(b){g.push(a("m",f.m[0],b));l.forEach(function(c){f[c].forEach(function(e){e.name in b&&null!=b[e.name]?g.push(a(c,e,b)):e.push in b&&null!=b[e.push]&&b[e.push].forEach(function(b){g.push(a(c,
e,b))})})})});return g.join("\r\n")+"\r\n"}},function(m,r){var k=function(f,h){this.id=f;this.paused=h;this.codecs=new Map;this.params=new Map};k.prototype.clone=function(){var f=new k(this.id,this.paused);this.codecs.forEach(function(h){f.addCodec(h.cloned())});f.setParams(this.params);return f};k.prototype.plain=function(){var f=this,h={id:this.id,paused:this.paused,codecs:{},params:{}};this.codecs.keys().forEach(function(d){h.codecs[d]=f.codecs.get(d).plain()});this.params.keys().forEach(function(d){h.params[d]=
f.params.get(d).param});return h};k.prototype.getId=function(){return this.id};k.prototype.getCodecs=function(){return this.codecs};k.prototype.addCodec=function(f){this.codecs.set(f.getType(),f)};k.prototype.getParams=function(){return this.params};k.prototype.setParams=function(f){this.params=new Map(f)};k.prototype.isPaused=function(){return this.paused};m.exports=k},function(m,r){var k=function(f,h){this.paused=h;this.id=f};k.prototype.clone=function(){return new k(this.id,this.paused)};k.prototype.plain=
function(){return{id:this.id,paused:this.paused}};k.prototype.isPaused=function(){return this.paused};k.prototype.getId=function(){return this.id};m.exports=k},function(m,r,k){var f=k(3),h=function(d,a){this.id=d;this.direction=a;this.formats=[];this.params=new Map};h.prototype.clone=function(){var d=new h(this.id,this.direction);d.setFormats(this.formats);d.setParams(this.params);return d};h.prototype.plain=function(){var d={id:this.id,direction:f.toString(this.direction),formats:this.formats,params:{}};
this.params.forEach(function(a,b){d.params[b]=a});return d};h.prototype.getId=function(){return this.id};h.prototype.getDirection=function(){return this.direction};h.prototype.setDirection=function(d){this.direction=d};h.prototype.getFormats=function(){return this.formats};h.prototype.setFormats=function(d){var a=this;this.formats=[];d.forEach(function(b){a.formats.push(parseInt(b,10))})};h.prototype.getParams=function(){return this.params};h.prototype.setParams=function(d){this.params=new Map(d)};
m.exports=h},function(m,r,k){m=k(37);m=k.n(m);var f=k(0).a.module("PeerConnectionFsm");k=["initial","failed","stable"];k=m.a.factory({init:"initial",transitions:[{name:"create-offer",from:k,to:"stable"},{name:"add-ice-candidate",from:k,to:function(){return this.state}},{name:"process-answer",from:k,to:"stable"},{name:"process-offer",from:k,to:"stable"},{name:"negotiate-max-bw",from:k,to:"stable"},{name:"add-stream",from:k,to:function(){return this.state}},{name:"remove-stream",from:k,to:function(){return this.state}},
{name:"close",from:k,to:"closed"},{name:"error",from:"*",to:"failed"}],data:function(f){return{baseStackCalls:f,history:[]}},methods:{getHistory:function(){return this.history},onBeforeClose:function(h){f.debug("mesage: onBeforeClose, from: "+h.from+", to: "+h.to);return this.baseStackCalls.protectedClose()},onBeforeAddIceCandidate:function(h,d){f.debug("message: onBeforeAddIceCandidate, from: "+h.from+", to: "+h.to);return this.baseStackCalls.protectedAddIceCandidate(d)},onBeforeAddStream:function(h,
d){f.debug("message: onBeforeAddStream, from: "+h.from+", to: "+h.to);return this.baseStackCalls.protectedAddStream(d)},onBeforeRemoveStream:function(h,d){f.debug("message: onBeforeRemoveStream, from: "+h.from+", to: "+h.to);return this.baseStackCalls.protectedRemoveStream(d)},onBeforeCreateOffer:function(h,d){f.debug("message: onBeforeCreateOffer, from: "+h.from+", to: "+h.to);return this.baseStackCalls.protectedCreateOffer(d)},onBeforeProcessOffer:function(h,d){f.debug("message: onBeforeProcessOffer, from: "+
h.from+", to: "+h.to);return this.baseStackCalls.protectedProcessOffer(d)},onBeforeProcessAnswer:function(h,d){f.debug("message: onBeforeProcessAnswer, from: "+h.from+", to: "+h.to);return this.baseStackCalls.protectedProcessAnswer(d)},onBeforeNegotiateMaxBW:function(h,d,a){f.debug("message: onBeforeNegotiateMaxBW, from: "+h.from+", to: "+h.to);return this.baseStackCalls.protectedNegotiateMaxBW(d,a)},onStable:function(h){f.debug("message: reached STABLE, from: "+h.from+", to: "+h.to)},onClosed:function(h){f.debug("message: reached close, from: "+
h.from+", to: "+h.to)},onTransition:function(h){f.info("message: onTransition, transition: "+h.transition+", from: "+h.from+", to: "+h.to);this.history.push({from:h.from,to:h.to,transition:h.transition});200<this.history.length&&this.history.shift()},onError:function(h,d){f.warning("message: Error Transition Failed, message: "+d+", from: "+h.from+", to: "+h.to+", printing history");this.history.forEach(function(a){f.warning("message: Error Transition Failed continuation, item: "+JSON.stringify(a))})},
onInvalidTransition:function(h,d,a){"closed"===d?f.debug("message:Trying to transition a closed state, transition: "+h+", from: "+d+", to: "+a):f.warning("message: Error Invalid transition, transition: "+h+", from: "+d+", to: "+a)},onPendingTransition:function(h,d,a){f.warning("message: Error Pending transition, transition: "+h+", from: "+d+", to: "+a+", lastTransition: "+(0<this.history.lenth?this.history[this.history.length-1].transition:"none"))}}});r.a=k},function(m,r,k){(function(f,h){m.exports=
h()})(this,function(){return function(f){function h(a){if(d[a])return d[a].exports;var b=d[a]={i:a,l:!1,exports:{}};f[a].call(b.exports,b,b.exports,h);b.l=!0;return b.exports}var d={};h.m=f;h.c=d;h.i=function(a){return a};h.d=function(a,b,d){h.o(a,b)||Object.defineProperty(a,b,{configurable:!1,enumerable:!0,get:d})};h.n=function(a){var b=a&&a.__esModule?function(){return a["default"]}:function(){return a};h.d(b,"a",b);return b};h.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)};h.p=
"";return h(h.s=5)}([function(f,h,d){f.exports=function(a,b){var d,e;for(d=1;d<arguments.length;d++){var f=arguments[d];for(e in f)f.hasOwnProperty(e)&&(a[e]=f[e])}return a}},function(f,h,d){var a=d(0);f.exports={build:function(b,d){var e,f=d.plugins;d=0;for(e=f.length;d<e;d++){var l=f[d];l.methods&&a(b,l.methods);l.properties&&Object.defineProperties(b,l.properties)}},hook:function(a,d,e){var b,l,g=a.config.plugins;a=[a.context];e&&(a=a.concat(e));e=0;for(b=g.length;e<b;e++){var c=g[e];(l=g[e][d])&&
l.apply(c,a)}}}},function(f,h,d){function a(a){if(0===a.length)return a;var b=a.split(/[_-]/);if(1===b.length&&b[0][0].toLowerCase()===b[0][0])return a;var e=b[0].toLowerCase();for(a=1;a<b.length;a++)e=e+b[a].charAt(0).toUpperCase()+b[a].substring(1).toLowerCase();return e}a.prepended=function(b,d){d=a(d);return b+d[0].toUpperCase()+d.substring(1)};f.exports=a},function(f,h,d){function a(a,b){this.options=a=a||{};this.defaults=b.defaults;this.states=[];this.transitions=[];this.map={};this.lifecycle=
this.configureLifecycle();this.init=this.configureInitTransition(a.init);this.data=this.configureData(a.data);this.methods=this.configureMethods(a.methods);this.map[this.defaults.wildcard]={};this.configureTransitions(a.transitions||[]);this.plugins=this.configurePlugins(a.plugins,b.plugin)}var b=d(0),n=d(2);b(a.prototype,{addState:function(a){this.map[a]||(this.states.push(a),this.addStateLifecycleNames(a),this.map[a]={})},addStateLifecycleNames:function(a){this.lifecycle.onEnter[a]=n.prepended("onEnter",
a);this.lifecycle.onLeave[a]=n.prepended("onLeave",a);this.lifecycle.on[a]=n.prepended("on",a)},addTransition:function(a){0>this.transitions.indexOf(a)&&(this.transitions.push(a),this.addTransitionLifecycleNames(a))},addTransitionLifecycleNames:function(a){this.lifecycle.onBefore[a]=n.prepended("onBefore",a);this.lifecycle.onAfter[a]=n.prepended("onAfter",a);this.lifecycle.on[a]=n.prepended("on",a)},mapTransition:function(a){var b=a.name,e=a.from,g=a.to;this.addState(e);"function"!==typeof g&&this.addState(g);
this.addTransition(b);return this.map[e][b]=a},configureLifecycle:function(){return{onBefore:{transition:"onBeforeTransition"},onAfter:{transition:"onAfterTransition"},onEnter:{state:"onEnterState"},onLeave:{state:"onLeaveState"},on:{transition:"onTransition"}}},configureInitTransition:function(a){if("string"===typeof a)return this.mapTransition(b({},this.defaults.init,{to:a,active:!0}));if("object"===typeof a)return this.mapTransition(b({},this.defaults.init,a,{active:!0}));this.addState(this.defaults.init.from);
return this.defaults.init},configureData:function(a){return"function"===typeof a?a:"object"===typeof a?function(){return a}:function(){return{}}},configureMethods:function(a){return a||{}},configurePlugins:function(a,b){a=a||[];var e;b=0;for(e=a.length;b<e;b++){var g=a[b];"function"===typeof g&&(a[b]=g=g());g.configure&&g.configure(this)}return a},configureTransitions:function(a){var b,e,g=this.defaults.wildcard;for(e=0;e<a.length;e++){var c=a[e];var d=Array.isArray(c.from)?c.from:[c.from||g];var f=
c.to||g;for(b=0;b<d.length;b++)this.mapTransition({name:c.name,from:d[b],to:f})}},transitionFor:function(a,b){var e=this.defaults.wildcard;return this.map[a][b]||this.map[e][b]},transitionsFor:function(a){var b=this.defaults.wildcard;return Object.keys(this.map[a]).concat(Object.keys(this.map[b]))},allStates:function(){return this.states},allTransitions:function(){return this.transitions}});f.exports=a},function(f,h,d){function a(a,b){this.context=a;this.config=b;this.state=b.init.from;this.observers=
[a]}var b=d(0),n=d(6),e=d(1),p=[null,[]];b(a.prototype,{init:function(a){b(this.context,this.config.data.apply(this.context,a));e.hook(this,"init");if(this.config.init.active)return this.fire(this.config.init.name,[])},is:function(a){return Array.isArray(a)?0<=a.indexOf(this.state):this.state===a},isPending:function(){return this.pending},can:function(a){return!this.isPending()&&!!this.seek(a)},cannot:function(a){return!this.can(a)},allStates:function(){return this.config.allStates()},allTransitions:function(){return this.config.allTransitions()},
transitions:function(){return this.config.transitionsFor(this.state)},seek:function(a,b){var c=this.config.defaults.wildcard;a=(a=this.config.transitionFor(this.state,a))&&a.to;return"function"===typeof a?a.apply(this.context,b):a===c?this.state:a},fire:function(a,b){return this.transit(a,this.state,this.seek(a,b),b)},transit:function(a,b,c,e){var g=this.config.lifecycle,q=this.config.options.observeUnchangedState||b!==c;if(!c)return this.context.onInvalidTransition(a,b,c);if(this.isPending())return this.context.onPendingTransition(a,
b,c);this.config.addState(c);this.beginTransit();e.unshift({transition:a,from:b,to:c,fsm:this.context});return this.observeEvents([this.observersForEvent(g.onBefore.transition),this.observersForEvent(g.onBefore[a]),q?this.observersForEvent(g.onLeave.state):p,q?this.observersForEvent(g.onLeave[b]):p,this.observersForEvent(g.on.transition),q?["doTransit",[this]]:p,q?this.observersForEvent(g.onEnter.state):p,q?this.observersForEvent(g.onEnter[c]):p,q?this.observersForEvent(g.on[c]):p,this.observersForEvent(g.onAfter.transition),
this.observersForEvent(g.onAfter[a]),this.observersForEvent(g.on[a])],e)},beginTransit:function(){this.pending=!0},endTransit:function(a){this.pending=!1;return a},failTransit:function(a){this.pending=!1;throw a;},doTransit:function(a){this.state=a.to},observe:function(a){if(2===a.length){var b={};b[a[0]]=a[1];this.observers.push(b)}else this.observers.push(a[0])},observersForEvent:function(a){for(var b=0,c=this.observers.length,e,d=[];b<c;b++)e=this.observers[b],e[a]&&d.push(e);return[a,d,!0]},observeEvents:function(a,
b,c,d){if(0===a.length)return this.endTransit(void 0===d?!0:d);var g=a[0][0],q=a[0][1],l=a[0][2];(b[0].event=g)&&l&&g!==c&&e.hook(this,"lifecycle",b);if(0===q.length)return a.shift(),this.observeEvents(a,b,g,d);c=q.shift();return(c=c[g].apply(c,b))&&"function"===typeof c.then?c.then(this.observeEvents.bind(this,a,b,g)).catch(this.failTransit.bind(this)):!1===c?this.endTransit(!1):this.observeEvents(a,b,g,c)},onInvalidTransition:function(a,b,c){throw new n("transition is invalid in current state",
a,b,c,this.state);},onPendingTransition:function(a,b,c){throw new n("transition is invalid while previous transition is still in progress",a,b,c,this.state);}});f.exports=a},function(f,h,d){function a(a){return b(this||{},a)}function b(b,c){c=new g(c,a);n(b,c);b._fsm();return b}function n(a,b){if("object"!==typeof a||Array.isArray(a))throw Error("StateMachine can only be applied to objects");l.build(a,b);Object.defineProperties(a,t);e(a,u);e(a,b.methods);b.allTransitions().forEach(function(b){a[p(b)]=
function(){return this._fsm.fire(b,[].slice.call(arguments))}});a._fsm=function(){this._fsm=new c(this,b);this._fsm.init(arguments)}}var e=d(0),p=d(2),l=d(1),g=d(3),c=d(4),u={is:function(a){return this._fsm.is(a)},can:function(a){return this._fsm.can(a)},cannot:function(a){return this._fsm.cannot(a)},observe:function(){return this._fsm.observe(arguments)},transitions:function(){return this._fsm.transitions()},allTransitions:function(){return this._fsm.allTransitions()},allStates:function(){return this._fsm.allStates()},
onInvalidTransition:function(a,b,c){return this._fsm.onInvalidTransition(a,b,c)},onPendingTransition:function(a,b,c){return this._fsm.onPendingTransition(a,b,c)}},t={state:{configurable:!1,enumerable:!0,get:function(){return this._fsm.state},set:function(a){throw Error("use transitions to change state");}}};a.version="3.0.1";a.factory=function(b,c){if("function"===typeof b){var e=b;b=c||{}}else e=function(){this._fsm.apply(this,arguments)},b=b||{};b=new g(b,a);n(e.prototype,b);e.prototype._fsm.config=
b;return e};a.apply=b;a.defaults={wildcard:"*",init:{name:"init",from:"none"}};f.exports=a},function(f,h,d){f.exports=function(a,b,d,e,f){this.message=a;this.transition=b;this.from=d;this.to=e;this.current=f}}])})},function(m,r,k){m=function(f,h){this._enqueuing=!1;this._queuedArgs=[];this.maxEnqueueingTime=void 0===f?3E4:f;this.onEnqueueingTimeout=void 0===h?function(){}:h};m.prototype.protectFunction=function(f){return this._protectedFunction.bind(this,f)};m.prototype.isEnqueueing=function(){return this._enqueuing};
m.prototype.startEnqueuing=function(){var f=this;this._enqueuing=!0;clearTimeout(this._enqueueingTimeout);this._enqueueingTimeout=setTimeout(function(){if(f.onEnqueueingTimeout)f.onEnqueueingTimeout()},this.maxEnqueueingTime)};m.prototype.stopEnqueuing=function(){this._enqueuing=!1;clearTimeout(this._enqueueingTimeout)};m.prototype.nextInQueue=function(){if(0<this._queuedArgs.length){var f=this._queuedArgs.shift();f.protectedFunction.apply(null,[].concat($jscomp.arrayFromIterable(f.args)))}};m.prototype.dequeueAll=
function(){var f=this._queuedArgs;this._queuedArgs=[];f.forEach(function(f){f.protectedFunction.apply(null,[].concat($jscomp.arrayFromIterable(f.args)))})};m.prototype._protectedFunction=function(f,h){for(var d=[],a=1;a<arguments.length;++a)d[a-1]=arguments[a];this.isEnqueueing()?this._enqueue.apply(this,[].concat([f],$jscomp.arrayFromIterable(d))):f.apply(null,[].concat($jscomp.arrayFromIterable(d)))};m.prototype._enqueue=function(f,h){for(var d=[],a=1;a<arguments.length;++a)d[a-1]=arguments[a];
this._queuedArgs.push({protectedFunction:f,args:d})};r.a=m},function(m,r,k){m=k(0);var f=k(9),h=m.a.module("FirefoxStack");r.a=function(d){h.debug("message: Starting Firefox stack");var a=Object(f.a)(d),b=[{rid:"low",scaleResolutionDownBy:3},{rid:"med",scaleResolutionDownBy:2},{rid:"high"}],n=function(e){var d=a.simulcast.numSpatialLayers||2,g=b.length,d=d<g?d:g,c=e.getParameters()||{};c.encodings=[];for(var f=g-1;f>=g-d;--f)c.encodings.push(b[f]);return e.setParameters(c)},e=function(){if(!a.simulcast)return[];
var b=[];a.peerConnection.getSenders().forEach(function(a){"video"===a.track.kind&&b.push(n(a))});return b};a.enableSimulcast=function(a){return a};a.prepareCreateOffer=function(a){var b=[];!0!==(void 0===a?!1:a)&&(b=e());return Promise.all(b)};return a}},function(m,r,k){var f=k(0).a.module("FcStack");r.a=function(h){var d={pcConfig:{},peerConnection:{},desc:{},signalCallback:void 0,close:function(){f.debug("message: Close FcStack")},createOffer:function(){f.debug("message: CreateOffer")},addStream:function(a){f.debug("message: addStream, "+
a.toLog())},processSignalingMessage:function(a){f.debug("message: processSignaling, message: "+a);void 0!==d.signalCallback&&d.signalCallback(a)},sendSignalingMessage:function(a){f.debug("message: Sending signaling Message, message: "+a);h.callback(a)},setSignalingCallback:function(a){a=void 0===a?function(){}:a;f.debug("message: Setting signalling callback");d.signalCallback=a}};return d}},function(m,r){m.exports=function(k){if(!k.webpackPolyfill){var f=Object.create(k);f.children||(f.children=[]);
Object.defineProperty(f,"loaded",{enumerable:!0,get:function(){return f.l}});Object.defineProperty(f,"id",{enumerable:!0,get:function(){return f.i}});Object.defineProperty(f,"exports",{enumerable:!0});f.webpackPolyfill=1}return f}},function(m,r,k){k.d(r,"a",function(){return b});m=k(43);var f=k.n(m);m=k(0);var h=k(1),d=m.a.module("Socket"),a=function(a,b){a=Object(h.d)({type:a});a.args=b.args;return a},b=function(b){var e=Object(h.b)(),n=function(){},l=[];$jscomp.initSymbol();e.CONNECTED=Symbol("connected");
$jscomp.initSymbol();e.RECONNECTING=Symbol("reconnecting");$jscomp.initSymbol();e.DISCONNECTED=Symbol("disconnected");e.state=e.DISCONNECTED;e.IO=void 0===b?f.a:b;var g,c=function(b,c){for(var g=[],d=1;d<arguments.length;++d)g[d-1]=arguments[d];e.emit(a(b,{args:g}))},u=function(){e.state===e.CONNECTED&&l.forEach(function(a){e.sendMessage.apply(e,[].concat($jscomp.arrayFromIterable(a)))})};e.connect=function(a,b,f,l){f=void 0===f?n:f;l=void 0===l?n:l;g=e.IO.connect((a.secure?"wss://":"ws://")+a.host,
{reconnection:!0,reconnectionAttempts:3,secure:a.secure,forceNew:!0,transports:["websocket"],rejectUnauthorized:!1});var q=1E3,h=g.io.engine.transport.ws.onclose;g.io.engine.transport.ws.onclose=function(a){d.info("message: WebSocket closed, code: "+a.code+", id: "+e.id);q=a.code;h(a)};e.socket=g;g.on("onAddStream",c.bind(e,"onAddStream"));g.on("stream_message_erizo",c.bind(e,"stream_message_erizo"));g.on("stream_message_p2p",c.bind(e,"stream_message_p2p"));g.on("connection_message_erizo",c.bind(e,
"connection_message_erizo"));g.on("publish_me",c.bind(e,"publish_me"));g.on("unpublish_me",c.bind(e,"unpublish_me"));g.on("onBandwidthAlert",c.bind(e,"onBandwidthAlert"));g.on("onDataStream",c.bind(e,"onDataStream"));g.on("onUpdateAttributeStream",c.bind(e,"onUpdateAttributeStream"));g.on("onRemoveStream",c.bind(e,"onRemoveStream"));g.on("onAutomaticStreamsSubscription",c.bind(e,"onAutomaticStreamsSubscription"));g.on("disconnect",function(a){d.debug("message: disconnect, id: "+e.id+", reason: "+
a);1E3!==q?(c("reconnecting",a),e.state=e.RECONNECTING):(c("disconnect",a),g.close())});g.on("connection_failed",function(a){d.warning("message: connection failed, id: "+e.id);c("connection_failed",a)});g.on("error",function(a){d.warning("message: socket error, id: "+e.id+", error: "+a.message);c("error")});g.on("connect_error",function(a){d.warning("message: connect error, id: "+e.id+", error: "+a.message)});g.on("connect_timeout",function(a){d.warning("message: connect timeout, id: "+e.id+", error: "+
a.message)});g.on("reconnecting",function(a){d.info("message: reconnecting, id: "+e.id+", attempt: "+a)});g.on("reconnect",function(a){d.info("message: reconnected, id: "+e.id+", attempt: "+a);e.state=e.CONNECTED;g.emit("reconnected",e.id);c("reconnected",e.id);u()});g.on("reconnect_attempt",function(a){d.debug("message: reconnect attempt, id: "+e.id+", attempt: "+a)});g.on("reconnect_error",function(a){d.info("message: error reconnecting, id: "+e.id+", error: "+a.message)});g.on("reconnect_failed",
function(){d.info("message: reconnect failed, id: "+e.id);e.state=e.DISCONNECTED;c("disconnect","reconnect failed")});b.token=a;e.sendMessage("token",b,function(a){e.state=e.CONNECTED;e.id=a.clientId;f(a)},l)};e.disconnect=function(){e.state=e.DISCONNECTED;g.disconnect()};e.sendMessage=function(a,b,c,f){c=void 0===c?n:c;f=void 0===f?n:f;e.state===e.DISCONNECTED&&"token"!==a?d.debug("message: Trying to send a message over a disconnected Socket, id: "+e.id+", type: "+a):e.state===e.RECONNECTING?l.push([a,
b,c,f]):g.emit(a,b,function(a,b){"success"===a?c(b):"error"===a?f(b):c(a,b)})};e.sendSDP=function(a,b,c,f){f=void 0===f?n:f;e.state===e.DISCONNECTED?d.warning("message: Trying to send a message over a disconnected Socket, id: "+e.id):g.emit(a,b,c,function(a){for(var b=[],c=0;c<arguments.length;++c)b[c-0]=arguments[c];f.apply(null,[].concat($jscomp.arrayFromIterable(b)))})};return e}},function(m,r,k){!function(f,h){m.exports=h()}(this,function(){return function(f){function h(a){if(d[a])return d[a].exports;
var b=d[a]={exports:{},id:a,loaded:!1};return f[a].call(b.exports,b,b.exports,h),b.loaded=!0,b.exports}var d={};return h.m=f,h.c=d,h.p="",h(0)}([function(f,h,d){function a(a,e){"object"===("undefined"==typeof a?"undefined":b(a))&&(e=a,a=void 0);e=e||{};var c;a=n(a);var d=a.source,f=a.id,h=a.path,h=g[f]&&h in g[f].nsps;return e.forceNew||e["force new connection"]||!1===e.multiplex||h?(l("ignoring socket cache for %s",d),c=p(d,e)):(g[f]||(l("new io instance for %s",d),g[f]=p(d,e)),c=g[f]),a.query&&
!e.query&&(e.query=a.query),c.socket(a.path,e)}$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbolIterator();var b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbol();return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},n=d(1),e=d(7),p=d(13),l=d(3)("socket.io-client");f.exports=h=a;var g=h.managers={};h.protocol=e.protocol;h.connect=
a;h.Manager=d(13);h.Socket=d(39)},function(f,h,d){(function(a){var b=d(2),h=d(3)("socket.io-client:url");f.exports=function(e,d){var f=e;d=d||a.location;null==e&&(e=d.protocol+"//"+d.host);"string"==typeof e&&("/"===e.charAt(0)&&(e="/"===e.charAt(1)?d.protocol+e:d.host+e),/^(https?|wss?):\/\//.test(e)||(h("protocol-less url %s",e),e="undefined"!=typeof d?d.protocol+"//"+e:"https://"+e),h("parse %s",e),f=b(e));f.port||(/^(http|ws)$/.test(f.protocol)?f.port="80":/^(http|ws)s$/.test(f.protocol)&&(f.port=
"443"));f.path=f.path||"/";e=-1!==f.host.indexOf(":")?"["+f.host+"]":f.host;return f.id=f.protocol+"://"+e+":"+f.port,f.href=f.protocol+"://"+e+(d&&d.port===f.port?"":":"+f.port),f}}).call(h,function(){return this}())},function(f,h){var d=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,a="source protocol authority userInfo user password host port relative path directory file query anchor".split(" ");
f.exports=function(b){var f=b,e=b.indexOf("["),h=b.indexOf("]");-1!=e&&-1!=h&&(b=b.substring(0,e)+b.substring(e,h).replace(/:/g,";")+b.substring(h,b.length));b=d.exec(b||"");for(var l={},g=14;g--;)l[a[g]]=b[g]||"";return-1!=e&&-1!=h&&(l.source=f,l.host=l.host.substring(1,l.host.length-1).replace(/;/g,":"),l.authority=l.authority.replace("[","").replace("]","").replace(/;/g,":"),l.ipv6uri=!0),l}},function(f,h,d){(function(a){function b(){try{var b=h.storage.debug}catch(l){}return!b&&"undefined"!=typeof a&&
"env"in a&&(b=a.env.DEBUG),b}h=f.exports=d(5);h.log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)};h.formatArgs=function(a){var b=this.useColors;if(a[0]=(b?"%c":"")+this.namespace+(b?" %c":" ")+a[0]+(b?"%c ":" ")+"+"+h.humanize(this.diff),b){b="color: "+this.color;a.splice(1,0,b,"color: inherit");var g=0,c=0;a[0].replace(/%[a-zA-Z%]/g,function(a){"%%"!==a&&(g++,"%c"===a&&(c=g))});a.splice(c,0,b)}};h.save=function(a){try{null==
a?h.storage.removeItem("debug"):h.storage.debug=a}catch(l){}};h.load=b;h.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type)||"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&
31<=parseInt(RegExp.$1,10)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)};var n=h;if("undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage)var e=chrome.storage.local;else a:{try{e=window.localStorage;break a}catch(p){}e=void 0}n.storage=e;h.colors="lightseagreen forestgreen goldenrod dodgerblue darkorchid crimson".split(" ");h.formatters.j=function(a){try{return JSON.stringify(a)}catch(l){return"[UnexpectedJSONParseError]: "+
l.message}};h.enable(b())}).call(h,d(4))},function(f,h){function d(){throw Error("setTimeout has not been defined");}function a(){throw Error("clearTimeout has not been defined");}function b(a){if(c===setTimeout)return setTimeout(a,0);if((c===d||!c)&&setTimeout)return c=setTimeout,setTimeout(a,0);try{return c(a,0)}catch(v){try{return c.call(null,a,0)}catch(z){return c.call(this,a,0)}}}function n(b){if(u===clearTimeout)return clearTimeout(b);if((u===a||!u)&&clearTimeout)return u=clearTimeout,clearTimeout(b);
try{return u(b)}catch(v){try{return u.call(null,b)}catch(z){return u.call(this,b)}}}function e(){x&&k&&(x=!1,k.length?q=k.concat(q):y=-1,q.length&&p())}function p(){if(!x){var a=b(e);x=!0;for(var c=q.length;c;){k=q;for(q=[];++y<c;)k&&k[y].run();y=-1;c=q.length}k=null;x=!1;n(a)}}function l(a,b){this.fun=a;this.array=b}function g(){}f=f.exports={};try{var c="function"==typeof setTimeout?setTimeout:d}catch(w){c=d}try{var u="function"==typeof clearTimeout?clearTimeout:a}catch(w){u=a}!0;var k,q=[],x=!1,
y=-1;f.nextTick=function(a){var c=Array(arguments.length-1);if(1<arguments.length)for(var g=1;g<arguments.length;g++)c[g-1]=arguments[g];q.push(new l(a,c));1!==q.length||x||b(p)};l.prototype.run=function(){this.fun.apply(null,this.array)};f.title="browser";f.browser=!0;f.env={};f.argv=[];f.version="";f.versions={};f.on=g;f.addListener=g;f.once=g;f.off=g;f.removeListener=g;f.removeAllListeners=g;f.emit=g;f.prependListener=g;f.prependOnceListener=g;f.listeners=function(a){return[]};f.binding=function(a){throw Error("process.binding is not supported");
};f.cwd=function(){return"/"};f.chdir=function(a){throw Error("process.chdir is not supported");};f.umask=function(){return 0}},function(f,h,d){function a(a){var b,e=0;for(b in a)e=(e<<5)-e+a.charCodeAt(b),e|=0;return h.colors[Math.abs(e)%h.colors.length]}function b(b){function e(){if(e.enabled){var a=+new Date;e.diff=a-(n||a);e.prev=n;n=e.curr=a;for(var b=Array(arguments.length),a=0;a<b.length;a++)b[a]=arguments[a];b[0]=h.coerce(b[0]);"string"!=typeof b[0]&&b.unshift("%O");var c=0;b[0]=b[0].replace(/%([a-zA-Z%])/g,
function(a,g){if("%%"===a)return a;c++;g=h.formatters[g];"function"==typeof g&&(a=g.call(e,b[c]),b.splice(c,1),c--);return a});h.formatArgs.call(e,b);(e.log||h.log||console.log.bind(console)).apply(e,b)}}return e.namespace=b,e.enabled=h.enabled(b),e.useColors=h.useColors(),e.color=a(b),"function"==typeof h.init&&h.init(e),e}h=f.exports=b.debug=b["default"]=b;h.coerce=function(a){return a instanceof Error?a.stack||a.message:a};h.disable=function(){h.enable("")};h.enable=function(a){h.save(a);h.names=
[];h.skips=[];for(var b=("string"==typeof a?a:"").split(/[\s,]+/),e=b.length,g=0;g<e;g++)b[g]&&(a=b[g].replace(/\*/g,".*?"),"-"===a[0]?h.skips.push(new RegExp("^"+a.substr(1)+"$")):h.names.push(new RegExp("^"+a+"$")))};h.enabled=function(a){var b;var e=0;for(b=h.skips.length;e<b;e++)if(h.skips[e].test(a))return!1;e=0;for(b=h.names.length;e<b;e++)if(h.names[e].test(a))return!0;return!1};h.humanize=d(6);h.names=[];h.skips=[];h.formatters={};var n},function(f,h){function d(a){if(a=String(a),!(100<a.length))if(a=
/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(a)){var c=parseFloat(a[1]);switch((a[2]||"ms").toLowerCase()){case "years":case "year":case "yrs":case "yr":case "y":return c*l;case "days":case "day":case "d":return c*p;case "hours":case "hour":case "hrs":case "hr":case "h":return c*e;case "minutes":case "minute":case "mins":case "min":case "m":return c*n;case "seconds":case "second":case "secs":case "sec":case "s":return c*
b;case "milliseconds":case "millisecond":case "msecs":case "msec":case "ms":return c}}}function a(a,b,e){if(!(a<b))return a<1.5*b?Math.floor(a/b)+" "+e:Math.ceil(a/b)+" "+e+"s"}var b=1E3,n=60*b,e=60*n,p=24*e,l=365.25*p;f.exports=function(g,c){c=c||{};var f=typeof g;if("string"===f&&0<g.length)return d(g);if("number"===f&&!1===isNaN(g))return c["long"]?a(g,p,"day")||a(g,e,"hour")||a(g,n,"minute")||a(g,b,"second")||g+" ms":g>=p?Math.round(g/p)+"d":g>=e?Math.round(g/e)+"h":g>=n?Math.round(g/n)+"m":g>=
b?Math.round(g/b)+"s":g+"ms";throw Error("val is not a non-empty string or a valid number. val\x3d"+JSON.stringify(g));}},function(f,h,d){function a(){}function b(a){var b=""+a.type;return h.BINARY_EVENT!==a.type&&h.BINARY_ACK!==a.type||(b+=a.attachments+"-"),a.nsp&&"/"!==a.nsp&&(b+=a.nsp+","),null!=a.id&&(b+=a.id),null!=a.data&&(b+=JSON.stringify(a.data)),g("encoded %j as %s",a,b),b}function n(a,c){k.removeBlobs(a,function(a){var g=k.deconstructPacket(a);a=b(g.packet);g=g.buffers;g.unshift(a);c(g)})}
function e(){this.reconstructor=null}function p(a){this.reconPack=a;this.buffers=[]}function l(){return{type:h.ERROR,data:"parser error"}}var g=d(3)("socket.io-parser");f=d(8);var c=d(9),k=d(11),t=d(12);h.protocol=4;h.types="CONNECT DISCONNECT EVENT ACK ERROR BINARY_EVENT BINARY_ACK".split(" ");h.CONNECT=0;h.DISCONNECT=1;h.EVENT=2;h.ACK=3;h.ERROR=4;h.BINARY_EVENT=5;h.BINARY_ACK=6;h.Encoder=a;h.Decoder=e;a.prototype.encode=function(a,e){(a.type!==h.EVENT&&a.type!==h.ACK||!c(a.data)||(a.type=a.type===
h.EVENT?h.BINARY_EVENT:h.BINARY_ACK),g("encoding packet %j",a),h.BINARY_EVENT===a.type||h.BINARY_ACK===a.type)?n(a,e):(a=b(a),e([a]))};f(e.prototype);e.prototype.add=function(a){if("string"==typeof a){var b,c=0,e={type:Number(a.charAt(0))};if(null==h.types[e.type])a=l();else{if(h.BINARY_EVENT===e.type||h.BINARY_ACK===e.type){for(b="";"-"!==a.charAt(++c)&&(b+=a.charAt(c),c!=a.length););if(b!=Number(b)||"-"!==a.charAt(c))throw Error("Illegal attachments");e.attachments=Number(b)}if("/"===a.charAt(c+
1))for(e.nsp="";++c;){b=a.charAt(c);if(","===b)break;if(e.nsp+=b,c===a.length)break}else e.nsp="/";b=a.charAt(c+1);if(""!==b&&Number(b)==b){for(e.id="";++c;){b=a.charAt(c);if(null==b||Number(b)!=b){--c;break}if(e.id+=a.charAt(c),c===a.length)break}e.id=Number(e.id)}if(a.charAt(++c)){b:{c=a.substr(c);try{e.data=JSON.parse(c)}catch(v){c=l();break b}c=e}e=c}a=(g("decoded %s as %j",a,e),e)}h.BINARY_EVENT===a.type||h.BINARY_ACK===a.type?(this.reconstructor=new p(a),0===this.reconstructor.reconPack.attachments&&
this.emit("decoded",a)):this.emit("decoded",a)}else{if(!t(a)&&!a.base64)throw Error("Unknown type: "+a);if(!this.reconstructor)throw Error("got binary data when not reconstructing a packet");(a=this.reconstructor.takeBinaryData(a))&&(this.reconstructor=null,this.emit("decoded",a))}};e.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()};p.prototype.takeBinaryData=function(a){return(this.buffers.push(a),this.buffers.length===this.reconPack.attachments)?(a=k.reconstructPacket(this.reconPack,
this.buffers),this.finishedReconstruction(),a):null};p.prototype.finishedReconstruction=function(){this.reconPack=null;this.buffers=[]}},function(f,h,d){function a(b){if(b){for(var d in a.prototype)b[d]=a.prototype[d];return b}}f.exports=a;a.prototype.on=a.prototype.addEventListener=function(a,d){return this._callbacks=this._callbacks||{},(this._callbacks["$"+a]=this._callbacks["$"+a]||[]).push(d),this};a.prototype.once=function(a,d){function b(){this.off(a,b);d.apply(this,arguments)}return b.fn=
d,this.on(a,b),this};a.prototype.off=a.prototype.removeListener=a.prototype.removeAllListeners=a.prototype.removeEventListener=function(a,d){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var b=this._callbacks["$"+a];if(!b)return this;if(1==arguments.length)return delete this._callbacks["$"+a],this;for(var f,h=0;h<b.length;h++)if(f=b[h],f===d||f.fn===d){b.splice(h,1);break}return this};a.prototype.emit=function(a){this._callbacks=this._callbacks||{};var b=
[].slice.call(arguments,1),e=this._callbacks["$"+a];if(e)for(var e=e.slice(0),d=0,f=e.length;d<f;++d)e[d].apply(this,b);return this};a.prototype.listeners=function(a){return this._callbacks=this._callbacks||{},this._callbacks["$"+a]||[]};a.prototype.hasListeners=function(a){return!!this.listeners(a).length}},function(f,h,d){(function(a){function b(g){if(!g||"object"!=typeof g)return!1;if(h(g)){for(var c=0,e=g.length;c<e;c++)if(b(g[c]))return!0;return!1}if("function"==typeof a.Buffer&&a.Buffer.isBuffer&&
a.Buffer.isBuffer(g)||"function"==typeof a.ArrayBuffer&&g instanceof ArrayBuffer||p&&g instanceof Blob||l&&g instanceof File)return!0;if(g.toJSON&&"function"==typeof g.toJSON&&1===arguments.length)return b(g.toJSON(),!0);for(c in g)if(Object.prototype.hasOwnProperty.call(g,c)&&b(g[c]))return!0;return!1}var h=d(10),e=Object.prototype.toString,p="function"==typeof a.Blob||"[object BlobConstructor]"===e.call(a.Blob),l="function"==typeof a.File||"[object FileConstructor]"===e.call(a.File);f.exports=b}).call(h,
function(){return this}())},function(f,h){var d={}.toString;f.exports=Array.isArray||function(a){return"[object Array]"==d.call(a)}},function(f,h,d){(function(a){function b(a,c){if(!a)return a;if(p(a)){var g={_placeholder:!0,num:c.length};return c.push(a),g}if(e(a)){g=Array(a.length);for(var d=0;d<a.length;d++)g[d]=b(a[d],c);return g}if("object"==typeof a&&!(a instanceof Date)){g={};for(d in a)g[d]=b(a[d],c);return g}return a}function f(a,b){if(!a)return a;if(a&&a._placeholder)return b[a.num];if(e(a))for(var c=
0;c<a.length;c++)a[c]=f(a[c],b);else if("object"==typeof a)for(c in a)a[c]=f(a[c],b);return a}var e=d(10),p=d(12),l=Object.prototype.toString,g="function"==typeof a.Blob||"[object BlobConstructor]"===l.call(a.Blob),c="function"==typeof a.File||"[object FileConstructor]"===l.call(a.File);h.deconstructPacket=function(a){var c=[];return a.data=b(a.data,c),a.attachments=c.length,{packet:a,buffers:c}};h.reconstructPacket=function(a,b){return a.data=f(a.data,b),a.attachments=void 0,a};h.removeBlobs=function(a,
b){function d(a,q,l){if(!a)return a;if(g&&a instanceof Blob||c&&a instanceof File){f++;var n=new FileReader;n.onload=function(){l?l[q]=this.result:h=this.result;--f||b(h)};n.readAsArrayBuffer(a)}else if(e(a))for(n=0;n<a.length;n++)d(a[n],n,a);else if("object"==typeof a&&!p(a))for(n in a)d(a[n],n,a)}var f=0,h=a;d(h);f||b(h)}}).call(h,function(){return this}())},function(f,h){(function(d){f.exports=function(a){return d.Buffer&&d.Buffer.isBuffer(a)||d.ArrayBuffer&&a instanceof ArrayBuffer}}).call(h,
function(){return this}())},function(f,h,d){function a(c,g){if(!(this instanceof a))return new a(c,g);c&&"object"===("undefined"==typeof c?"undefined":b(c))&&(g=c,c=void 0);g=g||{};g.path=g.path||"/socket.io";this.nsps={};this.subs=[];this.opts=g;this.reconnection(!1!==g.reconnection);this.reconnectionAttempts(g.reconnectionAttempts||1/0);this.reconnectionDelay(g.reconnectionDelay||1E3);this.reconnectionDelayMax(g.reconnectionDelayMax||5E3);this.randomizationFactor(g.randomizationFactor||.5);this.backoff=
new t({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()});this.timeout(null==g.timeout?2E4:g.timeout);this.readyState="closed";this.uri=c;this.connecting=[];this.lastPing=null;this.encoding=!1;this.packetBuffer=[];c=g.parser||p;this.encoder=new c.Encoder;this.decoder=new c.Decoder;(this.autoConnect=!1!==g.autoConnect)&&this.open()}$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbolIterator();var b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?
function(a){return typeof a}:function(a){$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbol();return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},n=d(14),e=d(39);h=d(8);var p=d(7),l=d(41),g=d(42),c=d(3)("socket.io-client:manager"),k=d(37),t=d(43),q=Object.prototype.hasOwnProperty;f.exports=a;a.prototype.emitAll=function(){this.emit.apply(this,arguments);for(var a in this.nsps)q.call(this.nsps,a)&&this.nsps[a].emit.apply(this.nsps[a],arguments)};
a.prototype.updateSocketIds=function(){for(var a in this.nsps)q.call(this.nsps,a)&&(this.nsps[a].id=this.generateId(a))};a.prototype.generateId=function(a){return("/"===a?"":a+"#")+this.engine.id};h(a.prototype);a.prototype.reconnection=function(a){return arguments.length?(this._reconnection=!!a,this):this._reconnection};a.prototype.reconnectionAttempts=function(a){return arguments.length?(this._reconnectionAttempts=a,this):this._reconnectionAttempts};a.prototype.reconnectionDelay=function(a){return arguments.length?
(this._reconnectionDelay=a,this.backoff&&this.backoff.setMin(a),this):this._reconnectionDelay};a.prototype.randomizationFactor=function(a){return arguments.length?(this._randomizationFactor=a,this.backoff&&this.backoff.setJitter(a),this):this._randomizationFactor};a.prototype.reconnectionDelayMax=function(a){return arguments.length?(this._reconnectionDelayMax=a,this.backoff&&this.backoff.setMax(a),this):this._reconnectionDelayMax};a.prototype.timeout=function(a){return arguments.length?(this._timeout=
a,this):this._timeout};a.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()};a.prototype.open=a.prototype.connect=function(a,b){if(c("readyState %s",this.readyState),~this.readyState.indexOf("open"))return this;c("opening %s",this.uri);var g=this.engine=n(this.uri,this.opts),e=this;this.readyState="opening";this.skipReconnect=!1;var d=l(g,"open",function(){e.onopen();a&&a()});b=l(g,"error",function(b){if(c("connect_error"),
e.cleanup(),e.readyState="closed",e.emitAll("connect_error",b),a){var g=Error("Connection error");g.data=b;a(g)}else e.maybeReconnectOnOpen()});if(!1!==this._timeout){var f=this._timeout;c("connect attempt will timeout after %d",f);var q=setTimeout(function(){c("connect attempt timed out after %d",f);d.destroy();g.close();g.emit("error","timeout");e.emitAll("connect_timeout",f)},f);this.subs.push({destroy:function(){clearTimeout(q)}})}return this.subs.push(d),this.subs.push(b),this};a.prototype.onopen=
function(){c("open");this.cleanup();this.readyState="open";this.emit("open");var a=this.engine;this.subs.push(l(a,"data",g(this,"ondata")));this.subs.push(l(a,"ping",g(this,"onping")));this.subs.push(l(a,"pong",g(this,"onpong")));this.subs.push(l(a,"error",g(this,"onerror")));this.subs.push(l(a,"close",g(this,"onclose")));this.subs.push(l(this.decoder,"decoded",g(this,"ondecoded")))};a.prototype.onping=function(){this.lastPing=new Date;this.emitAll("ping")};a.prototype.onpong=function(){this.emitAll("pong",
new Date-this.lastPing)};a.prototype.ondata=function(a){this.decoder.add(a)};a.prototype.ondecoded=function(a){this.emit("packet",a)};a.prototype.onerror=function(a){c("error",a);this.emitAll("error",a)};a.prototype.socket=function(a,b){function c(){~k(d.connecting,g)||d.connecting.push(g)}var g=this.nsps[a];if(!g){g=new e(this,a,b);this.nsps[a]=g;var d=this;g.on("connecting",c);g.on("connect",function(){g.id=d.generateId(a)});this.autoConnect&&c()}return g};a.prototype.destroy=function(a){a=k(this.connecting,
a);~a&&this.connecting.splice(a,1);this.connecting.length||this.close()};a.prototype.packet=function(a){c("writing packet %j",a);var b=this;a.query&&0===a.type&&(a.nsp+="?"+a.query);b.encoding?b.packetBuffer.push(a):(b.encoding=!0,this.encoder.encode(a,function(c){for(var g=0;g<c.length;g++)b.engine.write(c[g],a.options);b.encoding=!1;b.processPacketQueue()}))};a.prototype.processPacketQueue=function(){if(0<this.packetBuffer.length&&!this.encoding){var a=this.packetBuffer.shift();this.packet(a)}};
a.prototype.cleanup=function(){c("cleanup");for(var a=this.subs.length,b=0;b<a;b++)this.subs.shift().destroy();this.packetBuffer=[];this.encoding=!1;this.lastPing=null;this.decoder.destroy()};a.prototype.close=a.prototype.disconnect=function(){c("disconnect");this.skipReconnect=!0;this.reconnecting=!1;"opening"===this.readyState&&this.cleanup();this.backoff.reset();this.readyState="closed";this.engine&&this.engine.close()};a.prototype.onclose=function(a){c("onclose");this.cleanup();this.backoff.reset();
this.readyState="closed";this.emit("close",a);this._reconnection&&!this.skipReconnect&&this.reconnect()};a.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var a=this;if(this.backoff.attempts>=this._reconnectionAttempts)c("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var b=this.backoff.duration();c("will wait %dms before reconnect attempt",b);this.reconnecting=!0;var g=setTimeout(function(){a.skipReconnect||(c("attempting reconnect"),
a.emitAll("reconnect_attempt",a.backoff.attempts),a.emitAll("reconnecting",a.backoff.attempts),a.skipReconnect||a.open(function(b){b?(c("reconnect attempt error"),a.reconnecting=!1,a.reconnect(),a.emitAll("reconnect_error",b.data)):(c("reconnect success"),a.onreconnect())}))},b);this.subs.push({destroy:function(){clearTimeout(g)}})}};a.prototype.onreconnect=function(){var a=this.backoff.attempts;this.reconnecting=!1;this.backoff.reset();this.updateSocketIds();this.emitAll("reconnect",a)}},function(f,
h,d){f.exports=d(15)},function(f,h,d){f.exports=d(16);f.exports.parser=d(23)},function(f,h,d){(function(a){function b(g,e){if(!(this instanceof b))return new b(g,e);e=e||{};g&&"object"==typeof g&&(e=g,g=null);g?(g=c(g),e.hostname=g.host,e.secure="https"===g.protocol||"wss"===g.protocol,e.port=g.port,g.query&&(e.query=g.query)):e.host&&(e.hostname=c(e.host).host);this.secure=null!=e.secure?e.secure:a.location&&"https:"===location.protocol;e.hostname&&!e.port&&(e.port=this.secure?"443":"80");this.agent=
e.agent||!1;this.hostname=e.hostname||(a.location?location.hostname:"localhost");this.port=e.port||(a.location&&location.port?location.port:this.secure?443:80);this.query=e.query||{};"string"==typeof this.query&&(this.query=t.decode(this.query));this.upgrade=!1!==e.upgrade;this.path=(e.path||"/engine.io").replace(/\/$/,"")+"/";this.forceJSONP=!!e.forceJSONP;this.jsonp=!1!==e.jsonp;this.forceBase64=!!e.forceBase64;this.enablesXDR=!!e.enablesXDR;this.timestampParam=e.timestampParam||"t";this.timestampRequests=
e.timestampRequests;this.transports=e.transports||["polling","websocket"];this.transportOptions=e.transportOptions||{};this.readyState="";this.writeBuffer=[];this.prevBufferLen=0;this.policyPort=e.policyPort||843;this.rememberUpgrade=e.rememberUpgrade||!1;this.binaryType=null;this.onlyBinaryUpgrades=e.onlyBinaryUpgrades;this.perMessageDeflate=!1!==e.perMessageDeflate&&(e.perMessageDeflate||{});!0===this.perMessageDeflate&&(this.perMessageDeflate={});this.perMessageDeflate&&null==this.perMessageDeflate.threshold&&
(this.perMessageDeflate.threshold=1024);this.pfx=e.pfx||null;this.key=e.key||null;this.passphrase=e.passphrase||null;this.cert=e.cert||null;this.ca=e.ca||null;this.ciphers=e.ciphers||null;this.rejectUnauthorized=void 0===e.rejectUnauthorized||e.rejectUnauthorized;this.forceNode=!!e.forceNode;g="object"==typeof a&&a;g.global===g&&(e.extraHeaders&&0<Object.keys(e.extraHeaders).length&&(this.extraHeaders=e.extraHeaders),e.localAddress&&(this.localAddress=e.localAddress));this.pingTimeoutTimer=this.pingIntervalTimer=
this.pingTimeout=this.pingInterval=this.upgrades=this.id=null;this.open()}var h=d(17),e=d(8),p=d(3)("engine.io-client:socket"),l=d(37),g=d(23),c=d(2),k=d(38),t=d(31);f.exports=b;b.priorWebsocketSuccess=!1;e(b.prototype);b.protocol=g.protocol;b.Socket=b;b.Transport=d(22);b.transports=d(17);b.parser=d(23);b.prototype.createTransport=function(a){p('creating transport "%s"',a);var b=this.query,c={},e;for(e in b)b.hasOwnProperty(e)&&(c[e]=b[e]);c.EIO=g.protocol;c.transport=a;b=this.transportOptions[a]||
{};this.id&&(c.sid=this.id);return new h[a]({query:c,socket:this,agent:b.agent||this.agent,hostname:b.hostname||this.hostname,port:b.port||this.port,secure:b.secure||this.secure,path:b.path||this.path,forceJSONP:b.forceJSONP||this.forceJSONP,jsonp:b.jsonp||this.jsonp,forceBase64:b.forceBase64||this.forceBase64,enablesXDR:b.enablesXDR||this.enablesXDR,timestampRequests:b.timestampRequests||this.timestampRequests,timestampParam:b.timestampParam||this.timestampParam,policyPort:b.policyPort||this.policyPort,
pfx:b.pfx||this.pfx,key:b.key||this.key,passphrase:b.passphrase||this.passphrase,cert:b.cert||this.cert,ca:b.ca||this.ca,ciphers:b.ciphers||this.ciphers,rejectUnauthorized:b.rejectUnauthorized||this.rejectUnauthorized,perMessageDeflate:b.perMessageDeflate||this.perMessageDeflate,extraHeaders:b.extraHeaders||this.extraHeaders,forceNode:b.forceNode||this.forceNode,localAddress:b.localAddress||this.localAddress,requestTimeout:b.requestTimeout||this.requestTimeout,protocols:b.protocols||void 0})};b.prototype.open=
function(){if(this.rememberUpgrade&&b.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))var a="websocket";else{if(0===this.transports.length){var c=this;return void setTimeout(function(){c.emit("error","No transports available")},0)}a=this.transports[0]}this.readyState="opening";try{a=this.createTransport(a)}catch(y){return this.transports.shift(),void this.open()}a.open();this.setTransport(a)};b.prototype.setTransport=function(a){p("setting transport %s",a.name);var b=this;this.transport&&
(p("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners());this.transport=a;a.on("drain",function(){b.onDrain()}).on("packet",function(a){b.onPacket(a)}).on("error",function(a){b.onError(a)}).on("close",function(){b.onClose("transport close")})};b.prototype.probe=function(a){function c(){if(k.onlyBinaryUpgrades){var c=!this.supportsBinary&&k.transport.supportsBinary;n=n||c}n||(p('probe transport "%s" opened',a),l.send([{type:"ping",data:"probe"}]),l.once("packet",
function(c){if(!n)if("pong"===c.type&&"probe"===c.data){if(p('probe transport "%s" pong',a),k.upgrading=!0,k.emit("upgrading",l),l)b.priorWebsocketSuccess="websocket"===l.name,p('pausing current transport "%s"',k.transport.name),k.transport.pause(function(){n||"closed"!==k.readyState&&(p("changing transport and sending upgrade packet"),q(),k.setTransport(l),l.send([{type:"upgrade"}]),k.emit("upgrade",l),l=null,k.upgrading=!1,k.flush())})}else p('probe transport "%s" failed',a),c=Error("probe error"),
c.transport=l.name,k.emit("upgradeError",c)}))}function g(){n||(n=!0,q(),l.close(),l=null)}function e(b){var c=Error("probe error: "+b);c.transport=l.name;g();p('probe transport "%s" failed because of error: %s',a,b);k.emit("upgradeError",c)}function d(){e("transport closed")}function f(){e("socket closed")}function h(a){l&&a.name!==l.name&&(p('"%s" works - aborting "%s"',a.name,l.name),g())}function q(){l.removeListener("open",c);l.removeListener("error",e);l.removeListener("close",d);k.removeListener("close",
f);k.removeListener("upgrading",h)}p('probing transport "%s"',a);var l=this.createTransport(a,{probe:1}),n=!1,k=this;b.priorWebsocketSuccess=!1;l.once("open",c);l.once("error",e);l.once("close",d);this.once("close",f);this.once("upgrading",h);l.open()};b.prototype.onOpen=function(){if(p("socket open"),this.readyState="open",b.priorWebsocketSuccess="websocket"===this.transport.name,this.emit("open"),this.flush(),"open"===this.readyState&&this.upgrade&&this.transport.pause){p("starting upgrade probes");
for(var a=0,c=this.upgrades.length;a<c;a++)this.probe(this.upgrades[a])}};b.prototype.onPacket=function(a){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(p('socket receive: type "%s", data "%s"',a.type,a.data),this.emit("packet",a),this.emit("heartbeat"),a.type){case "open":this.onHandshake(k(a.data));break;case "pong":this.setPing();this.emit("pong");break;case "error":var b=Error("server error");b.code=a.data;this.onError(b);break;case "message":this.emit("data",
a.data),this.emit("message",a.data)}else p('packet received with socket readyState "%s"',this.readyState)};b.prototype.onHandshake=function(a){this.emit("handshake",a);this.id=a.sid;this.transport.query.sid=a.sid;this.upgrades=this.filterUpgrades(a.upgrades);this.pingInterval=a.pingInterval;this.pingTimeout=a.pingTimeout;this.onOpen();"closed"!==this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))};b.prototype.onHeartbeat=function(a){clearTimeout(this.pingTimeoutTimer);
var b=this;b.pingTimeoutTimer=setTimeout(function(){"closed"!==b.readyState&&b.onClose("ping timeout")},a||b.pingInterval+b.pingTimeout)};b.prototype.setPing=function(){var a=this;clearTimeout(a.pingIntervalTimer);a.pingIntervalTimer=setTimeout(function(){p("writing ping packet - expecting pong within %sms",a.pingTimeout);a.ping();a.onHeartbeat(a.pingTimeout)},a.pingInterval)};b.prototype.ping=function(){var a=this;this.sendPacket("ping",function(){a.emit("ping")})};b.prototype.onDrain=function(){this.writeBuffer.splice(0,
this.prevBufferLen);this.prevBufferLen=0;0===this.writeBuffer.length?this.emit("drain"):this.flush()};b.prototype.flush=function(){"closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(p("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))};b.prototype.write=b.prototype.send=function(a,b,c){return this.sendPacket("message",a,b,c),this};b.prototype.sendPacket=
function(a,b,c,g){if("function"==typeof b&&(g=b,b=void 0),"function"==typeof c&&(g=c,c=null),"closing"!==this.readyState&&"closed"!==this.readyState)c=c||{},c.compress=!1!==c.compress,a={type:a,data:b,options:c},this.emit("packetCreate",a),this.writeBuffer.push(a),g&&this.once("flush",g),this.flush()};b.prototype.close=function(){function a(){g.onClose("forced close");p("socket closing - telling transport to close");g.transport.close()}function b(){g.removeListener("upgrade",b);g.removeListener("upgradeError",
b);a()}function c(){g.once("upgrade",b);g.once("upgradeError",b)}if("opening"===this.readyState||"open"===this.readyState){this.readyState="closing";var g=this;this.writeBuffer.length?this.once("drain",function(){this.upgrading?c():a()}):this.upgrading?c():a()}return this};b.prototype.onError=function(a){p("socket error %j",a);b.priorWebsocketSuccess=!1;this.emit("error",a);this.onClose("transport error",a)};b.prototype.onClose=function(a,b){if("opening"===this.readyState||"open"===this.readyState||
"closing"===this.readyState)p('socket close with reason: "%s"',a),clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",a,b),this.writeBuffer=[],this.prevBufferLen=0};b.prototype.filterUpgrades=function(a){for(var b=[],c=0,g=a.length;c<g;c++)~l(this.transports,a[c])&&b.push(a[c]);return b}}).call(h,function(){return this}())},
function(f,h,d){(function(a){var b=d(18),f=d(20),e=d(34),p=d(35);h.polling=function(d){var g,c=!1,h=!1,l=!1!==d.jsonp;a.location&&(h="https:"===location.protocol,(c=location.port)||(c=h?443:80),c=d.hostname!==location.hostname||c!==d.port,h=d.secure!==h);if(d.xdomain=c,d.xscheme=h,g=new b(d),"open"in g&&!d.forceJSONP)return new f(d);if(!l)throw Error("JSONP disabled");return new e(d)};h.websocket=p}).call(h,function(){return this}())},function(f,h,d){(function(a){var b=d(19);f.exports=function(d){var e=
d.xdomain,f=d.xscheme;d=d.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!e||b))return new XMLHttpRequest}catch(l){}try{if("undefined"!=typeof XDomainRequest&&!f&&d)return new XDomainRequest}catch(l){}if(!e)try{return new (a[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(l){}}}).call(h,function(){return this}())},function(f,h){try{f.exports="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(d){f.exports=!1}},function(f,h,d){(function(a){function b(){}
function h(b){if(g.call(this,b),this.requestTimeout=b.requestTimeout,this.extraHeaders=b.extraHeaders,a.location){var c="https:"===location.protocol,e=location.port;e||(e=c?443:80);this.xd=b.hostname!==a.location.hostname||e!==b.port;this.xs=b.secure!==c}}function e(a){this.method=a.method||"GET";this.uri=a.uri;this.xd=!!a.xd;this.xs=!!a.xs;this.async=!1!==a.async;this.data=void 0!==a.data?a.data:null;this.agent=a.agent;this.isBinary=a.isBinary;this.supportsBinary=a.supportsBinary;this.enablesXDR=
a.enablesXDR;this.requestTimeout=a.requestTimeout;this.pfx=a.pfx;this.key=a.key;this.passphrase=a.passphrase;this.cert=a.cert;this.ca=a.ca;this.ciphers=a.ciphers;this.rejectUnauthorized=a.rejectUnauthorized;this.extraHeaders=a.extraHeaders;this.create()}function p(){for(var a in e.requests)e.requests.hasOwnProperty(a)&&e.requests[a].abort()}var l=d(18),g=d(21),c=d(8),k=d(32),t=d(3)("engine.io-client:polling-xhr");f.exports=h;f.exports.Request=e;k(h,g);h.prototype.supportsBinary=!0;h.prototype.request=
function(a){return a=a||{},a.uri=this.uri(),a.xd=this.xd,a.xs=this.xs,a.agent=this.agent||!1,a.supportsBinary=this.supportsBinary,a.enablesXDR=this.enablesXDR,a.pfx=this.pfx,a.key=this.key,a.passphrase=this.passphrase,a.cert=this.cert,a.ca=this.ca,a.ciphers=this.ciphers,a.rejectUnauthorized=this.rejectUnauthorized,a.requestTimeout=this.requestTimeout,a.extraHeaders=this.extraHeaders,new e(a)};h.prototype.doWrite=function(a,b){a=this.request({method:"POST",data:a,isBinary:"string"!=typeof a&&void 0!==
a});var c=this;a.on("success",b);a.on("error",function(a){c.onError("xhr post error",a)});this.sendXhr=a};h.prototype.doPoll=function(){t("xhr poll");var a=this.request(),b=this;a.on("data",function(a){b.onData(a)});a.on("error",function(a){b.onError("xhr poll error",a)});this.pollXhr=a};c(e.prototype);e.prototype.create=function(){var b={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};b.pfx=this.pfx;b.key=this.key;b.passphrase=this.passphrase;b.cert=this.cert;b.ca=this.ca;
b.ciphers=this.ciphers;b.rejectUnauthorized=this.rejectUnauthorized;var c=this.xhr=new l(b),g=this;try{t("xhr open %s: %s",this.method,this.uri);c.open(this.method,this.uri,this.async);try{if(this.extraHeaders){c.setDisableHeaderCheck&&c.setDisableHeaderCheck(!0);for(var d in this.extraHeaders)this.extraHeaders.hasOwnProperty(d)&&c.setRequestHeader(d,this.extraHeaders[d])}}catch(v){}if("POST"===this.method)try{this.isBinary?c.setRequestHeader("Content-type","application/octet-stream"):c.setRequestHeader("Content-type",
"text/plain;charset\x3dUTF-8")}catch(v){}try{c.setRequestHeader("Accept","*/*")}catch(v){}"withCredentials"in c&&(c.withCredentials=!0);this.requestTimeout&&(c.timeout=this.requestTimeout);this.hasXDR()?(c.onload=function(){g.onLoad()},c.onerror=function(){g.onError(c.responseText)}):c.onreadystatechange=function(){if(2===c.readyState){try{var a=c.getResponseHeader("Content-Type")}catch(z){}"application/octet-stream"===a&&(c.responseType="arraybuffer")}4===c.readyState&&(200===c.status||1223===c.status?
g.onLoad():setTimeout(function(){g.onError(c.status)},0))};t("xhr data %s",this.data);c.send(this.data)}catch(v){return void setTimeout(function(){g.onError(v)},0)}a.document&&(this.index=e.requestsCount++,e.requests[this.index]=this)};e.prototype.onSuccess=function(){this.emit("success");this.cleanup()};e.prototype.onData=function(a){this.emit("data",a);this.onSuccess()};e.prototype.onError=function(a){this.emit("error",a);this.cleanup(!0)};e.prototype.cleanup=function(c){if("undefined"!=typeof this.xhr&&
null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=b:this.xhr.onreadystatechange=b,c)try{this.xhr.abort()}catch(x){}a.document&&delete e.requests[this.index];this.xhr=null}};e.prototype.onLoad=function(){try{try{var a=this.xhr.getResponseHeader("Content-Type")}catch(y){}var b="application/octet-stream"===a?this.xhr.response||this.xhr.responseText:this.xhr.responseText}catch(y){this.onError(y)}null!=b&&this.onData(b)};e.prototype.hasXDR=function(){return"undefined"!=typeof a.XDomainRequest&&
!this.xs&&this.enablesXDR};e.prototype.abort=function(){this.cleanup()};e.requestsCount=0;e.requests={};a.document&&(a.attachEvent?a.attachEvent("onunload",p):a.addEventListener&&a.addEventListener("beforeunload",p,!1))}).call(h,function(){return this}())},function(f,h,d){function a(a){var c=a&&a.forceBase64;g&&!c||(this.supportsBinary=!1);b.call(this,a)}var b=d(22),n=d(31),e=d(23);h=d(32);var k=d(33),l=d(3)("engine.io-client:polling");f.exports=a;var g=null!=(new (d(18))({xdomain:!1})).responseType;
h(a,b);a.prototype.name="polling";a.prototype.doOpen=function(){this.poll()};a.prototype.pause=function(a){function b(){l("paused");c.readyState="paused";a()}var c=this;if(this.readyState="pausing",this.polling||!this.writable){var g=0;this.polling&&(l("we are currently polling - waiting to pause"),g++,this.once("pollComplete",function(){l("pre-pause polling complete");--g||b()}));this.writable||(l("we are currently writing - waiting to pause"),g++,this.once("drain",function(){l("pre-pause writing complete");
--g||b()}))}else b()};a.prototype.poll=function(){l("polling");this.polling=!0;this.doPoll();this.emit("poll")};a.prototype.onData=function(a){var b=this;l("polling got data %s",a);e.decodePayload(a,this.socket.binaryType,function(a,c,g){return"opening"===b.readyState&&b.onOpen(),"close"===a.type?(b.onClose(),!1):void b.onPacket(a)});"closed"!==this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"===this.readyState?this.poll():l('ignoring poll - transport state "%s"',this.readyState))};
a.prototype.doClose=function(){function a(){l("writing close packet");b.write([{type:"close"}])}var b=this;"open"===this.readyState?(l("transport open - closing"),a()):(l("transport not open - deferring close"),this.once("open",a))};a.prototype.write=function(a){var b=this;this.writable=!1;var c=function(){b.writable=!0;b.emit("drain")};e.encodePayload(a,this.supportsBinary,function(a){b.doWrite(a,c)})};a.prototype.uri=function(){var a=this.query||{},b=this.secure?"https":"http",g="";!1!==this.timestampRequests&&
(a[this.timestampParam]=k());this.supportsBinary||a.sid||(a.b64=1);a=n.encode(a);this.port&&("https"===b&&443!==Number(this.port)||"http"===b&&80!==Number(this.port))&&(g=":"+this.port);a.length&&(a="?"+a);var e=-1!==this.hostname.indexOf(":");return b+"://"+(e?"["+this.hostname+"]":this.hostname)+g+this.path+a}},function(f,h,d){function a(a){this.path=a.path;this.hostname=a.hostname;this.port=a.port;this.secure=a.secure;this.query=a.query;this.timestampParam=a.timestampParam;this.timestampRequests=
a.timestampRequests;this.readyState="";this.agent=a.agent||!1;this.socket=a.socket;this.enablesXDR=a.enablesXDR;this.pfx=a.pfx;this.key=a.key;this.passphrase=a.passphrase;this.cert=a.cert;this.ca=a.ca;this.ciphers=a.ciphers;this.rejectUnauthorized=a.rejectUnauthorized;this.forceNode=a.forceNode;this.extraHeaders=a.extraHeaders;this.localAddress=a.localAddress}var b=d(23);h=d(8);f.exports=a;h(a.prototype);a.prototype.onError=function(a,b){a=Error(a);return a.type="TransportError",a.description=b,this.emit("error",
a),this};a.prototype.open=function(){return"closed"!==this.readyState&&""!==this.readyState||(this.readyState="opening",this.doOpen()),this};a.prototype.close=function(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this};a.prototype.send=function(a){if("open"!==this.readyState)throw Error("Transport not open");this.write(a)};a.prototype.onOpen=function(){this.readyState="open";this.writable=!0;this.emit("open")};a.prototype.onData=function(a){a=b.decodePacket(a,
this.socket.binaryType);this.onPacket(a)};a.prototype.onPacket=function(a){this.emit("packet",a)};a.prototype.onClose=function(){this.readyState="closed";this.emit("close")}},function(f,h,d){(function(a){function b(a,b,c){if(!b)return h.encodeBase64Packet(a,c);var g=new FileReader;return g.onload=function(){a.data=g.result;h.encodePacket(a,b,!0,c)},g.readAsArrayBuffer(a.data)}function f(a,b,g){var e=Array(a.length);g=c(a.length,g);for(var d=function(a,c,g){b(c,function(b,c){e[a]=c;g(b,e)})},f=0;f<
a.length;f++)d(f,a[f],g)}var e,k=d(24),l=d(9),g=d(25),c=d(26),u=d(27);a&&a.ArrayBuffer&&(e=d(29));var t="undefined"!=typeof navigator&&/Android/i.test(navigator.userAgent),q="undefined"!=typeof navigator&&/PhantomJS/i.test(navigator.userAgent),x=t||q;h.protocol=3;var y=h.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},w=k(y),v={type:"error",data:"parser error"},z=d(30);h.encodePacket=function(c,g,e,d){"function"==typeof g&&(d=g,g=!1);"function"==typeof e&&(d=e,e=null);var f=void 0===
c.data?void 0:c.data.buffer||c.data;if(a.ArrayBuffer&&f instanceof ArrayBuffer){if(g){e=c.data;g=new Uint8Array(e);e=new Uint8Array(1+e.byteLength);e[0]=y[c.type];for(c=0;c<g.length;c++)e[c+1]=g[c];c=d(e.buffer)}else c=h.encodeBase64Packet(c,d);return c}if(z&&f instanceof a.Blob)return g?x?c=b(c,g,d):(g=new Uint8Array(1),g[0]=y[c.type],c=new z([g.buffer,c.data]),c=d(c)):c=h.encodeBase64Packet(c,d),c;if(f&&f.base64)return d("b"+h.packets[c.type]+c.data.data);g=y[c.type];return void 0!==c.data&&(g+=
e?u.encode(String(c.data),{strict:!1}):String(c.data)),d(""+g)};h.encodeBase64Packet=function(b,c){var g="b"+h.packets[b.type];if(z&&b.data instanceof a.Blob){var e=new FileReader;return e.onload=function(){var a=e.result.split(",")[1];c(g+a)},e.readAsDataURL(b.data)}try{var d=String.fromCharCode.apply(null,new Uint8Array(b.data))}catch(J){b=new Uint8Array(b.data);d=Array(b.length);for(var f=0;f<b.length;f++)d[f]=b[f];d=String.fromCharCode.apply(null,d)}return g+=a.btoa(d),c(g)};h.decodePacket=function(a,
b,c){if(void 0===a)return v;if("string"==typeof a){if("b"===a.charAt(0))return h.decodeBase64Packet(a.substr(1),b);if(b=c){b=a;try{b=u.decode(b,{strict:!1})}catch(A){b=!1}b=(a=b,!1===a)}if(b)return v;c=a.charAt(0);return Number(c)==c&&w[c]?1<a.length?{type:w[c],data:a.substring(1)}:{type:w[c]}:v}c=(new Uint8Array(a))[0];a=g(a,1);return z&&"blob"===b&&(a=new z([a])),{type:w[c],data:a}};h.decodeBase64Packet=function(a,b){var c=w[a.charAt(0)];if(!e)return{type:c,data:{base64:!0,data:a.substr(1)}};a=
e.decode(a.substr(1));return"blob"===b&&z&&(a=new z([a])),{type:c,data:a}};h.encodePayload=function(a,b,c){function g(a,c){h.encodePacket(a,!!e&&b,!1,function(a){c(null,a.length+":"+a)})}"function"==typeof b&&(c=b,b=null);var e=l(a);return b&&e?z&&!x?h.encodePayloadAsBlob(a,c):h.encodePayloadAsArrayBuffer(a,c):a.length?void f(a,g,function(a,b){return c(b.join(""))}):c("0:")};h.decodePayload=function(a,b,c){if("string"!=typeof a)return h.decodePayloadAsBinary(a,b,c);"function"==typeof b&&(c=b,b=null);
var g;if(""===a)return c(v,0,1);for(var e,d,f="",l=0,q=a.length;l<q;l++){var n=a.charAt(l);if(":"===n){if(""===f||f!=(e=Number(f))||(d=a.substr(l+1,e),f!=d.length))return c(v,0,1);if(d.length){if(g=h.decodePacket(d,b,!1),v.type===g.type&&v.data===g.data)return c(v,0,1);if(!1===c(g,l+e,q))return}l+=e;f=""}else f+=n}return""!==f?c(v,0,1):void 0};h.encodePayloadAsArrayBuffer=function(a,b){function c(a,b){h.encodePacket(a,!0,!0,function(a){return b(null,a)})}return a.length?void f(a,c,function(a,c){a=
c.reduce(function(a,b){var c;return c="string"==typeof b?b.length:b.byteLength,a+c.toString().length+c+2},0);var g=new Uint8Array(a),e=0;return c.forEach(function(a){var b="string"==typeof a,c=a;if(b){for(var c=new Uint8Array(a.length),d=0;d<a.length;d++)c[d]=a.charCodeAt(d);c=c.buffer}b?g[e++]=0:g[e++]=1;a=c.byteLength.toString();for(d=0;d<a.length;d++)g[e++]=parseInt(a[d]);g[e++]=255;c=new Uint8Array(c);for(d=0;d<c.length;d++)g[e++]=c[d]}),b(g.buffer)}):b(new ArrayBuffer(0))};h.encodePayloadAsBlob=
function(a,b){f(a,function(a,b){h.encodePacket(a,!0,!0,function(a){var c=new Uint8Array(1);if(c[0]=1,"string"==typeof a){for(var g=new Uint8Array(a.length),e=0;e<a.length;e++)g[e]=a.charCodeAt(e);a=g.buffer;c[0]=0}for(var g=(a instanceof ArrayBuffer?a.byteLength:a.size).toString(),d=new Uint8Array(g.length+1),e=0;e<g.length;e++)d[e]=parseInt(g[e]);if(d[g.length]=255,z)a=new z([c.buffer,d.buffer,a]),b(null,a)})},function(a,c){return b(new z(c))})};h.decodePayloadAsBinary=function(a,b,c){"function"==
typeof b&&(c=b,b=null);for(var e=[];0<a.byteLength;){for(var d=new Uint8Array(a),f=0===d[0],l="",q=1;255!==d[q];q++){if(310<l.length)return c(v,0,1);l+=d[q]}a=g(a,2+l.length);l=parseInt(l);d=g(a,0,l);if(f)try{d=String.fromCharCode.apply(null,new Uint8Array(d))}catch(M){for(f=new Uint8Array(d),d="",q=0;q<f.length;q++)d+=String.fromCharCode(f[q])}e.push(d);a=g(a,l)}var n=e.length;e.forEach(function(a,g){c(h.decodePacket(a,b,!0),g,n)})}}).call(h,function(){return this}())},function(f,h){f.exports=Object.keys||
function(d){var a=[],b=Object.prototype.hasOwnProperty,f;for(f in d)b.call(d,f)&&a.push(f);return a}},function(f,h){f.exports=function(d,a,b){var f=d.byteLength;if(a=a||0,b=b||f,d.slice)return d.slice(a,b);if(0>a&&(a+=f),0>b&&(b+=f),b>f&&(b=f),a>=f||a>=b||0===f)return new ArrayBuffer(0);d=new Uint8Array(d);for(var f=new Uint8Array(b-a),e=0;a<b;a++,e++)f[e]=d[a];return f.buffer}},function(f,h){function d(){}f.exports=function(a,b,f){function e(a,g){if(0>=e.count)throw Error("after called too many times");
--e.count;a?(h=!0,b(a),b=f):0!==e.count||h||b(null,g)}var h=!1;return f=f||d,e.count=a,0===a?b():e}},function(f,h,d){var a;(function(b,f){!function(e){function f(a){for(var b,c,g=[],e=0,d=a.length;e<d;)b=a.charCodeAt(e++),55296<=b&&56319>=b&&e<d?(c=a.charCodeAt(e++),56320==(64512&c)?g.push(((1023&b)<<10)+(1023&c)+65536):(g.push(b),e--)):g.push(b);return g}function l(a,b){if(55296<=a&&57343>=a){if(b)throw Error("Lone surrogate U+"+a.toString(16).toUpperCase()+" is not a scalar value");return!1}return!0}
function g(){if(q>=k)throw Error("Invalid byte index");var a=255&n[q];if(q++,128==(192&a))return 63&a;throw Error("Invalid continuation byte");}function c(a){var b,c,e,d,f;if(q>k)throw Error("Invalid byte index");if(q==k)return!1;if(b=255&n[q],q++,0==(128&b))return b;if(192==(224&b)){if(c=g(),f=(31&b)<<6|c,128<=f)return f;throw Error("Invalid continuation byte");}if(224==(240&b)){if(c=g(),e=g(),f=(15&b)<<12|c<<6|e,2048<=f)return l(f,a)?f:65533;throw Error("Invalid continuation byte");}if(240==(248&
b)&&(c=g(),e=g(),d=g(),f=(7&b)<<18|c<<12|e<<6|d,65536<=f&&1114111>=f))return f;throw Error("Invalid UTF-8 detected");}e="object"==typeof h&&h;"object"==typeof b&&b&&b.exports==e&&b;var n,k,q,x=String.fromCharCode,y={version:"2.1.2",encode:function(a,b){b=b||{};b=!1!==b.strict;a=f(a);for(var c=a.length,g=-1,e="";++g<c;){var d=a[g];var h=b;if(0==(4294967168&d))h=x(d);else{var q="";h=(0==(4294965248&d)?q=x(d>>6&31|192):0==(4294901760&d)?(l(d,h)||(d=65533),q=x(d>>12&15|224),q+=x(d>>6&63|128)):0==(4292870144&
d)&&(q=x(d>>18&7|240),q+=x(d>>12&63|128),q+=x(d>>6&63|128)),q+x(63&d|128))}e+=h}return e},decode:function(a,b){b=b||{};b=!1!==b.strict;n=f(a);k=n.length;q=0;var g;for(a=[];!1!==(g=c(b));)a.push(g);g=a.length;for(var e=-1,d="";++e<g;)b=a[e],65535<b&&(b-=65536,d+=x(b>>>10&1023|55296),b=56320|1023&b),d+=x(b);return d}};a=function(){return y}.call(h,d,h,b);!(void 0!==a&&(b.exports=a))}(this)}).call(h,d(28)(f),function(){return this}())},function(f,h){f.exports=function(d){return d.webpackPolyfill||(d.deprecate=
function(){},d.paths=[],d.children=[],d.webpackPolyfill=1),d}},function(f,h){!function(){for(var d=new Uint8Array(256),a=0;64>a;a++)d["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charCodeAt(a)]=a;h.encode=function(a){var b=new Uint8Array(a),e=b.length,d="";for(a=0;a<e;a+=3)d+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[b[a]>>2],d+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[(3&b[a])<<4|b[a+1]>>4],d+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[(15&
b[a+1])<<2|b[a+2]>>6],d+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[63&b[a+2]];return 2===e%3?d=d.substring(0,d.length-1)+"\x3d":1===e%3&&(d=d.substring(0,d.length-2)+"\x3d\x3d"),d};h.decode=function(a){var b=.75*a.length;var e=a.length,f=0;"\x3d"===a[a.length-1]&&(b--,"\x3d"===a[a.length-2]&&b--);var h=new ArrayBuffer(b),g=new Uint8Array(h);for(b=0;b<e;b+=4){var c=d[a.charCodeAt(b)];var k=d[a.charCodeAt(b+1)];var t=d[a.charCodeAt(b+2)];var q=d[a.charCodeAt(b+3)];g[f++]=c<<
2|k>>4;g[f++]=(15&k)<<4|t>>2;g[f++]=(3&t)<<6|63&q}return h}}()},function(f,h){(function(d){function a(a){for(var b=0;b<a.length;b++){var c=a[b];if(c.buffer instanceof ArrayBuffer){var g=c.buffer;if(c.byteLength!==g.byteLength){var e=new Uint8Array(c.byteLength);e.set(new Uint8Array(g,c.byteOffset,c.byteLength));g=e.buffer}a[b]=g}}}function b(b,g){g=g||{};var c=new e;a(b);for(var d=0;d<b.length;d++)c.append(b[d]);return g.type?c.getBlob(g.type):c.getBlob()}function h(b,g){return a(b),new Blob(b,g||
{})}var e=d.BlobBuilder||d.WebKitBlobBuilder||d.MSBlobBuilder||d.MozBlobBuilder;try{var k=2===(new Blob(["hi"])).size}catch(c){k=!1}var l;if(l=k)try{l=2===(new Blob([new Uint8Array([1,2])])).size}catch(c){l=!1}var g=e&&e.prototype.append&&e.prototype.getBlob;f.exports=k?l?d.Blob:h:g?b:void 0}).call(h,function(){return this}())},function(f,h){h.encode=function(d){var a="",b;for(b in d)d.hasOwnProperty(b)&&(a.length&&(a+="\x26"),a+=encodeURIComponent(b)+"\x3d"+encodeURIComponent(d[b]));return a};h.decode=
function(d){var a={};d=d.split("\x26");for(var b=0,f=d.length;b<f;b++){var e=d[b].split("\x3d");a[decodeURIComponent(e[0])]=decodeURIComponent(e[1])}return a}},function(f,h){f.exports=function(d,a){var b=function(){};b.prototype=a.prototype;d.prototype=new b;d.prototype.constructor=d}},function(f,h){function d(a){var b="";do b=n[a%e]+b,a=Math.floor(a/e);while(0<a);return b}function a(){var a=d(+new Date);return a!==b?(l=0,b=a):a+"."+d(l++)}for(var b,n="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),
e=64,k={},l=0,g=0;g<e;g++)k[n[g]]=g;a.encode=d;a.decode=function(a){var b=0;for(g=0;g<a.length;g++)b=b*e+k[a.charAt(g)];return b};f.exports=a},function(f,h,d){(function(a){function b(){}function h(c){e.call(this,c);this.query=this.query||{};l||(a.___eio||(a.___eio=[]),l=a.___eio);this.index=l.length;var g=this;l.push(function(a){g.onData(a)});this.query.j=this.index;a.document&&a.addEventListener&&a.addEventListener("beforeunload",function(){g.script&&(g.script.onerror=b)},!1)}var e=d(21),k=d(32);
f.exports=h;var l,g=/\n/g,c=/\\n/g;k(h,e);h.prototype.supportsBinary=!1;h.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null);this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null);e.prototype.doClose.call(this)};h.prototype.doPoll=function(){var a=this,b=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null);b.async=!0;b.src=this.uri();b.onerror=function(b){a.onError("jsonp poll error",
b)};var c=document.getElementsByTagName("script")[0];c?c.parentNode.insertBefore(b,c):(document.head||document.body).appendChild(b);this.script=b;"undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent)&&setTimeout(function(){var a=document.createElement("iframe");document.body.appendChild(a);document.body.removeChild(a)},100)};h.prototype.doWrite=function(a,b){function e(){d();b()}function d(){if(h.iframe)try{h.form.removeChild(h.iframe)}catch(G){h.onError("jsonp polling iframe removal error",
G)}try{f=document.createElement('\x3ciframe src\x3d"javascript:0" name\x3d"'+h.iframeId+'"\x3e')}catch(G){f=document.createElement("iframe"),f.name=h.iframeId,f.src="javascript:0"}f.id=h.iframeId;h.form.appendChild(f);h.iframe=f}var f,h=this;if(!this.form){var l=document.createElement("form"),n=document.createElement("textarea"),k=this.iframeId="eio_iframe_"+this.index;l.className="socketio";l.style.position="absolute";l.style.top="-1000px";l.style.left="-1000px";l.target=k;l.method="POST";l.setAttribute("accept-charset",
"utf-8");n.name="d";l.appendChild(n);document.body.appendChild(l);this.form=l;this.area=n}this.form.action=this.uri();d();a=a.replace(c,"\\\n");this.area.value=a.replace(g,"\\n");try{this.form.submit()}catch(G){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"===h.iframe.readyState&&e()}:this.iframe.onload=e}}).call(h,function(){return this}())},function(f,h,d){(function(a){function b(a){a&&a.forceBase64&&(this.supportsBinary=!1);this.perMessageDeflate=a.perMessageDeflate;
this.usingBrowserWebSocket=m&&!a.forceNode;this.protocols=a.protocols;this.usingBrowserWebSocket||(q=t);h.call(this,a)}var h=d(22),e=d(23),k=d(31),l=d(32),g=d(33),c=d(3)("engine.io-client:websocket"),m=a.WebSocket||a.MozWebSocket;if("undefined"==typeof window)try{var t=d(36)}catch(x){}var q=m;q||"undefined"!=typeof window||(q=t);f.exports=b;l(b,h);b.prototype.name="websocket";b.prototype.supportsBinary=!0;b.prototype.doOpen=function(){if(this.check()){var a=this.uri(),b=this.protocols,c={agent:this.agent,
perMessageDeflate:this.perMessageDeflate};c.pfx=this.pfx;c.key=this.key;c.passphrase=this.passphrase;c.cert=this.cert;c.ca=this.ca;c.ciphers=this.ciphers;c.rejectUnauthorized=this.rejectUnauthorized;this.extraHeaders&&(c.headers=this.extraHeaders);this.localAddress&&(c.localAddress=this.localAddress);try{this.ws=this.usingBrowserWebSocket?b?new q(a,b):new q(a):new q(a,b,c)}catch(v){return this.emit("error",v)}void 0===this.ws.binaryType&&(this.supportsBinary=!1);this.ws.supports&&this.ws.supports.binary?
(this.supportsBinary=!0,this.ws.binaryType="nodebuffer"):this.ws.binaryType="arraybuffer";this.addEventListeners()}};b.prototype.addEventListeners=function(){var a=this;this.ws.onopen=function(){a.onOpen()};this.ws.onclose=function(){a.onClose()};this.ws.onmessage=function(b){a.onData(b.data)};this.ws.onerror=function(b){a.onError("websocket error",b)}};b.prototype.write=function(b){function g(){d.emit("flush");setTimeout(function(){d.writable=!0;d.emit("drain")},0)}var d=this;this.writable=!1;for(var f=
b.length,h=0,l=f;h<l;h++)!function(b){e.encodePacket(b,d.supportsBinary,function(e){if(!d.usingBrowserWebSocket){var h={};(b.options&&(h.compress=b.options.compress),d.perMessageDeflate)&&("string"==typeof e?a.Buffer.byteLength(e):e.length)<d.perMessageDeflate.threshold&&(h.compress=!1)}try{d.usingBrowserWebSocket?d.ws.send(e):d.ws.send(e,h)}catch(I){c("websocket closed before onclose event")}--f||g()})}(b[h])};b.prototype.onClose=function(){h.prototype.onClose.call(this)};b.prototype.doClose=function(){"undefined"!=
typeof this.ws&&this.ws.close()};b.prototype.uri=function(){var a=this.query||{},b=this.secure?"wss":"ws",c="";this.port&&("wss"===b&&443!==Number(this.port)||"ws"===b&&80!==Number(this.port))&&(c=":"+this.port);this.timestampRequests&&(a[this.timestampParam]=g());this.supportsBinary||(a.b64=1);a=k.encode(a);a.length&&(a="?"+a);var e=-1!==this.hostname.indexOf(":");return b+"://"+(e?"["+this.hostname+"]":this.hostname)+c+this.path+a};b.prototype.check=function(){return!(!q||"__initialize"in q&&this.name===
b.prototype.name)}}).call(h,function(){return this}())},function(f,h){},function(f,h){var d=[].indexOf;f.exports=function(a,b){if(d)return a.indexOf(b);for(var f=0;f<a.length;++f)if(a[f]===b)return f;return-1}},function(f,h){(function(d){var a=/^[\],:{}\s]*$/,b=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,h=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,e=/(?:^|:|,)(?:\s*\[)+/g,k=/^\s+/,l=/\s+$/;f.exports=function(g){return"string"==typeof g&&g?(g=g.replace(k,"").replace(l,""),d.JSON&&
JSON.parse?JSON.parse(g):a.test(g.replace(b,"@").replace(h,"]").replace(e,""))?(new Function("return "+g))():void 0):null}}).call(h,function(){return this}())},function(f,h,d){function a(a,b,c){this.io=a;this.nsp=b;this.json=this;this.ids=0;this.acks={};this.receiveBuffer=[];this.sendBuffer=[];this.connected=!1;this.disconnected=!0;c&&c.query&&(this.query=c.query);this.io.autoConnect&&this.open()}$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbolIterator();var b="function"==typeof Symbol&&
"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbol();return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},n=d(7);h=d(8);var e=d(40),k=d(41),l=d(42),g=d(3)("socket.io-client:socket"),c=d(31);f.exports=a;var m={connect:1,connect_error:1,connect_timeout:1,connecting:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1,
ping:1,pong:1},t=h.prototype.emit;h(a.prototype);a.prototype.subEvents=function(){if(!this.subs){var a=this.io;this.subs=[k(a,"open",l(this,"onopen")),k(a,"packet",l(this,"onpacket")),k(a,"close",l(this,"onclose"))]}};a.prototype.open=a.prototype.connect=function(){return this.connected?this:(this.subEvents(),this.io.open(),"open"===this.io.readyState&&this.onopen(),this.emit("connecting"),this)};a.prototype.send=function(){var a=e(arguments);return a.unshift("message"),this.emit.apply(this,a),this};
a.prototype.emit=function(a){if(m.hasOwnProperty(a))return t.apply(this,arguments),this;var b=e(arguments),c={type:n.EVENT,data:b};return c.options={},c.options.compress=!this.flags||!1!==this.flags.compress,"function"==typeof b[b.length-1]&&(g("emitting packet with ack id %d",this.ids),this.acks[this.ids]=b.pop(),c.id=this.ids++),this.connected?this.packet(c):this.sendBuffer.push(c),delete this.flags,this};a.prototype.packet=function(a){a.nsp=this.nsp;this.io.packet(a)};a.prototype.onopen=function(){if(g("transport is open - connecting"),
"/"!==this.nsp)if(this.query){var a="object"===b(this.query)?c.encode(this.query):this.query;g("sending connect packet with query %s",a);this.packet({type:n.CONNECT,query:a})}else this.packet({type:n.CONNECT})};a.prototype.onclose=function(a){g("close (%s)",a);this.connected=!1;this.disconnected=!0;delete this.id;this.emit("disconnect",a)};a.prototype.onpacket=function(a){if(a.nsp===this.nsp)switch(a.type){case n.CONNECT:this.onconnect();break;case n.EVENT:this.onevent(a);break;case n.BINARY_EVENT:this.onevent(a);
break;case n.ACK:this.onack(a);break;case n.BINARY_ACK:this.onack(a);break;case n.DISCONNECT:this.ondisconnect();break;case n.ERROR:this.emit("error",a.data)}};a.prototype.onevent=function(a){var b=a.data||[];g("emitting event %j",b);null!=a.id&&(g("attaching ack callback to event"),b.push(this.ack(a.id)));this.connected?t.apply(this,b):this.receiveBuffer.push(b)};a.prototype.ack=function(a){var b=this,c=!1;return function(){if(!c){c=!0;var d=e(arguments);g("sending ack %j",d);b.packet({type:n.ACK,
id:a,data:d})}}};a.prototype.onack=function(a){var b=this.acks[a.id];"function"==typeof b?(g("calling ack %s with %j",a.id,a.data),b.apply(this,a.data),delete this.acks[a.id]):g("bad ack %s",a.id)};a.prototype.onconnect=function(){this.connected=!0;this.disconnected=!1;this.emit("connect");this.emitBuffered()};a.prototype.emitBuffered=function(){var a;for(a=0;a<this.receiveBuffer.length;a++)t.apply(this,this.receiveBuffer[a]);this.receiveBuffer=[];for(a=0;a<this.sendBuffer.length;a++)this.packet(this.sendBuffer[a]);
this.sendBuffer=[]};a.prototype.ondisconnect=function(){g("server disconnect (%s)",this.nsp);this.destroy();this.onclose("io server disconnect")};a.prototype.destroy=function(){if(this.subs){for(var a=0;a<this.subs.length;a++)this.subs[a].destroy();this.subs=null}this.io.destroy(this)};a.prototype.close=a.prototype.disconnect=function(){return this.connected&&(g("performing disconnect (%s)",this.nsp),this.packet({type:n.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),
this};a.prototype.compress=function(a){return this.flags=this.flags||{},this.flags.compress=a,this}},function(f,h){f.exports=function(d,a){for(var b=[],f=(a=a||0)||0;f<d.length;f++)b[f-a]=d[f];return b}},function(f,h){f.exports=function(d,a,b){return d.on(a,b),{destroy:function(){d.removeListener(a,b)}}}},function(f,h){var d=[].slice;f.exports=function(a,b){if("string"==typeof b&&(b=a[b]),"function"!=typeof b)throw Error("bind() requires a function");var f=d.call(arguments,2);return function(){return b.apply(a,
f.concat(d.call(arguments)))}}},function(f,h){function d(a){a=a||{};this.ms=a.min||100;this.max=a.max||1E4;this.factor=a.factor||2;this.jitter=0<a.jitter&&1>=a.jitter?a.jitter:0;this.attempts=0}f.exports=d;d.prototype.duration=function(){var a=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter)var b=Math.random(),d=Math.floor(b*this.jitter*a),a=0==(1&Math.floor(10*b))?a-d:a+d;return 0|Math.min(a,this.max)};d.prototype.reset=function(){this.attempts=0};d.prototype.setMin=function(a){this.ms=
a};d.prototype.setMax=function(a){this.max=a};d.prototype.setJitter=function(a){this.jitter=a}}])})},function(m,r,k){m=function(){return{getRandomValue:function(){var f=new Uint16Array(1);window.crypto.getRandomValues(f);return f[0]}}}();r.a=m},function(m,r,k){var f=k(5),h=k(23);r.a=function(d){var a=Object(f.a)({});a.id=d.id;a.stream=d.stream.stream;a.elementID=d.elementID;var b=function(){a.bar.display()},n=function(){a.bar.hide()};a.destroy=function(){a.video.pause();a.parentNode.removeChild(a.div)};
a.div=document.createElement("div");a.div.setAttribute("id","player_"+a.id);a.div.setAttribute("class","licode_player");a.div.setAttribute("style","width: 100%; height: 100%; position: relative; background-color: black; overflow: hidden;");!1!==d.options.loader&&(a.loader=document.createElement("img"),a.loader.setAttribute("style","width: 16px; height: 16px; position: absolute; top: 50%; left: 50%; margin-top: -8px; margin-left: -8px"),a.loader.setAttribute("id","back_"+a.id),a.loader.setAttribute("class",
"licode_loader"),a.loader.setAttribute("src",a.url+"/assets/loader.gif"));a.video=document.createElement("video");a.video.setAttribute("id","stream"+a.id);a.video.setAttribute("class","licode_stream");a.video.setAttribute("style","width: 100%; height: 100%; position: absolute; object-fit: cover");a.video.setAttribute("autoplay","autoplay");a.video.setAttribute("playsinline","playsinline");d.stream.local&&(a.video.volume=0);a.container=void 0!==a.elementID?"object"===typeof a.elementID&&"function"===
typeof a.elementID.appendChild?a.elementID:document.getElementById(a.elementID):document.body;a.container.appendChild(a.div);a.parentNode=a.div.parentNode;a.loader&&a.div.appendChild(a.loader);a.div.appendChild(a.video);a.containerWidth=0;a.containerHeight=0;!1!==d.options.bar?(a.bar=Object(h.a)({elementID:"player_"+a.id,id:a.id,stream:d.stream,media:a.video,options:d.options}),a.div.onmouseover=b,a.div.onmouseout=n):a.media=a.video;a.video.srcObject=a.stream;return a}},function(m,r,k){var f=k(5);
r.a=function(h){var d=Object(f.a)({}),a=50;d.elementID=h.elementID;d.media=h.media;d.id=h.id;d.stream=h.stream;d.div=document.createElement("div");d.div.setAttribute("style","width: 40%; height: 100%; max-width: 32px; position: absolute; right: 0;z-index:0;");d.icon=document.createElement("img");d.icon.setAttribute("id","volume_"+d.id);d.icon.setAttribute("src",d.url+"/assets/sound48.png");d.icon.setAttribute("style","width: 80%; height: 100%; position: absolute;");d.div.appendChild(d.icon);d.icon.onclick=
function(){d.media.muted?(d.media.muted=!1,d.icon.setAttribute("src",d.url+"/assets/sound48.png"),d.stream.local?d.stream.stream.getAudioTracks()[0].enabled=!0:(d.picker.value=a,d.media.volume=d.picker.value/100)):(d.media.muted=!0,d.icon.setAttribute("src",d.url+"/assets/mute48.png"),d.stream.local?d.stream.stream.getAudioTracks()[0].enabled=!1:(a=d.picker.value,d.picker.value=0,d.media.volume=0))};if(!d.stream.local){d.picker=document.createElement("input");d.picker.setAttribute("id","picker_"+
d.id);d.picker.type="range";d.picker.min=0;d.picker.max=100;d.picker.step=10;d.picker.value=a;d.picker.setAttribute("orient","vertical");d.div.appendChild(d.picker);d.media.volume=d.picker.value/100;d.media.muted=!1;d.picker.oninput=function(){0<d.picker.value?(d.media.muted=!1,d.icon.setAttribute("src",d.url+"/assets/sound48.png")):(d.media.muted=!0,d.icon.setAttribute("src",d.url+"/assets/mute48.png"));d.media.volume=d.picker.value/100};var b=function(a){d.picker.setAttribute("style","background: transparent; width: 32px;\n                                         height: 100px; position: absolute; bottom: 90%;\n                                         z-index: 1; right: 0px; -webkit-appearance: slider-vertical;\n                                         bottom: "+
d.div.offsetHeight+"px; display: "+a)};d.div.onmouseover=function(){b("block")};d.div.onmouseout=function(){b("none")};b("none")}document.getElementById(d.elementID).appendChild(d.div);return d}},function(m,r,k){var f=k(5),h=k(23);r.a=function(d){var a=Object(f.a)({});a.id=d.id;a.stream=d.stream.stream;a.elementID=d.elementID;a.audio=document.createElement("audio");a.audio.setAttribute("id","stream"+a.id);a.audio.setAttribute("class","licode_stream");a.audio.setAttribute("style","width: 100%; height: 100%; position: absolute");
a.audio.setAttribute("autoplay","autoplay");d.stream.local&&(a.audio.volume=0);if(void 0!==a.elementID){a.destroy=function(){a.audio.pause();a.parentNode.removeChild(a.div)};var b=function(){a.bar.display()};var n=function(){a.bar.hide()};a.div=document.createElement("div");a.div.setAttribute("id","player_"+a.id);a.div.setAttribute("class","licode_player");a.div.setAttribute("style","width: 100%; height: 100%; position: relative; overflow: hidden;");a.container="object"===typeof a.elementID&&"function"===
typeof a.elementID.appendChild?a.elementID:document.getElementById(a.elementID);a.container.appendChild(a.div);a.parentNode=a.div.parentNode;a.div.appendChild(a.audio);!1!==d.options.bar?(a.bar=Object(h.a)({elementID:"player_"+a.id,id:a.id,stream:d.stream,media:a.audio,options:d.options}),a.div.onmouseover=b,a.div.onmouseout=n):a.media=a.audio}else a.destroy=function(){a.audio.pause();a.parentNode.removeChild(a.audio)},document.body.appendChild(a.audio),a.parentNode=document.body;a.audio.srcObject=
a.stream;return a}},function(m,r,k){m=function(){for(var f,h,d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),a=[],b=0;b<d.length;b+=1)a[d[b]]=b;var n=function(){if(!f||h>=f.length)return-1;var a=f.charCodeAt(h)&255;h+=1;return a},e=function(){if(!f)return-1;for(;;){if(h>=f.length)return-1;var b=f.charAt(h);h+=1;if(a[b])return a[b];if("A"===b)return 0}},k=function(a){a=a.toString(16);1===a.length&&(a="0"+a);return unescape("%"+a)};return{encodeBase64:function(a){var b;
f=a;h=0;a="";var c=Array(3);var e=0;for(b=!1;!b&&-1!==(c[0]=n());)c[1]=n(),c[2]=n(),a+=d[c[0]>>2],-1!==c[1]?(a+=d[c[0]<<4&48|c[1]>>4],-1!==c[2]?(a+=d[c[1]<<2&60|c[2]>>6],a+=d[c[2]&63]):(a+=d[c[1]<<2&60],a+="\x3d",b=!0)):(a+=d[c[0]<<4&48],a+="\x3d",a+="\x3d",b=!0),e+=4,76<=e&&(a+="\n",e=0);return a},decodeBase64:function(a){var b;f=a;h=0;a="";var c=Array(4);for(b=!1;!b&&-1!==(c[0]=e())&&-1!==(c[1]=e());)c[2]=e(),c[3]=e(),a+=k(c[0]<<2&255|c[1]>>4),-1!==c[2]?(a+=k(c[1]<<4&255|c[2]>>2),-1!==c[3]?a+=k(c[2]<<
6&255|c[3]):b=!0):b=!0;return a}}}();r.a=m},function(m,r,k){(function(f){m.exports=f.adapter=k(51)}).call(r,k(50))},function(m,r){r=function(){return this}();try{r=r||Function("return this")()||(0,eval)("this")}catch(k){"object"===typeof window&&(r=window)}m.exports=r},function(m,r,k){m.exports=function(){return function(){function f(h,d,a){function b(e,l){if(!d[e]){if(!h[e]){if(n)return n(e,!0);l=Error("Cannot find module '"+e+"'");throw l.code="MODULE_NOT_FOUND",l;}l=d[e]={exports:{}};h[e][0].call(l.exports,
function(a){return b(h[e][1][a]||a)},l,l.exports,f,h,d,a)}return d[e].exports}for(var n=!1,e=0;e<a.length;e++)b(a[e]);return b}return f}()({1:[function(f,h,d){f=f("./adapter_factory.js");f=(0,f.adapterFactory)({window:window});h.exports=f},{"./adapter_factory.js":2}],2:[function(f,h,d){function a(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);b.default=a;return b}Object.defineProperty(d,"__esModule",{value:!0});d.adapterFactory=
function(){var a=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).window,d=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimEdge:!0,shimSafari:!0},f=b.log,h=b.detectBrowser(a),p={browserDetails:h,commonShim:g,extractVersion:b.extractVersion,disableLog:b.disableLog,disableWarnings:b.disableWarnings};switch(h.browser){case "chrome":if(!n||!n.shimPeerConnection||!d.shimChrome){f("Chrome shim is not included in this adapter release.");break}f("adapter.js shimming chrome.");
p.browserShim=n;n.shimGetUserMedia(a);n.shimMediaStream(a);n.shimPeerConnection(a);n.shimOnTrack(a);n.shimAddTrackRemoveTrack(a);n.shimGetSendersWithDtmf(a);n.shimGetStats(a);n.shimSenderReceiverGetStats(a);n.fixNegotiationNeeded(a);g.shimRTCIceCandidate(a);g.shimConnectionState(a);g.shimMaxMessageSize(a);g.shimSendThrowTypeError(a);g.removeAllowExtmapMixed(a);break;case "firefox":if(!k||!k.shimPeerConnection||!d.shimFirefox){f("Firefox shim is not included in this adapter release.");break}f("adapter.js shimming firefox.");
p.browserShim=k;k.shimGetUserMedia(a);k.shimPeerConnection(a);k.shimOnTrack(a);k.shimRemoveStream(a);k.shimSenderGetStats(a);k.shimReceiverGetStats(a);k.shimRTCDataChannel(a);g.shimRTCIceCandidate(a);g.shimConnectionState(a);g.shimMaxMessageSize(a);g.shimSendThrowTypeError(a);break;case "edge":if(!e||!e.shimPeerConnection||!d.shimEdge){f("MS edge shim is not included in this adapter release.");break}f("adapter.js shimming edge.");p.browserShim=e;e.shimGetUserMedia(a);e.shimGetDisplayMedia(a);e.shimPeerConnection(a);
e.shimReplaceTrack(a);g.shimMaxMessageSize(a);g.shimSendThrowTypeError(a);break;case "safari":if(!l||!d.shimSafari){f("Safari shim is not included in this adapter release.");break}f("adapter.js shimming safari.");p.browserShim=l;l.shimRTCIceServerUrls(a);l.shimCreateOfferLegacy(a);l.shimCallbacksAPI(a);l.shimLocalStreamsAPI(a);l.shimRemoteStreamsAPI(a);l.shimTrackEventTransceiver(a);l.shimGetUserMedia(a);g.shimRTCIceCandidate(a);g.shimMaxMessageSize(a);g.shimSendThrowTypeError(a);g.removeAllowExtmapMixed(a);
break;default:f("Unsupported browser!")}return p};h=f("./utils");var b=a(h);h=f("./chrome/chrome_shim");var n=a(h);h=f("./edge/edge_shim");var e=a(h);h=f("./firefox/firefox_shim");var k=a(h);h=f("./safari/safari_shim");var l=a(h);f=f("./common_shim");var g=a(f)},{"./chrome/chrome_shim":3,"./common_shim":6,"./edge/edge_shim":7,"./firefox/firefox_shim":11,"./safari/safari_shim":14,"./utils":15}],3:[function(f,h,d){function a(a,b,e){b in a?Object.defineProperty(a,b,{value:e,enumerable:!0,configurable:!0,
writable:!0}):a[b]=e;return a}function b(a){a.RTCPeerConnection.prototype.getLocalStreams=function(){var a=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{};return Object.keys(this._shimmedLocalStreams).map(function(b){return a._shimmedLocalStreams[b][0]})};var b=a.RTCPeerConnection.prototype.addTrack;a.RTCPeerConnection.prototype.addTrack=function(a,c){if(!c)return b.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};var g=b.apply(this,arguments);this._shimmedLocalStreams[c.id]?
-1===this._shimmedLocalStreams[c.id].indexOf(g)&&this._shimmedLocalStreams[c.id].push(g):this._shimmedLocalStreams[c.id]=[c,g];return g};var g=a.RTCPeerConnection.prototype.addStream;a.RTCPeerConnection.prototype.addStream=function(a){var b=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{};a.getTracks().forEach(function(a){if(b.getSenders().find(function(b){return b.track===a}))throw new DOMException("Track already exists.","InvalidAccessError");});var c=this.getSenders();g.apply(this,
arguments);var e=this.getSenders().filter(function(a){return-1===c.indexOf(a)});this._shimmedLocalStreams[a.id]=[a].concat(e)};var e=a.RTCPeerConnection.prototype.removeStream;a.RTCPeerConnection.prototype.removeStream=function(a){this._shimmedLocalStreams=this._shimmedLocalStreams||{};delete this._shimmedLocalStreams[a.id];return e.apply(this,arguments)};var d=a.RTCPeerConnection.prototype.removeTrack;a.RTCPeerConnection.prototype.removeTrack=function(a){var b=this;this._shimmedLocalStreams=this._shimmedLocalStreams||
{};a&&Object.keys(this._shimmedLocalStreams).forEach(function(c){var g=b._shimmedLocalStreams[c].indexOf(a);-1!==g&&b._shimmedLocalStreams[c].splice(g,1);1===b._shimmedLocalStreams[c].length&&delete b._shimmedLocalStreams[c]});return d.apply(this,arguments)}}Object.defineProperty(d,"__esModule",{value:!0});d.shimGetDisplayMedia=d.shimGetUserMedia=void 0;$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbolIterator();var n="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(a){return typeof a}:
function(a){$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbol();return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},e=f("./getusermedia");Object.defineProperty(d,"shimGetUserMedia",{enumerable:!0,get:function(){return e.shimGetUserMedia}});var k=f("./getdisplaymedia");Object.defineProperty(d,"shimGetDisplayMedia",{enumerable:!0,get:function(){return k.shimGetDisplayMedia}});d.shimMediaStream=function(a){a.MediaStream=a.MediaStream||a.webkitMediaStream};
d.shimOnTrack=function(a){if("object"!==("undefined"===typeof a?"undefined":n(a))||!a.RTCPeerConnection||"ontrack"in a.RTCPeerConnection.prototype)l.wrapPeerConnectionEvent(a,"track",function(a){a.transceiver||Object.defineProperty(a,"transceiver",{value:{receiver:a.receiver}});return a});else{Object.defineProperty(a.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(a){this._ontrack&&this.removeEventListener("track",this._ontrack);this.addEventListener("track",
this._ontrack=a)},enumerable:!0,configurable:!0});var b=a.RTCPeerConnection.prototype.setRemoteDescription;a.RTCPeerConnection.prototype.setRemoteDescription=function(){var c=this;this._ontrackpoly||(this._ontrackpoly=function(b){b.stream.addEventListener("addtrack",function(g){var e=void 0,e=a.RTCPeerConnection.prototype.getReceivers?c.getReceivers().find(function(a){return a.track&&a.track.id===g.track.id}):{track:g.track},d=new Event("track");d.track=g.track;d.receiver=e;d.transceiver={receiver:e};
d.streams=[b.stream];c.dispatchEvent(d)});b.stream.getTracks().forEach(function(g){var e=void 0,e=a.RTCPeerConnection.prototype.getReceivers?c.getReceivers().find(function(a){return a.track&&a.track.id===g.id}):{track:g},d=new Event("track");d.track=g;d.receiver=e;d.transceiver={receiver:e};d.streams=[b.stream];c.dispatchEvent(d)})},this.addEventListener("addstream",this._ontrackpoly));return b.apply(this,arguments)}}};d.shimGetSendersWithDtmf=function(a){if("object"===("undefined"===typeof a?"undefined":
n(a))&&a.RTCPeerConnection&&!("getSenders"in a.RTCPeerConnection.prototype)&&"createDTMFSender"in a.RTCPeerConnection.prototype){var b=function(a,b){return{track:b,get dtmf(){void 0===this._dtmf&&(this._dtmf="audio"===b.kind?a.createDTMFSender(b):null);return this._dtmf},_pc:a}};if(!a.RTCPeerConnection.prototype.getSenders){a.RTCPeerConnection.prototype.getSenders=function(){this._senders=this._senders||[];return this._senders.slice()};var e=a.RTCPeerConnection.prototype.addTrack;a.RTCPeerConnection.prototype.addTrack=
function(a,c){var g=e.apply(this,arguments);g||(g=b(this,a),this._senders.push(g));return g};var g=a.RTCPeerConnection.prototype.removeTrack;a.RTCPeerConnection.prototype.removeTrack=function(a){g.apply(this,arguments);var b=this._senders.indexOf(a);-1!==b&&this._senders.splice(b,1)}}var d=a.RTCPeerConnection.prototype.addStream;a.RTCPeerConnection.prototype.addStream=function(a){var c=this;this._senders=this._senders||[];d.apply(this,[a]);a.getTracks().forEach(function(a){c._senders.push(b(c,a))})};
var f=a.RTCPeerConnection.prototype.removeStream;a.RTCPeerConnection.prototype.removeStream=function(a){var b=this;this._senders=this._senders||[];f.apply(this,[a]);a.getTracks().forEach(function(a){var c=b._senders.find(function(b){return b.track===a});c&&b._senders.splice(b._senders.indexOf(c),1)})}}else if("object"===("undefined"===typeof a?"undefined":n(a))&&a.RTCPeerConnection&&"getSenders"in a.RTCPeerConnection.prototype&&"createDTMFSender"in a.RTCPeerConnection.prototype&&a.RTCRtpSender&&!("dtmf"in
a.RTCRtpSender.prototype)){var h=a.RTCPeerConnection.prototype.getSenders;a.RTCPeerConnection.prototype.getSenders=function(){var a=this,b=h.apply(this,[]);b.forEach(function(b){return b._pc=a});return b};Object.defineProperty(a.RTCRtpSender.prototype,"dtmf",{get:function(){void 0===this._dtmf&&(this._dtmf="audio"===this.track.kind?this._pc.createDTMFSender(this.track):null);return this._dtmf}})}};d.shimGetStats=function(a){if(a.RTCPeerConnection){var b=a.RTCPeerConnection.prototype.getStats;a.RTCPeerConnection.prototype.getStats=
function(){var a=this,c=Array.prototype.slice.call(arguments),e=c[0],g=c[1],c=c[2];if(0<arguments.length&&"function"===typeof e)return b.apply(this,arguments);if(0===b.length&&(0===arguments.length||"function"!==typeof e))return b.apply(this,[]);var d=function(a){var b={};a.result().forEach(function(a){var c={id:a.id,timestamp:a.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[a.type]||a.type};a.names().forEach(function(b){c[b]=a.stat(b)});b[c.id]=c});return b},
f=function(a){return new Map(Object.keys(a).map(function(b){return[b,a[b]]}))};return 2<=arguments.length?b.apply(this,[function(a){g(f(d(a)))},e]):(new Promise(function(c,e){b.apply(a,[function(a){c(f(d(a)))},e])})).then(g,c)}}};d.shimSenderReceiverGetStats=function(a){if("object"===("undefined"===typeof a?"undefined":n(a))&&a.RTCPeerConnection&&a.RTCRtpSender&&a.RTCRtpReceiver){if(!("getStats"in a.RTCRtpSender.prototype)){var b=a.RTCPeerConnection.prototype.getSenders;b&&(a.RTCPeerConnection.prototype.getSenders=
function(){var a=this,c=b.apply(this,[]);c.forEach(function(b){return b._pc=a});return c});var e=a.RTCPeerConnection.prototype.addTrack;e&&(a.RTCPeerConnection.prototype.addTrack=function(){var a=e.apply(this,arguments);a._pc=this;return a});a.RTCRtpSender.prototype.getStats=function(){var a=this;return this._pc.getStats().then(function(b){return l.filterStats(b,a.track,!0)})}}if(!("getStats"in a.RTCRtpReceiver.prototype)){var g=a.RTCPeerConnection.prototype.getReceivers;g&&(a.RTCPeerConnection.prototype.getReceivers=
function(){var a=this,b=g.apply(this,[]);b.forEach(function(b){return b._pc=a});return b});l.wrapPeerConnectionEvent(a,"track",function(a){a.receiver._pc=a.srcElement;return a});a.RTCRtpReceiver.prototype.getStats=function(){var a=this;return this._pc.getStats().then(function(b){return l.filterStats(b,a.track,!1)})}}if("getStats"in a.RTCRtpSender.prototype&&"getStats"in a.RTCRtpReceiver.prototype){var d=a.RTCPeerConnection.prototype.getStats;a.RTCPeerConnection.prototype.getStats=function(){if(0<
arguments.length&&arguments[0]instanceof a.MediaStreamTrack){var b=arguments[0],c=void 0,e=void 0,g=void 0;this.getSenders().forEach(function(a){a.track===b&&(c?g=!0:c=a)});this.getReceivers().forEach(function(a){a.track===b&&(e?g=!0:e=a);return a.track===b});return g||c&&e?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):c?c.getStats():e?e.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return d.apply(this,
arguments)}}}};d.shimAddTrackRemoveTrackWithNative=b;d.shimAddTrackRemoveTrack=function(e){function c(a,b){var c=b.sdp;Object.keys(a._reverseStreams||[]).forEach(function(b){b=a._reverseStreams[b];c=c.replace(new RegExp(a._streams[b.id].id,"g"),b.id)});return new RTCSessionDescription({type:b.type,sdp:c})}function g(a,b){var c=b.sdp;Object.keys(a._reverseStreams||[]).forEach(function(b){b=a._reverseStreams[b];c=c.replace(new RegExp(b.id,"g"),a._streams[b.id].id)});return new RTCSessionDescription({type:b.type,
sdp:c})}if(e.RTCPeerConnection){var d=l.detectBrowser(e);if(e.RTCPeerConnection.prototype.addTrack&&65<=d.version)return b(e);var f=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){var a=this,b=f.apply(this);this._reverseStreams=this._reverseStreams||{};return b.map(function(b){return a._reverseStreams[b.id]})};var h=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(a){var b=this;this._streams=this._streams||
{};this._reverseStreams=this._reverseStreams||{};a.getTracks().forEach(function(a){if(b.getSenders().find(function(b){return b.track===a}))throw new DOMException("Track already exists.","InvalidAccessError");});if(!this._reverseStreams[a.id]){var c=new e.MediaStream(a.getTracks());this._streams[a.id]=c;this._reverseStreams[c.id]=a;a=c}h.apply(this,[a])};var n=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(a){this._streams=this._streams||{};this._reverseStreams=
this._reverseStreams||{};n.apply(this,[this._streams[a.id]||a]);delete this._reverseStreams[this._streams[a.id]?this._streams[a.id].id:a.id];delete this._streams[a.id]};e.RTCPeerConnection.prototype.addTrack=function(a,b){var c=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");var g=[].slice.call(arguments,1);if(1!==g.length||!g[0].getTracks().find(function(b){return b===a}))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.",
"NotSupportedError");if(this.getSenders().find(function(b){return b.track===a}))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{};this._reverseStreams=this._reverseStreams||{};(g=this._streams[b.id])?(g.addTrack(a),Promise.resolve().then(function(){c.dispatchEvent(new Event("negotiationneeded"))})):(g=new e.MediaStream([a]),this._streams[b.id]=g,this._reverseStreams[g.id]=b,this.addStream(g));return this.getSenders().find(function(b){return b.track===
a})};["createOffer","createAnswer"].forEach(function(b){var g=e.RTCPeerConnection.prototype[b],d=a({},b,function(){var a=this,b=arguments;return arguments.length&&"function"===typeof arguments[0]?g.apply(this,[function(e){e=c(a,e);b[0].apply(null,[e])},function(a){b[1]&&b[1].apply(null,a)},arguments[2]]):g.apply(this,arguments).then(function(b){return c(a,b)})});e.RTCPeerConnection.prototype[b]=d[b]});var k=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=
function(){if(!arguments.length||!arguments[0].type)return k.apply(this,arguments);arguments[0]=g(this,arguments[0]);return k.apply(this,arguments)};var p=Object.getOwnPropertyDescriptor(e.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(e.RTCPeerConnection.prototype,"localDescription",{get:function(){var a=p.get.apply(this);return""===a.type?a:c(this,a)}});e.RTCPeerConnection.prototype.removeTrack=function(a){var b=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.",
"InvalidStateError");if(!a._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(a._pc!==this)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};var c=void 0;Object.keys(this._streams).forEach(function(e){b._streams[e].getTracks().find(function(b){return a.track===b})&&(c=b._streams[e])});c&&(1===c.getTracks().length?this.removeStream(this._reverseStreams[c.id]):
c.removeTrack(a.track),this.dispatchEvent(new Event("negotiationneeded")))}}};d.shimPeerConnection=function(b){var c=l.detectBrowser(b);!b.RTCPeerConnection&&b.webkitRTCPeerConnection&&(b.RTCPeerConnection=b.webkitRTCPeerConnection);if(b.RTCPeerConnection){53>c.version&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(c){var e=b.RTCPeerConnection.prototype[c],g=a({},c,function(){arguments[0]=new ("addIceCandidate"===c?b.RTCIceCandidate:b.RTCSessionDescription)(arguments[0]);
return e.apply(this,arguments)});b.RTCPeerConnection.prototype[c]=g[c]});var e=b.RTCPeerConnection.prototype.addIceCandidate;b.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?78>c.version&&arguments[0]&&""===arguments[0].candidate?Promise.resolve():e.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}}};d.fixNegotiationNeeded=function(a){l.wrapPeerConnectionEvent(a,"negotiationneeded",function(a){if("stable"===a.target.signalingState)return a})};
var l=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var e in a)Object.prototype.hasOwnProperty.call(a,e)&&(b[e]=a[e]);b.default=a;return b}(f("../utils.js"))},{"../utils.js":15,"./getdisplaymedia":4,"./getusermedia":5}],4:[function(f,h,d){Object.defineProperty(d,"__esModule",{value:!0});d.shimGetDisplayMedia=function(a,b){a.navigator.mediaDevices&&"getDisplayMedia"in a.navigator.mediaDevices||!a.navigator.mediaDevices||("function"!==typeof b?console.error("shimGetDisplayMedia: getSourceId argument is not a function"):
a.navigator.mediaDevices.getDisplayMedia=function(d){return b(d).then(function(b){var e=d.video&&d.video.width,f=d.video&&d.video.height;d.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:b,maxFrameRate:d.video&&d.video.frameRate||3}};e&&(d.video.mandatory.maxWidth=e);f&&(d.video.mandatory.maxHeight=f);return a.navigator.mediaDevices.getUserMedia(d)})})}},{}],5:[function(f,h,d){Object.defineProperty(d,"__esModule",{value:!0});$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbolIterator();
var a="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(a){return typeof a}:function(a){$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbol();return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};d.shimGetUserMedia=function(e){var d=e&&e.navigator;if(d.mediaDevices){var f=b.detectBrowser(e),g=function(b){if("object"!==("undefined"===typeof b?"undefined":a(b))||b.mandatory||b.optional)return b;var c={};Object.keys(b).forEach(function(e){if("require"!==
e&&"advanced"!==e&&"mediaSource"!==e){var d="object"===a(b[e])?b[e]:{ideal:b[e]};void 0!==d.exact&&"number"===typeof d.exact&&(d.min=d.max=d.exact);var g=function(a,b){return a?a+b.charAt(0).toUpperCase()+b.slice(1):"deviceId"===b?"sourceId":b};if(void 0!==d.ideal){c.optional=c.optional||[];var f={};"number"===typeof d.ideal?(f[g("min",e)]=d.ideal,c.optional.push(f),f={},f[g("max",e)]=d.ideal):f[g("",e)]=d.ideal;c.optional.push(f)}void 0!==d.exact&&"number"!==typeof d.exact?(c.mandatory=c.mandatory||
{},c.mandatory[g("",e)]=d.exact):["min","max"].forEach(function(a){void 0!==d[a]&&(c.mandatory=c.mandatory||{},c.mandatory[g(a,e)]=d[a])})}});b.advanced&&(c.optional=(c.optional||[]).concat(b.advanced));return c},c=function(b,c){if(61<=f.version)return c(b);if((b=JSON.parse(JSON.stringify(b)))&&"object"===a(b.audio)){var e=function(a,b,c){b in a&&!(c in a)&&(a[c]=a[b],delete a[b])};b=JSON.parse(JSON.stringify(b));e(b.audio,"autoGainControl","googAutoGainControl");e(b.audio,"noiseSuppression","googNoiseSuppression");
b.audio=g(b.audio)}if(b&&"object"===a(b.video)){var h=b.video.facingMode,h=h&&("object"===("undefined"===typeof h?"undefined":a(h))?h:{ideal:h}),e=66>f.version;if(!(!h||"user"!==h.exact&&"environment"!==h.exact&&"user"!==h.ideal&&"environment"!==h.ideal||d.mediaDevices.getSupportedConstraints&&d.mediaDevices.getSupportedConstraints().facingMode&&!e)){delete b.video.facingMode;var l=void 0;if("environment"===h.exact||"environment"===h.ideal)l=["back","rear"];else if("user"===h.exact||"user"===h.ideal)l=
["front"];if(l)return d.mediaDevices.enumerateDevices().then(function(a){a=a.filter(function(a){return"videoinput"===a.kind});var e=a.find(function(a){return l.some(function(b){return a.label.toLowerCase().includes(b)})});!e&&a.length&&l.includes("back")&&(e=a[a.length-1]);e&&(b.video.deviceId=h.exact?{exact:e.deviceId}:{ideal:e.deviceId});b.video=g(b.video);k("chrome: "+JSON.stringify(b));return c(b)})}b.video=g(b.video)}k("chrome: "+JSON.stringify(b));return c(b)},h=function(a){return 64<=f.version?
a:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[a.name]||a.name,message:a.message,constraint:a.constraint||a.constraintName,
toString:function(){return this.name+(this.message&&": ")+this.message}}};d.getUserMedia=function(a,b,e){c(a,function(a){d.webkitGetUserMedia(a,b,function(a){e&&e(h(a))})})}.bind(d);if(d.mediaDevices.getUserMedia){var n=d.mediaDevices.getUserMedia.bind(d.mediaDevices);d.mediaDevices.getUserMedia=function(a){return c(a,function(a){return n(a).then(function(b){if(a.audio&&!b.getAudioTracks().length||a.video&&!b.getVideoTracks().length)throw b.getTracks().forEach(function(a){a.stop()}),new DOMException("",
"NotFoundError");return b},function(a){return Promise.reject(h(a))})})}}}};var b=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var e in a)Object.prototype.hasOwnProperty.call(a,e)&&(b[e]=a[e]);b.default=a;return b}(f("../utils.js")),k=b.log},{"../utils.js":15}],6:[function(f,h,d){Object.defineProperty(d,"__esModule",{value:!0});$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbolIterator();var a="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(a){return typeof a}:
function(a){$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbol();return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};d.shimRTCIceCandidate=function(e){if(e.RTCIceCandidate&&!(e.RTCIceCandidate&&"foundation"in e.RTCIceCandidate.prototype)){var d=e.RTCIceCandidate;e.RTCIceCandidate=function(e){"object"===("undefined"===typeof e?"undefined":a(e))&&e.candidate&&0===e.candidate.indexOf("a\x3d")&&(e=JSON.parse(JSON.stringify(e)),e.candidate=e.candidate.substr(2));
if(e.candidate&&e.candidate.length){var g=new d(e);e=b.default.parseCandidate(e.candidate);var c=Object.assign(g,e);c.toJSON=function(){return{candidate:c.candidate,sdpMid:c.sdpMid,sdpMLineIndex:c.sdpMLineIndex,usernameFragment:c.usernameFragment}};return c}return new d(e)};e.RTCIceCandidate.prototype=d.prototype;k.wrapPeerConnectionEvent(e,"icecandidate",function(a){a.candidate&&Object.defineProperty(a,"candidate",{value:new e.RTCIceCandidate(a.candidate),writable:"false"});return a})}};d.shimMaxMessageSize=
function(a){if(a.RTCPeerConnection){var e=k.detectBrowser(a);"sctp"in a.RTCPeerConnection.prototype||Object.defineProperty(a.RTCPeerConnection.prototype,"sctp",{get:function(){return"undefined"===typeof this._sctp?null:this._sctp}});var d=function(a){if(!a||!a.sdp)return!1;a=b.default.splitSections(a.sdp);a.shift();return a.some(function(a){return(a=b.default.parseMLine(a))&&"application"===a.kind&&-1!==a.protocol.indexOf("SCTP")})},g=function(a){a=a.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===
a||2>a.length)return-1;a=parseInt(a[1],10);return a!==a?-1:a},c=function(a){var b=65536;"firefox"===e.browser&&(b=57>e.version?-1===a?16384:2147483637:60>e.version?57===e.version?65535:65536:2147483637);return b},f=function(a,c){var d=65536;"firefox"===e.browser&&57===e.version&&(d=65535);a=b.default.matchPrefix(a.sdp,"a\x3dmax-message-size:");0<a.length?d=parseInt(a[0].substr(19),10):"firefox"===e.browser&&-1!==c&&(d=2147483637);return d},h=a.RTCPeerConnection.prototype.setRemoteDescription;a.RTCPeerConnection.prototype.setRemoteDescription=
function(){this._sctp=null;"chrome"===e.browser&&76<=e.version&&"plan-b"===this.getConfiguration().sdpSemantics&&Object.defineProperty(this,"sctp",{get:function(){return"undefined"===typeof this._sctp?null:this._sctp},enumerable:!0,configurable:!0});if(d(arguments[0])){var a=g(arguments[0]),b=c(a),a=f(arguments[0],a),l=void 0,l=0===b&&0===a?Number.POSITIVE_INFINITY:0===b||0===a?Math.max(b,a):Math.min(b,a),b={};Object.defineProperty(b,"maxMessageSize",{get:function(){return l}});this._sctp=b}return h.apply(this,
arguments)}}};d.shimSendThrowTypeError=function(a){function b(a,b){var c=a.send;a.send=function(){var e=arguments[0],e=e.length||e.size||e.byteLength;if("open"===a.readyState&&b.sctp&&e>b.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+b.sctp.maxMessageSize+" bytes)");return c.apply(a,arguments)}}if(a.RTCPeerConnection&&"createDataChannel"in a.RTCPeerConnection.prototype){var e=a.RTCPeerConnection.prototype.createDataChannel;a.RTCPeerConnection.prototype.createDataChannel=
function(){var a=e.apply(this,arguments);b(a,this);return a};k.wrapPeerConnectionEvent(a,"datachannel",function(a){b(a.channel,a.target);return a})}};d.shimConnectionState=function(a){if(a.RTCPeerConnection&&!("connectionState"in a.RTCPeerConnection.prototype)){var b=a.RTCPeerConnection.prototype;Object.defineProperty(b,"connectionState",{get:function(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0});Object.defineProperty(b,
"onconnectionstatechange",{get:function(){return this._onconnectionstatechange||null},set:function(a){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange);a&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=a)},enumerable:!0,configurable:!0});["setLocalDescription","setRemoteDescription"].forEach(function(a){var e=b[a];b[a]=function(){this._connectionstatechangepoly||(this._connectionstatechangepoly=
function(a){var b=a.target;if(b._lastConnectionState!==b.connectionState){b._lastConnectionState=b.connectionState;var c=new Event("connectionstatechange",a);b.dispatchEvent(c)}return a},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly));return e.apply(this,arguments)}})}};d.removeAllowExtmapMixed=function(a){if(a.RTCPeerConnection){var b=k.detectBrowser(a);if(!("chrome"===b.browser&&71<=b.version)){var e=a.RTCPeerConnection.prototype.setRemoteDescription;a.RTCPeerConnection.prototype.setRemoteDescription=
function(a){a&&a.sdp&&-1!==a.sdp.indexOf("\na\x3dextmap-allow-mixed")&&(a.sdp=a.sdp.split("\n").filter(function(a){return"a\x3dextmap-allow-mixed"!==a.trim()}).join("\n"));return e.apply(this,arguments)}}}};var b=(h=f("sdp"))&&h.__esModule?h:{default:h},k=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var e in a)Object.prototype.hasOwnProperty.call(a,e)&&(b[e]=a[e]);b.default=a;return b}(f("./utils"))},{"./utils":15,sdp:17}],7:[function(f,h,d){Object.defineProperty(d,"__esModule",
{value:!0});d.shimGetDisplayMedia=d.shimGetUserMedia=void 0;var a=f("./getusermedia");Object.defineProperty(d,"shimGetUserMedia",{enumerable:!0,get:function(){return a.shimGetUserMedia}});var b=f("./getdisplaymedia");Object.defineProperty(d,"shimGetDisplayMedia",{enumerable:!0,get:function(){return b.shimGetDisplayMedia}});d.shimPeerConnection=function(a){var b=k.detectBrowser(a);if(a.RTCIceGatherer&&(a.RTCIceCandidate||(a.RTCIceCandidate=function(a){return a}),a.RTCSessionDescription||(a.RTCSessionDescription=
function(a){return a}),15025>b.version)){var c=Object.getOwnPropertyDescriptor(a.MediaStreamTrack.prototype,"enabled");Object.defineProperty(a.MediaStreamTrack.prototype,"enabled",{set:function(a){c.set.call(this,a);var b=new Event("enabled");b.enabled=a;this.dispatchEvent(b)}})}!a.RTCRtpSender||"dtmf"in a.RTCRtpSender.prototype||Object.defineProperty(a.RTCRtpSender.prototype,"dtmf",{get:function(){void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=new a.RTCDtmfSender(this):"video"===this.track.kind&&
(this._dtmf=null));return this._dtmf}});a.RTCDtmfSender&&!a.RTCDTMFSender&&(a.RTCDTMFSender=a.RTCDtmfSender);var d=(0,p.default)(a,b.version);a.RTCPeerConnection=function(a){a&&a.iceServers&&(a.iceServers=(0,e.filterIceServers)(a.iceServers,b.version),k.log("ICE servers after filtering:",a.iceServers));return new d(a)};a.RTCPeerConnection.prototype=d.prototype};d.shimReplaceTrack=function(a){!a.RTCRtpSender||"replaceTrack"in a.RTCRtpSender.prototype||(a.RTCRtpSender.prototype.replaceTrack=a.RTCRtpSender.prototype.setTrack)};
var k=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);b.default=a;return b}(f("../utils")),e=f("./filtericeservers"),p=(f=f("rtcpeerconnection-shim"))&&f.__esModule?f:{default:f}},{"../utils":15,"./filtericeservers":8,"./getdisplaymedia":9,"./getusermedia":10,"rtcpeerconnection-shim":16}],8:[function(f,h,d){Object.defineProperty(d,"__esModule",{value:!0});d.filterIceServers=function(b,d){var e=!1;b=JSON.parse(JSON.stringify(b));
return b.filter(function(b){if(b&&(b.urls||b.url)){var d=b.urls||b.url;b.url&&!b.urls&&a.deprecated("RTCIceServer.url","RTCIceServer.urls");var g="string"===typeof d;g&&(d=[d]);d=d.filter(function(a){return 0===a.indexOf("stun:")?!1:(a=a.startsWith("turn")&&!a.startsWith("turn:[")&&a.includes("transport\x3dudp"))&&!e?e=!0:a&&!e});delete b.url;b.urls=g?d[0]:d;return!!d.length}})};var a=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var e in a)Object.prototype.hasOwnProperty.call(a,
e)&&(b[e]=a[e]);b.default=a;return b}(f("../utils"))},{"../utils":15}],9:[function(f,h,d){Object.defineProperty(d,"__esModule",{value:!0});d.shimGetDisplayMedia=function(a){"getDisplayMedia"in a.navigator&&a.navigator.mediaDevices&&!(a.navigator.mediaDevices&&"getDisplayMedia"in a.navigator.mediaDevices)&&(a.navigator.mediaDevices.getDisplayMedia=a.navigator.getDisplayMedia.bind(a.navigator))}},{}],10:[function(f,h,d){Object.defineProperty(d,"__esModule",{value:!0});d.shimGetUserMedia=function(a){a=
a&&a.navigator;var b=function(a){return{name:{PermissionDeniedError:"NotAllowedError"}[a.name]||a.name,message:a.message,constraint:a.constraint,toString:function(){return this.name}}},d=a.mediaDevices.getUserMedia.bind(a.mediaDevices);a.mediaDevices.getUserMedia=function(a){return d(a).catch(function(a){return Promise.reject(b(a))})}}},{}],11:[function(f,h,d){function a(a,b,c){b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c;return a}Object.defineProperty(d,
"__esModule",{value:!0});d.shimGetDisplayMedia=d.shimGetUserMedia=void 0;$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbolIterator();var b="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(a){return typeof a}:function(a){$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbol();return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},k=f("./getusermedia");Object.defineProperty(d,"shimGetUserMedia",{enumerable:!0,get:function(){return k.shimGetUserMedia}});
var e=f("./getdisplaymedia");Object.defineProperty(d,"shimGetDisplayMedia",{enumerable:!0,get:function(){return e.shimGetDisplayMedia}});d.shimOnTrack=function(a){"object"===("undefined"===typeof a?"undefined":b(a))&&a.RTCTrackEvent&&"receiver"in a.RTCTrackEvent.prototype&&!("transceiver"in a.RTCTrackEvent.prototype)&&Object.defineProperty(a.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})};d.shimPeerConnection=function(e){var d=p.detectBrowser(e);if("object"===
("undefined"===typeof e?"undefined":b(e))&&(e.RTCPeerConnection||e.mozRTCPeerConnection)){!e.RTCPeerConnection&&e.mozRTCPeerConnection&&(e.RTCPeerConnection=e.mozRTCPeerConnection);53>d.version&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(b){var c=e.RTCPeerConnection.prototype[b],d=a({},b,function(){arguments[0]=new ("addIceCandidate"===b?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]);return c.apply(this,arguments)});e.RTCPeerConnection.prototype[b]=
d[b]});if(68>d.version){var c=e.RTCPeerConnection.prototype.addIceCandidate;e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?arguments[0]&&""===arguments[0].candidate?Promise.resolve():c.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}}var f={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},h=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=
function(){var a=Array.prototype.slice.call(arguments),b=a[1],c=a[2];return h.apply(this,[a[0]||null]).then(function(a){if(53>d.version&&!b)try{a.forEach(function(a){a.type=f[a.type]||a.type})}catch(v){if("TypeError"!==v.name)throw v;a.forEach(function(b,c){a.set(c,Object.assign({},b,{type:f[b.type]||b.type}))})}return a}).then(b,c)}}};d.shimSenderGetStats=function(a){if("object"===("undefined"===typeof a?"undefined":b(a))&&a.RTCPeerConnection&&a.RTCRtpSender&&!(a.RTCRtpSender&&"getStats"in a.RTCRtpSender.prototype)){var e=
a.RTCPeerConnection.prototype.getSenders;e&&(a.RTCPeerConnection.prototype.getSenders=function(){var a=this,b=e.apply(this,[]);b.forEach(function(b){return b._pc=a});return b});var c=a.RTCPeerConnection.prototype.addTrack;c&&(a.RTCPeerConnection.prototype.addTrack=function(){var a=c.apply(this,arguments);a._pc=this;return a});a.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}};d.shimReceiverGetStats=function(a){if("object"===("undefined"===
typeof a?"undefined":b(a))&&a.RTCPeerConnection&&a.RTCRtpSender&&!(a.RTCRtpSender&&"getStats"in a.RTCRtpReceiver.prototype)){var e=a.RTCPeerConnection.prototype.getReceivers;e&&(a.RTCPeerConnection.prototype.getReceivers=function(){var a=this,b=e.apply(this,[]);b.forEach(function(b){return b._pc=a});return b});p.wrapPeerConnectionEvent(a,"track",function(a){a.receiver._pc=a.srcElement;return a});a.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}};d.shimRemoveStream=
function(a){!a.RTCPeerConnection||"removeStream"in a.RTCPeerConnection.prototype||(a.RTCPeerConnection.prototype.removeStream=function(a){var b=this;p.deprecated("removeStream","removeTrack");this.getSenders().forEach(function(c){c.track&&a.getTracks().includes(c.track)&&b.removeTrack(c)})})};d.shimRTCDataChannel=function(a){a.DataChannel&&!a.RTCDataChannel&&(a.RTCDataChannel=a.DataChannel)};var p=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,
c)&&(b[c]=a[c]);b.default=a;return b}(f("../utils"))},{"../utils":15,"./getdisplaymedia":12,"./getusermedia":13}],12:[function(f,h,d){Object.defineProperty(d,"__esModule",{value:!0});d.shimGetDisplayMedia=function(a,b){a.navigator.mediaDevices&&"getDisplayMedia"in a.navigator.mediaDevices||!a.navigator.mediaDevices||(a.navigator.mediaDevices.getDisplayMedia=function(d){if(!d||!d.video)return d=new DOMException("getDisplayMedia without video constraints is undefined"),d.name="NotFoundError",d.code=
8,Promise.reject(d);!0===d.video?d.video={mediaSource:b}:d.video.mediaSource=b;return a.navigator.mediaDevices.getUserMedia(d)})}},{}],13:[function(f,h,d){Object.defineProperty(d,"__esModule",{value:!0});$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbolIterator();var a="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(a){return typeof a}:function(a){$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbol();return a&&"function"===typeof Symbol&&a.constructor===
Symbol&&a!==Symbol.prototype?"symbol":typeof a};d.shimGetUserMedia=function(d){var e=b.detectBrowser(d),f=d&&d.navigator;d=d&&d.MediaStreamTrack;f.getUserMedia=function(a,c,e){b.deprecated("navigator.getUserMedia","navigator.mediaDevices.getUserMedia");f.mediaDevices.getUserMedia(a).then(c,e)};if(!(55<e.version&&"autoGainControl"in f.mediaDevices.getSupportedConstraints())){var h=function(a,b,c){b in a&&!(c in a)&&(a[c]=a[b],delete a[b])},g=f.mediaDevices.getUserMedia.bind(f.mediaDevices);f.mediaDevices.getUserMedia=
function(b){"object"===("undefined"===typeof b?"undefined":a(b))&&"object"===a(b.audio)&&(b=JSON.parse(JSON.stringify(b)),h(b.audio,"autoGainControl","mozAutoGainControl"),h(b.audio,"noiseSuppression","mozNoiseSuppression"));return g(b)};if(d&&d.prototype.getSettings){var c=d.prototype.getSettings;d.prototype.getSettings=function(){var a=c.apply(this,arguments);h(a,"mozAutoGainControl","autoGainControl");h(a,"mozNoiseSuppression","noiseSuppression");return a}}if(d&&d.prototype.applyConstraints){var k=
d.prototype.applyConstraints;d.prototype.applyConstraints=function(b){"audio"===this.kind&&"object"===("undefined"===typeof b?"undefined":a(b))&&(b=JSON.parse(JSON.stringify(b)),h(b,"autoGainControl","mozAutoGainControl"),h(b,"noiseSuppression","mozNoiseSuppression"));return k.apply(this,[b])}}}};var b=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&(b[d]=a[d]);b.default=a;return b}(f("../utils"))},{"../utils":15}],14:[function(f,
h,d){function a(a){return a&&void 0!==a.video?Object.assign({},a,{video:k.compactObject(a.video)}):a}Object.defineProperty(d,"__esModule",{value:!0});$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbolIterator();var b="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(a){return typeof a}:function(a){$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbol();return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};d.shimLocalStreamsAPI=
function(a){if("object"===("undefined"===typeof a?"undefined":b(a))&&a.RTCPeerConnection){"getLocalStreams"in a.RTCPeerConnection.prototype||(a.RTCPeerConnection.prototype.getLocalStreams=function(){this._localStreams||(this._localStreams=[]);return this._localStreams});if(!("addStream"in a.RTCPeerConnection.prototype)){var e=a.RTCPeerConnection.prototype.addTrack;a.RTCPeerConnection.prototype.addStream=function(a){var b=this;this._localStreams||(this._localStreams=[]);this._localStreams.includes(a)||
this._localStreams.push(a);a.getAudioTracks().forEach(function(c){return e.call(b,c,a)});a.getVideoTracks().forEach(function(c){return e.call(b,c,a)})};a.RTCPeerConnection.prototype.addTrack=function(a){var b=arguments[1];b&&(this._localStreams?this._localStreams.includes(b)||this._localStreams.push(b):this._localStreams=[b]);return e.apply(this,arguments)}}"removeStream"in a.RTCPeerConnection.prototype||(a.RTCPeerConnection.prototype.removeStream=function(a){var b=this;this._localStreams||(this._localStreams=
[]);var c=this._localStreams.indexOf(a);if(-1!==c){this._localStreams.splice(c,1);var e=a.getTracks();this.getSenders().forEach(function(a){e.includes(a.track)&&b.removeTrack(a)})}})}};d.shimRemoteStreamsAPI=function(a){if("object"===("undefined"===typeof a?"undefined":b(a))&&a.RTCPeerConnection&&("getRemoteStreams"in a.RTCPeerConnection.prototype||(a.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in a.RTCPeerConnection.prototype))){Object.defineProperty(a.RTCPeerConnection.prototype,
"onaddstream",{get:function(){return this._onaddstream},set:function(a){var b=this;this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly));this.addEventListener("addstream",this._onaddstream=a);this.addEventListener("track",this._onaddstreampoly=function(a){a.streams.forEach(function(a){b._remoteStreams||(b._remoteStreams=[]);if(!b._remoteStreams.includes(a)){b._remoteStreams.push(a);var c=new Event("addstream");c.stream=
a;b.dispatchEvent(c)}})})}});var e=a.RTCPeerConnection.prototype.setRemoteDescription;a.RTCPeerConnection.prototype.setRemoteDescription=function(){var a=this;this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(b){b.streams.forEach(function(b){a._remoteStreams||(a._remoteStreams=[]);if(!(0<=a._remoteStreams.indexOf(b))){a._remoteStreams.push(b);var c=new Event("addstream");c.stream=b;a.dispatchEvent(c)}})});return e.apply(a,arguments)}}};d.shimCallbacksAPI=function(a){if("object"===
("undefined"===typeof a?"undefined":b(a))&&a.RTCPeerConnection){a=a.RTCPeerConnection.prototype;var d=a.createOffer,e=a.createAnswer,g=a.setLocalDescription,c=a.setRemoteDescription,f=a.addIceCandidate;a.createOffer=function(a,b){var c=d.apply(this,[2<=arguments.length?arguments[2]:arguments[0]]);if(!b)return c;c.then(a,b);return Promise.resolve()};a.createAnswer=function(a,b){var c=e.apply(this,[2<=arguments.length?arguments[2]:arguments[0]]);if(!b)return c;c.then(a,b);return Promise.resolve()};
var h=function(a,b,c){a=g.apply(this,[a]);if(!c)return a;a.then(b,c);return Promise.resolve()};a.setLocalDescription=h;h=function(a,b,d){a=c.apply(this,[a]);if(!d)return a;a.then(b,d);return Promise.resolve()};a.setRemoteDescription=h;h=function(a,b,c){a=f.apply(this,[a]);if(!c)return a;a.then(b,c);return Promise.resolve()};a.addIceCandidate=h}};d.shimGetUserMedia=function(b){var d=b&&b.navigator;if(d.mediaDevices&&d.mediaDevices.getUserMedia){b=d.mediaDevices;var e=b.getUserMedia.bind(b);d.mediaDevices.getUserMedia=
function(b){return e(a(b))}}!d.getUserMedia&&d.mediaDevices&&d.mediaDevices.getUserMedia&&(d.getUserMedia=function(a,b,e){d.mediaDevices.getUserMedia(a).then(b,e)}.bind(d))};d.shimConstraints=a;d.shimRTCIceServerUrls=function(a){var b=a.RTCPeerConnection;a.RTCPeerConnection=function(a,d){if(a&&a.iceServers){for(var c=[],e=0;e<a.iceServers.length;e++){var g=a.iceServers[e];!g.hasOwnProperty("urls")&&g.hasOwnProperty("url")?(k.deprecated("RTCIceServer.url","RTCIceServer.urls"),g=JSON.parse(JSON.stringify(g)),
g.urls=g.url,delete g.url,c.push(g)):c.push(a.iceServers[e])}a.iceServers=c}return new b(a,d)};a.RTCPeerConnection.prototype=b.prototype;"generateCertificate"in a.RTCPeerConnection&&Object.defineProperty(a.RTCPeerConnection,"generateCertificate",{get:function(){return b.generateCertificate}})};d.shimTrackEventTransceiver=function(a){"object"===("undefined"===typeof a?"undefined":b(a))&&a.RTCTrackEvent&&"receiver"in a.RTCTrackEvent.prototype&&!("transceiver"in a.RTCTrackEvent.prototype)&&Object.defineProperty(a.RTCTrackEvent.prototype,
"transceiver",{get:function(){return{receiver:this.receiver}}})};d.shimCreateOfferLegacy=function(a){var b=a.RTCPeerConnection.prototype.createOffer;a.RTCPeerConnection.prototype.createOffer=function(a){if(a){"undefined"!==typeof a.offerToReceiveAudio&&(a.offerToReceiveAudio=!!a.offerToReceiveAudio);var d=this.getTransceivers().find(function(a){return"audio"===a.receiver.track.kind});!1===a.offerToReceiveAudio&&d?"sendrecv"===d.direction?d.setDirection?d.setDirection("sendonly"):d.direction="sendonly":
"recvonly"===d.direction&&(d.setDirection?d.setDirection("inactive"):d.direction="inactive"):!0!==a.offerToReceiveAudio||d||this.addTransceiver("audio");"undefined"!==typeof a.offerToReceiveVideo&&(a.offerToReceiveVideo=!!a.offerToReceiveVideo);d=this.getTransceivers().find(function(a){return"video"===a.receiver.track.kind});!1===a.offerToReceiveVideo&&d?"sendrecv"===d.direction?d.setDirection?d.setDirection("sendonly"):d.direction="sendonly":"recvonly"===d.direction&&(d.setDirection?d.setDirection("inactive"):
d.direction="inactive"):!0!==a.offerToReceiveVideo||d||this.addTransceiver("video")}return b.apply(this,arguments)}};var k=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&(b[d]=a[d]);b.default=a;return b}(f("../utils"))},{"../utils":15}],15:[function(f,h,d){function a(a,b,d){b in a?Object.defineProperty(a,b,{value:d,enumerable:!0,configurable:!0,writable:!0}):a[b]=d;return a}function b(a,b,d){return(a=a.match(b))&&a.length>=d&&
parseInt(a[d],10)}function k(b){return"[object Object]"!==Object.prototype.toString.call(b)?b:Object.keys(b).reduce(function(c,d){var e="[object Object]"===Object.prototype.toString.call(b[d]),g=e?k(b[d]):b[d],e=e&&!Object.keys(g).length;return void 0===g||e?c:Object.assign(c,a({},d,g))},{})}function e(a,b,d){b&&!d.has(b.id)&&(d.set(b.id,b),Object.keys(b).forEach(function(c){c.endsWith("Id")?e(a,a.get(b[c]),d):c.endsWith("Ids")&&b[c].forEach(function(b){e(a,a.get(b),d)})}))}Object.defineProperty(d,
"__esModule",{value:!0});$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbolIterator();var m="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(a){return typeof a}:function(a){$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbol();return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};d.extractVersion=b;d.wrapPeerConnectionEvent=function(a,b,d){if(a.RTCPeerConnection){a=a.RTCPeerConnection.prototype;var c=a.addEventListener;
a.addEventListener=function(a,e){if(a!==b)return c.apply(this,arguments);var g=function(a){(a=d(a))&&e(a)};this._eventMap=this._eventMap||{};this._eventMap[e]=g;return c.apply(this,[a,g])};var e=a.removeEventListener;a.removeEventListener=function(a,c){if(a!==b||!this._eventMap||!this._eventMap[c])return e.apply(this,arguments);var d=this._eventMap[c];delete this._eventMap[c];return e.apply(this,[a,d])};Object.defineProperty(a,"on"+b,{get:function(){return this["_on"+b]},set:function(a){this["_on"+
b]&&(this.removeEventListener(b,this["_on"+b]),delete this["_on"+b]);a&&this.addEventListener(b,this["_on"+b]=a)},enumerable:!0,configurable:!0})}};d.disableLog=function(a){return"boolean"!==typeof a?Error("Argument type: "+("undefined"===typeof a?"undefined":m(a))+". Please use a boolean."):(l=a)?"adapter.js logging disabled":"adapter.js logging enabled"};d.disableWarnings=function(a){if("boolean"!==typeof a)return Error("Argument type: "+("undefined"===typeof a?"undefined":m(a))+". Please use a boolean.");
g=!a;return"adapter.js deprecation warnings "+(a?"disabled":"enabled")};d.log=function(){"object"!==("undefined"===typeof window?"undefined":m(window))||l||"undefined"!==typeof console&&"function"===typeof console.log&&console.log.apply(console,arguments)};d.deprecated=function(a,b){g&&console.warn(a+" is deprecated, please use "+b+" instead.")};d.detectBrowser=function(a){var c=a.navigator,d={browser:null,version:null};if("undefined"===typeof a||!a.navigator)return d.browser="Not a browser.",d;c.mozGetUserMedia?
(d.browser="firefox",d.version=b(c.userAgent,/Firefox\/(\d+)\./,1)):c.webkitGetUserMedia||!1===a.isSecureContext&&a.webkitRTCPeerConnection&&!a.RTCIceGatherer?(d.browser="chrome",d.version=b(c.userAgent,/Chrom(e|ium)\/(\d+)\./,2)):c.mediaDevices&&c.userAgent.match(/Edge\/(\d+).(\d+)$/)?(d.browser="edge",d.version=b(c.userAgent,/Edge\/(\d+).(\d+)$/,2)):a.RTCPeerConnection&&c.userAgent.match(/AppleWebKit\/(\d+)\./)?(d.browser="safari",d.version=b(c.userAgent,/AppleWebKit\/(\d+)\./,1),d.supportsUnifiedPlan=
a.RTCRtpTransceiver&&"currentDirection"in a.RTCRtpTransceiver.prototype):d.browser="Not a supported browser.";return d};d.compactObject=k;d.walkStats=e;d.filterStats=function(a,b,d){var c=d?"outbound-rtp":"inbound-rtp",g=new Map;if(null===b)return g;var f=[];a.forEach(function(a){"track"===a.type&&a.trackIdentifier===b.id&&f.push(a)});f.forEach(function(b){a.forEach(function(d){d.type===c&&d.trackId===b.id&&e(a,d,g)})});return g};var l=!0,g=!0},{}],16:[function(f,h,d){function a(a,b,d,e,f){b=g.writeRtpDescription(a.kind,
b);b+=g.writeIceParameters(a.iceGatherer.getLocalParameters());b+=g.writeDtlsParameters(a.dtlsTransport.getLocalParameters(),"offer"===d?"actpass":f||"active");b+="a\x3dmid:"+a.mid+"\r\n";b=a.rtpSender&&a.rtpReceiver?b+"a\x3dsendrecv\r\n":a.rtpSender?b+"a\x3dsendonly\r\n":a.rtpReceiver?b+"a\x3drecvonly\r\n":b+"a\x3dinactive\r\n";a.rtpSender&&(d=a.rtpSender._initialTrackId||a.rtpSender.track.id,a.rtpSender._initialTrackId=d,e="msid:"+(e?e.id:"-")+" "+d+"\r\n",b=b+("a\x3d"+e)+("a\x3dssrc:"+a.sendEncodingParameters[0].ssrc+
" "+e),a.sendEncodingParameters[0].rtx&&(b+="a\x3dssrc:"+a.sendEncodingParameters[0].rtx.ssrc+" "+e,b+="a\x3dssrc-group:FID "+a.sendEncodingParameters[0].ssrc+" "+a.sendEncodingParameters[0].rtx.ssrc+"\r\n"));b+="a\x3dssrc:"+a.sendEncodingParameters[0].ssrc+" cname:"+g.localCName+"\r\n";a.rtpSender&&a.sendEncodingParameters[0].rtx&&(b+="a\x3dssrc:"+a.sendEncodingParameters[0].rtx.ssrc+" cname:"+g.localCName+"\r\n");return b}function b(a,b){var c=!1;a=JSON.parse(JSON.stringify(a));return a.filter(function(a){if(a&&
(a.urls||a.url)){var d=a.urls||a.url;a.url&&!a.urls&&console.warn("RTCIceServer.url is deprecated! Use urls instead.");var e="string"===typeof d;e&&(d=[d]);d=d.filter(function(a){return 0!==a.indexOf("turn:")||-1===a.indexOf("transport\x3dudp")||-1!==a.indexOf("turn:[")||c?0===a.indexOf("stun:")&&14393<=b&&-1===a.indexOf("?transport\x3dudp"):c=!0});delete a.url;a.urls=e?d[0]:d;return!!d.length}})}function k(a,b){var c={codecs:[],headerExtensions:[],fecMechanisms:[]},d=function(a,b){a=parseInt(a,10);
for(var c=0;c<b.length;c++)if(b[c].payloadType===a||b[c].preferredPayloadType===a)return b[c]},e=function(a,b,c,e){a=d(a.parameters.apt,c);b=d(b.parameters.apt,e);return a&&b&&a.name.toLowerCase()===b.name.toLowerCase()};a.codecs.forEach(function(d){for(var g=0;g<b.codecs.length;g++){var f=b.codecs[g];if(d.name.toLowerCase()===f.name.toLowerCase()&&d.clockRate===f.clockRate&&("rtx"!==d.name.toLowerCase()||!d.parameters||!f.parameters.apt||e(d,f,a.codecs,b.codecs))){f=JSON.parse(JSON.stringify(f));
f.numChannels=Math.min(d.numChannels,f.numChannels);c.codecs.push(f);f.rtcpFeedback=f.rtcpFeedback.filter(function(a){for(var b=0;b<d.rtcpFeedback.length;b++)if(d.rtcpFeedback[b].type===a.type&&d.rtcpFeedback[b].parameter===a.parameter)return!0;return!1});break}}});a.headerExtensions.forEach(function(a){for(var d=0;d<b.headerExtensions.length;d++){var e=b.headerExtensions[d];if(a.uri===e.uri){c.headerExtensions.push(e);break}}});return c}function e(a,b,d){return-1!=={offer:{setLocalDescription:["stable",
"have-local-offer"],setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer","have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[b][a].indexOf(d)}function m(a,b){var c=a.getRemoteCandidates().find(function(a){return b.foundation===a.foundation&&b.ip===a.ip&&b.port===a.port&&b.priority===a.priority&&b.protocol===a.protocol&&b.type===a.type});c||a.addRemoteCandidate(b);return!c}function l(a,b){b=Error(b);b.name=a;b.code=
{NotSupportedError:9,InvalidStateError:11,InvalidAccessError:15,TypeError:void 0,OperationError:void 0}[a];return b}var g=f("sdp");h.exports=function(c,d){function f(a,b){b.addTrack(a);b.dispatchEvent(new c.MediaStreamTrackEvent("addtrack",{track:a}))}function h(a,b){b.removeTrack(a);b.dispatchEvent(new c.MediaStreamTrackEvent("removetrack",{track:a}))}function n(a,b,d,e){var g=new Event("track");g.track=b;g.receiver=d;g.transceiver={receiver:d};g.streams=e;c.setTimeout(function(){a._dispatchEvent("track",
g)})}var p=function(a){var e=this,f=document.createDocumentFragment();["addEventListener","removeEventListener","dispatchEvent"].forEach(function(a){e[a]=f[a].bind(f)});this.canTrickleIceCandidates=null;this.needNegotiation=!1;this.localStreams=[];this.remoteStreams=[];this._remoteDescription=this._localDescription=null;this.signalingState="stable";this.iceGatheringState=this.connectionState=this.iceConnectionState="new";a=JSON.parse(JSON.stringify(a||{}));this.usingBundle="max-bundle"===a.bundlePolicy;
if("negotiate"===a.rtcpMuxPolicy)throw l("NotSupportedError","rtcpMuxPolicy 'negotiate' is not supported");a.rtcpMuxPolicy||(a.rtcpMuxPolicy="require");switch(a.iceTransportPolicy){case "all":case "relay":break;default:a.iceTransportPolicy="all"}switch(a.bundlePolicy){case "balanced":case "max-compat":case "max-bundle":break;default:a.bundlePolicy="balanced"}a.iceServers=b(a.iceServers||[],d);this._iceGatherers=[];if(a.iceCandidatePoolSize)for(var h=a.iceCandidatePoolSize;0<h;h--)this._iceGatherers.push(new c.RTCIceGatherer({iceServers:a.iceServers,
gatherPolicy:a.iceTransportPolicy}));else a.iceCandidatePoolSize=0;this._config=a;this.transceivers=[];this._sdpSessionId=g.generateSessionId();this._sdpSessionVersion=0;this._dtlsRole=void 0;this._isClosed=!1};Object.defineProperty(p.prototype,"localDescription",{configurable:!0,get:function(){return this._localDescription}});Object.defineProperty(p.prototype,"remoteDescription",{configurable:!0,get:function(){return this._remoteDescription}});p.prototype.onicecandidate=null;p.prototype.onaddstream=
null;p.prototype.ontrack=null;p.prototype.onremovestream=null;p.prototype.onsignalingstatechange=null;p.prototype.oniceconnectionstatechange=null;p.prototype.onconnectionstatechange=null;p.prototype.onicegatheringstatechange=null;p.prototype.onnegotiationneeded=null;p.prototype.ondatachannel=null;p.prototype._dispatchEvent=function(a,b){if(!this._isClosed&&(this.dispatchEvent(b),"function"===typeof this["on"+a]))this["on"+a](b)};p.prototype._emitGatheringStateChange=function(){var a=new Event("icegatheringstatechange");
this._dispatchEvent("icegatheringstatechange",a)};p.prototype.getConfiguration=function(){return this._config};p.prototype.getLocalStreams=function(){return this.localStreams};p.prototype.getRemoteStreams=function(){return this.remoteStreams};p.prototype._createTransceiver=function(a,b){var c=0<this.transceivers.length;a={track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:a,mid:null,sendEncodingParameters:null,
recvEncodingParameters:null,stream:null,associatedRemoteMediaStreams:[],wantReceive:!0};this.usingBundle&&c?(a.iceTransport=this.transceivers[0].iceTransport,a.dtlsTransport=this.transceivers[0].dtlsTransport):(c=this._createIceAndDtlsTransports(),a.iceTransport=c.iceTransport,a.dtlsTransport=c.dtlsTransport);b||this.transceivers.push(a);return a};p.prototype.addTrack=function(a,b){if(this._isClosed)throw l("InvalidStateError","Attempted to call addTrack on a closed peerconnection.");if(this.transceivers.find(function(b){return b.track===
a}))throw l("InvalidAccessError","Track already exists.");for(var d,e=0;e<this.transceivers.length;e++)this.transceivers[e].track||this.transceivers[e].kind!==a.kind||(d=this.transceivers[e]);d||(d=this._createTransceiver(a.kind));this._maybeFireNegotiationNeeded();-1===this.localStreams.indexOf(b)&&this.localStreams.push(b);d.track=a;d.stream=b;d.rtpSender=new c.RTCRtpSender(a,d.dtlsTransport);return d.rtpSender};p.prototype.addStream=function(a){var b=this;if(15025<=d)a.getTracks().forEach(function(c){b.addTrack(c,
a)});else{var c=a.clone();a.getTracks().forEach(function(a,b){var d=c.getTracks()[b];a.addEventListener("enabled",function(a){d.enabled=a.enabled})});c.getTracks().forEach(function(a){b.addTrack(a,c)})}};p.prototype.removeTrack=function(a){if(this._isClosed)throw l("InvalidStateError","Attempted to call removeTrack on a closed peerconnection.");if(!(a instanceof c.RTCRtpSender))throw new TypeError("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.");var b=this.transceivers.find(function(b){return b.rtpSender===
a});if(!b)throw l("InvalidAccessError","Sender was not created by this connection.");var d=b.stream;b.rtpSender.stop();b.rtpSender=null;b.track=null;b.stream=null;-1===this.transceivers.map(function(a){return a.stream}).indexOf(d)&&-1<this.localStreams.indexOf(d)&&this.localStreams.splice(this.localStreams.indexOf(d),1);this._maybeFireNegotiationNeeded()};p.prototype.removeStream=function(a){var b=this;a.getTracks().forEach(function(a){var c=b.getSenders().find(function(b){return b.track===a});c&&
b.removeTrack(c)})};p.prototype.getSenders=function(){return this.transceivers.filter(function(a){return!!a.rtpSender}).map(function(a){return a.rtpSender})};p.prototype.getReceivers=function(){return this.transceivers.filter(function(a){return!!a.rtpReceiver}).map(function(a){return a.rtpReceiver})};p.prototype._createIceGatherer=function(a,b){var d=this;if(b&&0<a)return this.transceivers[0].iceGatherer;if(this._iceGatherers.length)return this._iceGatherers.shift();var e=new c.RTCIceGatherer({iceServers:this._config.iceServers,
gatherPolicy:this._config.iceTransportPolicy});Object.defineProperty(e,"state",{value:"new",writable:!0});this.transceivers[a].bufferedCandidateEvents=[];this.transceivers[a].bufferCandidates=function(b){var c=!b.candidate||0===Object.keys(b.candidate).length;e.state=c?"completed":"gathering";null!==d.transceivers[a].bufferedCandidateEvents&&d.transceivers[a].bufferedCandidateEvents.push(b)};e.addEventListener("localcandidate",this.transceivers[a].bufferCandidates);return e};p.prototype._gather=function(a,
b){var d=this,e=this.transceivers[b].iceGatherer;if(!e.onlocalcandidate){var f=this.transceivers[b].bufferedCandidateEvents;this.transceivers[b].bufferedCandidateEvents=null;e.removeEventListener("localcandidate",this.transceivers[b].bufferCandidates);e.onlocalcandidate=function(c){if(!(d.usingBundle&&0<b)){var f=new Event("icecandidate");f.candidate={sdpMid:a,sdpMLineIndex:b};var h=c.candidate;if(c=!h||0===Object.keys(h).length){if("new"===e.state||"gathering"===e.state)e.state="completed"}else"new"===
e.state&&(e.state="gathering"),h.component=1,h.ufrag=e.getLocalParameters().usernameFragment,h=g.writeCandidate(h),f.candidate=Object.assign(f.candidate,g.parseCandidate(h)),f.candidate.candidate=h,f.candidate.toJSON=function(){return{candidate:f.candidate.candidate,sdpMid:f.candidate.sdpMid,sdpMLineIndex:f.candidate.sdpMLineIndex,usernameFragment:f.candidate.usernameFragment}};h=g.getMediaSections(d._localDescription.sdp);h[f.candidate.sdpMLineIndex]=c?h[f.candidate.sdpMLineIndex]+"a\x3dend-of-candidates\r\n":
h[f.candidate.sdpMLineIndex]+("a\x3d"+f.candidate.candidate+"\r\n");d._localDescription.sdp=g.getDescription(d._localDescription.sdp)+h.join("");h=d.transceivers.every(function(a){return a.iceGatherer&&"completed"===a.iceGatherer.state});"gathering"!==d.iceGatheringState&&(d.iceGatheringState="gathering",d._emitGatheringStateChange());c||d._dispatchEvent("icecandidate",f);h&&(d._dispatchEvent("icecandidate",new Event("icecandidate")),d.iceGatheringState="complete",d._emitGatheringStateChange())}};
c.setTimeout(function(){f.forEach(function(a){e.onlocalcandidate(a)})},0)}};p.prototype._createIceAndDtlsTransports=function(){var a=this,b=new c.RTCIceTransport(null);b.onicestatechange=function(){a._updateIceConnectionState();a._updateConnectionState()};var d=new c.RTCDtlsTransport(b);d.ondtlsstatechange=function(){a._updateConnectionState()};d.onerror=function(){Object.defineProperty(d,"state",{value:"failed",writable:!0});a._updateConnectionState()};return{iceTransport:b,dtlsTransport:d}};p.prototype._disposeIceAndDtlsTransports=
function(a){var b=this.transceivers[a].iceGatherer;b&&(delete b.onlocalcandidate,delete this.transceivers[a].iceGatherer);if(b=this.transceivers[a].iceTransport)delete b.onicestatechange,delete this.transceivers[a].iceTransport;if(b=this.transceivers[a].dtlsTransport)delete b.ondtlsstatechange,delete b.onerror,delete this.transceivers[a].dtlsTransport};p.prototype._transceive=function(a,b,c){var e=k(a.localCapabilities,a.remoteCapabilities);b&&a.rtpSender&&(e.encodings=a.sendEncodingParameters,e.rtcp=
{cname:g.localCName,compound:a.rtcpParameters.compound},a.recvEncodingParameters.length&&(e.rtcp.ssrc=a.recvEncodingParameters[0].ssrc),a.rtpSender.send(e));c&&a.rtpReceiver&&0<e.codecs.length&&("video"===a.kind&&a.recvEncodingParameters&&15019>d&&a.recvEncodingParameters.forEach(function(a){delete a.rtx}),e.encodings=a.recvEncodingParameters.length?a.recvEncodingParameters:[{}],e.rtcp={compound:a.rtcpParameters.compound},a.rtcpParameters.cname&&(e.rtcp.cname=a.rtcpParameters.cname),a.sendEncodingParameters.length&&
(e.rtcp.ssrc=a.sendEncodingParameters[0].ssrc),a.rtpReceiver.receive(e))};p.prototype.setLocalDescription=function(a){var b=this;if(-1===["offer","answer"].indexOf(a.type))return Promise.reject(l("TypeError",'Unsupported type "'+a.type+'"'));if(!e("setLocalDescription",a.type,b.signalingState)||b._isClosed)return Promise.reject(l("InvalidStateError","Can not set local "+a.type+" in state "+b.signalingState));if("offer"===a.type){var c=g.splitSections(a.sdp);var d=c.shift();c.forEach(function(a,c){a=
g.parseRtpParameters(a);b.transceivers[c].localCapabilities=a});b.transceivers.forEach(function(a,c){b._gather(a.mid,c)})}else if("answer"===a.type){c=g.splitSections(b._remoteDescription.sdp);d=c.shift();var f=0<g.matchPrefix(d,"a\x3dice-lite").length;c.forEach(function(a,c){var e=b.transceivers[c],h=e.iceGatherer,l=e.iceTransport,n=e.dtlsTransport,p=e.localCapabilities,m=e.remoteCapabilities;if(!(g.isRejected(a)&&0===g.matchPrefix(a,"a\x3dbundle-only").length||e.rejected)){var q=g.getIceParameters(a,
d);a=g.getDtlsParameters(a,d);f&&(a.role="server");b.usingBundle&&0!==c||(b._gather(e.mid,c),"new"===l.state&&l.start(h,q,f?"controlling":"controlled"),"new"===n.state&&n.start(a));c=k(p,m);b._transceive(e,0<c.codecs.length,!1)}})}b._localDescription={type:a.type,sdp:a.sdp};"offer"===a.type?b._updateSignalingState("have-local-offer"):b._updateSignalingState("stable");return Promise.resolve()};p.prototype.setRemoteDescription=function(a){var b=this;if(-1===["offer","answer"].indexOf(a.type))return Promise.reject(l("TypeError",
'Unsupported type "'+a.type+'"'));if(!e("setRemoteDescription",a.type,b.signalingState)||b._isClosed)return Promise.reject(l("InvalidStateError","Can not set remote "+a.type+" in state "+b.signalingState));var p={};b.remoteStreams.forEach(function(a){p[a.id]=a});var q=[],v=g.splitSections(a.sdp),r=v.shift(),t=0<g.matchPrefix(r,"a\x3dice-lite").length,w=0<g.matchPrefix(r,"a\x3dgroup:BUNDLE ").length;b.usingBundle=w;var u=g.matchPrefix(r,"a\x3dice-options:")[0];b.canTrickleIceCandidates=u?0<=u.substr(14).split(" ").indexOf("trickle"):
!1;v.forEach(function(e,l){var n=g.splitLines(e),v=g.getKind(e),z=g.isRejected(e)&&0===g.matchPrefix(e,"a\x3dbundle-only").length,A=n[0].substr(2).split(" ")[2],n=g.getDirection(e,r),u=g.parseMsid(e),x=g.getMid(e)||g.generateIdentifier();if(z||"application"===v&&("DTLS/SCTP"===A||"UDP/DTLS/SCTP"===A))b.transceivers[l]={mid:x,kind:v,protocol:A,rejected:!0};else{!z&&b.transceivers[l]&&b.transceivers[l].rejected&&(b.transceivers[l]=b._createTransceiver(v,!0));var y=g.parseRtpParameters(e);if(!z){var C=
g.getIceParameters(e,r);var F=g.getDtlsParameters(e,r);F.role="client"}var A=g.parseRtpEncodingParameters(e),G=g.parseRtcpParameters(e),I=0<g.matchPrefix(e,"a\x3dend-of-candidates",r).length,E=g.matchPrefix(e,"a\x3dcandidate:").map(function(a){return g.parseCandidate(a)}).filter(function(a){return 1===a.component});("offer"===a.type||"answer"===a.type)&&!z&&w&&0<l&&b.transceivers[l]&&(b._disposeIceAndDtlsTransports(l),b.transceivers[l].iceGatherer=b.transceivers[0].iceGatherer,b.transceivers[l].iceTransport=
b.transceivers[0].iceTransport,b.transceivers[l].dtlsTransport=b.transceivers[0].dtlsTransport,b.transceivers[l].rtpSender&&b.transceivers[l].rtpSender.setTransport(b.transceivers[0].dtlsTransport),b.transceivers[l].rtpReceiver&&b.transceivers[l].rtpReceiver.setTransport(b.transceivers[0].dtlsTransport));if("offer"!==a.type||z)"answer"!==a.type||z||(B=b.transceivers[l],H=B.iceGatherer,v=B.iceTransport,x=B.dtlsTransport,D=B.rtpReceiver,z=B.sendEncodingParameters,e=B.localCapabilities,b.transceivers[l].recvEncodingParameters=
A,b.transceivers[l].remoteCapabilities=y,b.transceivers[l].rtcpParameters=G,E.length&&"new"===v.state&&(!t&&!I||w&&0!==l?E.forEach(function(a){m(B.iceTransport,a)}):v.setRemoteCandidates(E)),w&&0!==l||("new"===v.state&&v.start(H,C,"controlling"),"new"===x.state&&x.start(F)),!k(B.localCapabilities,B.remoteCapabilities).codecs.filter(function(a){return"rtx"===a.name.toLowerCase()}).length&&B.sendEncodingParameters[0].rtx&&delete B.sendEncodingParameters[0].rtx,b._transceive(B,"sendrecv"===n||"recvonly"===
n,"sendrecv"===n||"sendonly"===n),!D||"sendrecv"!==n&&"sendonly"!==n?delete B.rtpReceiver:(n=D.track,u?(p[u.stream]||(p[u.stream]=new c.MediaStream),f(n,p[u.stream]),q.push([n,D,p[u.stream]])):(p.default||(p.default=new c.MediaStream),f(n,p.default),q.push([n,D,p.default]))));else{var B=b.transceivers[l]||b._createTransceiver(v);B.mid=x;B.iceGatherer||(B.iceGatherer=b._createIceGatherer(l,w));E.length&&"new"===B.iceTransport.state&&(!I||w&&0!==l?E.forEach(function(a){m(B.iceTransport,a)}):B.iceTransport.setRemoteCandidates(E));
e=c.RTCRtpReceiver.getCapabilities(v);15019>d&&(e.codecs=e.codecs.filter(function(a){return"rtx"!==a.name}));z=B.sendEncodingParameters||[{ssrc:1001*(2*l+2)}];C=!1;if("sendrecv"===n||"sendonly"===n){C=!B.rtpReceiver;var D=B.rtpReceiver||new c.RTCRtpReceiver(B.dtlsTransport,v);if(C){n=D.track;if(!u||"-"!==u.stream)if(u){p[u.stream]||(p[u.stream]=new c.MediaStream,Object.defineProperty(p[u.stream],"id",{get:function(){return u.stream}}));Object.defineProperty(n,"id",{get:function(){return u.track}});
var H=p[u.stream]}else p.default||(p.default=new c.MediaStream),H=p.default;H&&(f(n,H),B.associatedRemoteMediaStreams.push(H));q.push([n,D,H])}}else B.rtpReceiver&&B.rtpReceiver.track&&(B.associatedRemoteMediaStreams.forEach(function(a){var b=a.getTracks().find(function(a){return a.id===B.rtpReceiver.track.id});b&&h(b,a)}),B.associatedRemoteMediaStreams=[]);B.localCapabilities=e;B.remoteCapabilities=y;B.rtpReceiver=D;B.rtcpParameters=G;B.sendEncodingParameters=z;B.recvEncodingParameters=A;b._transceive(b.transceivers[l],
!1,C)}}});void 0===b._dtlsRole&&(b._dtlsRole="offer"===a.type?"active":"passive");b._remoteDescription={type:a.type,sdp:a.sdp};"offer"===a.type?b._updateSignalingState("have-remote-offer"):b._updateSignalingState("stable");Object.keys(p).forEach(function(a){var d=p[a];if(d.getTracks().length){if(-1===b.remoteStreams.indexOf(d)){b.remoteStreams.push(d);var e=new Event("addstream");e.stream=d;c.setTimeout(function(){b._dispatchEvent("addstream",e)})}q.forEach(function(a){d.id===a[2].id&&n(b,a[0],a[1],
[d])})}});q.forEach(function(a){a[2]||n(b,a[0],a[1],[])});c.setTimeout(function(){b&&b.transceivers&&b.transceivers.forEach(function(a){a.iceTransport&&"new"===a.iceTransport.state&&0<a.iceTransport.getRemoteCandidates().length&&(console.warn("Timeout for addRemoteCandidate. Consider sending an end-of-candidates notification"),a.iceTransport.addRemoteCandidate({}))})},4E3);return Promise.resolve()};p.prototype.close=function(){this.transceivers.forEach(function(a){a.iceTransport&&a.iceTransport.stop();
a.dtlsTransport&&a.dtlsTransport.stop();a.rtpSender&&a.rtpSender.stop();a.rtpReceiver&&a.rtpReceiver.stop()});this._isClosed=!0;this._updateSignalingState("closed")};p.prototype._updateSignalingState=function(a){this.signalingState=a;a=new Event("signalingstatechange");this._dispatchEvent("signalingstatechange",a)};p.prototype._maybeFireNegotiationNeeded=function(){var a=this;"stable"===this.signalingState&&!0!==this.needNegotiation&&(this.needNegotiation=!0,c.setTimeout(function(){if(a.needNegotiation){a.needNegotiation=
!1;var b=new Event("negotiationneeded");a._dispatchEvent("negotiationneeded",b)}},0))};p.prototype._updateIceConnectionState=function(){var a={"new":0,closed:0,checking:0,connected:0,completed:0,disconnected:0,failed:0};this.transceivers.forEach(function(b){b.iceTransport&&!b.rejected&&a[b.iceTransport.state]++});var b="new";0<a.failed?b="failed":0<a.checking?b="checking":0<a.disconnected?b="disconnected":0<a.new?b="new":0<a.connected?b="connected":0<a.completed&&(b="completed");b!==this.iceConnectionState&&
(this.iceConnectionState=b,b=new Event("iceconnectionstatechange"),this._dispatchEvent("iceconnectionstatechange",b))};p.prototype._updateConnectionState=function(){var a={"new":0,closed:0,connecting:0,connected:0,completed:0,disconnected:0,failed:0};this.transceivers.forEach(function(b){b.iceTransport&&b.dtlsTransport&&!b.rejected&&(a[b.iceTransport.state]++,a[b.dtlsTransport.state]++)});a.connected+=a.completed;var b="new";0<a.failed?b="failed":0<a.connecting?b="connecting":0<a.disconnected?b="disconnected":
0<a.new?b="new":0<a.connected&&(b="connected");b!==this.connectionState&&(this.connectionState=b,b=new Event("connectionstatechange"),this._dispatchEvent("connectionstatechange",b))};p.prototype.createOffer=function(b){var e=this;if(e._isClosed)return Promise.reject(l("InvalidStateError","Can not call createOffer after close"));var f=e.transceivers.filter(function(a){return"audio"===a.kind}).length,h=e.transceivers.filter(function(a){return"video"===a.kind}).length;if(b){if(b.mandatory||b.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");
void 0!==b.offerToReceiveAudio&&(f=!0===b.offerToReceiveAudio?1:!1===b.offerToReceiveAudio?0:b.offerToReceiveAudio);void 0!==b.offerToReceiveVideo&&(h=!0===b.offerToReceiveVideo?1:!1===b.offerToReceiveVideo?0:b.offerToReceiveVideo)}for(e.transceivers.forEach(function(a){"audio"===a.kind?(f--,0>f&&(a.wantReceive=!1)):"video"===a.kind&&(h--,0>h&&(a.wantReceive=!1))});0<f||0<h;)0<f&&(e._createTransceiver("audio"),f--),0<h&&(e._createTransceiver("video"),h--);var k=g.writeSessionBoilerplate(e._sdpSessionId,
e._sdpSessionVersion++);e.transceivers.forEach(function(a,b){var f=a.track,h=a.kind,k=a.mid||g.generateIdentifier();a.mid=k;a.iceGatherer||(a.iceGatherer=e._createIceGatherer(b,e.usingBundle));k=c.RTCRtpSender.getCapabilities(h);15019>d&&(k.codecs=k.codecs.filter(function(a){return"rtx"!==a.name}));k.codecs.forEach(function(b){"H264"===b.name&&void 0===b.parameters["level-asymmetry-allowed"]&&(b.parameters["level-asymmetry-allowed"]="1");a.remoteCapabilities&&a.remoteCapabilities.codecs&&a.remoteCapabilities.codecs.forEach(function(a){b.name.toLowerCase()===
a.name.toLowerCase()&&b.clockRate===a.clockRate&&(b.preferredPayloadType=a.payloadType)})});k.headerExtensions.forEach(function(b){(a.remoteCapabilities&&a.remoteCapabilities.headerExtensions||[]).forEach(function(a){b.uri===a.uri&&(b.id=a.id)})});b=a.sendEncodingParameters||[{ssrc:1001*(2*b+1)}];f&&15019<=d&&"video"===h&&!b[0].rtx&&(b[0].rtx={ssrc:b[0].ssrc+1});a.wantReceive&&(a.rtpReceiver=new c.RTCRtpReceiver(a.dtlsTransport,h));a.localCapabilities=k;a.sendEncodingParameters=b});"max-compat"!==
e._config.bundlePolicy&&(k+="a\x3dgroup:BUNDLE "+e.transceivers.map(function(a){return a.mid}).join(" ")+"\r\n");k+="a\x3dice-options:trickle\r\n";e.transceivers.forEach(function(b,c){k+=a(b,b.localCapabilities,"offer",b.stream,e._dtlsRole);k+="a\x3drtcp-rsize\r\n";!b.iceGatherer||"new"===e.iceGatheringState||0!==c&&e.usingBundle||(b.iceGatherer.getLocalCandidates().forEach(function(a){a.component=1;k+="a\x3d"+g.writeCandidate(a)+"\r\n"}),"completed"===b.iceGatherer.state&&(k+="a\x3dend-of-candidates\r\n"))});
b=new c.RTCSessionDescription({type:"offer",sdp:k});return Promise.resolve(b)};p.prototype.createAnswer=function(){var b=this;if(b._isClosed)return Promise.reject(l("InvalidStateError","Can not call createAnswer after close"));if("have-remote-offer"!==b.signalingState&&"have-local-pranswer"!==b.signalingState)return Promise.reject(l("InvalidStateError","Can not call createAnswer in signalingState "+b.signalingState));var e=g.writeSessionBoilerplate(b._sdpSessionId,b._sdpSessionVersion++);b.usingBundle&&
(e+="a\x3dgroup:BUNDLE "+b.transceivers.map(function(a){return a.mid}).join(" ")+"\r\n");var e=e+"a\x3dice-options:trickle\r\n",f=g.getMediaSections(b._remoteDescription.sdp).length;b.transceivers.forEach(function(c,g){if(!(g+1>f))if(c.rejected)"application"===c.kind?e="DTLS/SCTP"===c.protocol?e+"m\x3dapplication 0 DTLS/SCTP 5000\r\n":e+("m\x3dapplication 0 "+c.protocol+" webrtc-datachannel\r\n"):"audio"===c.kind?e+="m\x3daudio 0 UDP/TLS/RTP/SAVPF 0\r\na\x3drtpmap:0 PCMU/8000\r\n":"video"===c.kind&&
(e+="m\x3dvideo 0 UDP/TLS/RTP/SAVPF 120\r\na\x3drtpmap:120 VP8/90000\r\n"),e+="c\x3dIN IP4 0.0.0.0\r\na\x3dinactive\r\na\x3dmid:"+c.mid+"\r\n";else{if(c.stream){var h;"audio"===c.kind?h=c.stream.getAudioTracks()[0]:"video"===c.kind&&(h=c.stream.getVideoTracks()[0]);h&&15019<=d&&"video"===c.kind&&!c.sendEncodingParameters[0].rtx&&(c.sendEncodingParameters[0].rtx={ssrc:c.sendEncodingParameters[0].ssrc+1})}g=k(c.localCapabilities,c.remoteCapabilities);!g.codecs.filter(function(a){return"rtx"===a.name.toLowerCase()}).length&&
c.sendEncodingParameters[0].rtx&&delete c.sendEncodingParameters[0].rtx;e+=a(c,g,"answer",c.stream,b._dtlsRole);c.rtcpParameters&&c.rtcpParameters.reducedSize&&(e+="a\x3drtcp-rsize\r\n")}});var h=new c.RTCSessionDescription({type:"answer",sdp:e});return Promise.resolve(h)};p.prototype.addIceCandidate=function(a){var b=this,c;return a&&void 0===a.sdpMLineIndex&&!a.sdpMid?Promise.reject(new TypeError("sdpMLineIndex or sdpMid required")):new Promise(function(d,e){if(b._remoteDescription)if(a&&""!==a.candidate){var f=
a.sdpMLineIndex;if(a.sdpMid)for(var h=0;h<b.transceivers.length;h++)if(b.transceivers[h].mid===a.sdpMid){f=h;break}var k=b.transceivers[f];if(k){if(k.rejected)return d();h=0<Object.keys(a.candidate).length?g.parseCandidate(a.candidate):{};if("tcp"===h.protocol&&(0===h.port||9===h.port)||h.component&&1!==h.component)return d();if((0===f||0<f&&k.iceTransport!==b.transceivers[0].iceTransport)&&!m(k.iceTransport,h))return e(l("OperationError","Can not add ICE candidate"));e=a.candidate.trim();0===e.indexOf("a\x3d")&&
(e=e.substr(2));c=g.getMediaSections(b._remoteDescription.sdp);c[f]+="a\x3d"+(h.type?e:"end-of-candidates")+"\r\n";b._remoteDescription.sdp=g.getDescription(b._remoteDescription.sdp)+c.join("")}else return e(l("OperationError","Can not add ICE candidate"))}else for(f=0;f<b.transceivers.length&&(b.transceivers[f].rejected||(b.transceivers[f].iceTransport.addRemoteCandidate({}),c=g.getMediaSections(b._remoteDescription.sdp),c[f]+="a\x3dend-of-candidates\r\n",b._remoteDescription.sdp=g.getDescription(b._remoteDescription.sdp)+
c.join(""),!b.usingBundle));f++);else return e(l("InvalidStateError","Can not add ICE candidate without a remote description"));d()})};p.prototype.getStats=function(a){if(a&&a instanceof c.MediaStreamTrack){var b=null;this.transceivers.forEach(function(c){c.rtpSender&&c.rtpSender.track===a?b=c.rtpSender:c.rtpReceiver&&c.rtpReceiver.track===a&&(b=c.rtpReceiver)});if(!b)throw l("InvalidAccessError","Invalid selector.");return b.getStats()}var d=[];this.transceivers.forEach(function(a){["rtpSender",
"rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach(function(b){a[b]&&d.push(a[b].getStats())})});return Promise.all(d).then(function(a){var b=new Map;a.forEach(function(a){a.forEach(function(a){b.set(a.id,a)})});return b})};["RTCRtpSender","RTCRtpReceiver","RTCIceGatherer","RTCIceTransport","RTCDtlsTransport"].forEach(function(a){if((a=c[a])&&a.prototype&&a.prototype.getStats){var b=a.prototype.getStats;a.prototype.getStats=function(){return b.apply(this).then(function(a){var b=new Map;
Object.keys(a).forEach(function(c){var d=a[c];a[c].type={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[d.type]||d.type;b.set(c,a[c])});return b})}}});var r=["createOffer","createAnswer"];r.forEach(function(a){var b=p.prototype[a];p.prototype[a]=function(){var a=arguments;return"function"===typeof a[0]||"function"===typeof a[1]?b.apply(this,[arguments[2]]).then(function(b){"function"===typeof a[0]&&
a[0].apply(null,[b])},function(b){"function"===typeof a[1]&&a[1].apply(null,[b])}):b.apply(this,arguments)}});r=["setLocalDescription","setRemoteDescription","addIceCandidate"];r.forEach(function(a){var b=p.prototype[a];p.prototype[a]=function(){var a=arguments;return"function"===typeof a[1]||"function"===typeof a[2]?b.apply(this,arguments).then(function(){"function"===typeof a[1]&&a[1].apply(null)},function(b){"function"===typeof a[2]&&a[2].apply(null,[b])}):b.apply(this,arguments)}});["getStats"].forEach(function(a){var b=
p.prototype[a];p.prototype[a]=function(){var a=arguments;return"function"===typeof a[1]?b.apply(this,arguments).then(function(){"function"===typeof a[1]&&a[1].apply(null)}):b.apply(this,arguments)}});return p}},{sdp:17}],17:[function(f,h,d){var a={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};a.localCName=a.generateIdentifier();a.splitLines=function(a){return a.trim().split("\n").map(function(a){return a.trim()})};a.splitSections=function(a){return a.split("\nm\x3d").map(function(a,
b){return(0<b?"m\x3d"+a:a).trim()+"\r\n"})};a.getDescription=function(b){return(b=a.splitSections(b))&&b[0]};a.getMediaSections=function(b){b=a.splitSections(b);b.shift();return b};a.matchPrefix=function(b,d){return a.splitLines(b).filter(function(a){return 0===a.indexOf(d)})};a.parseCandidate=function(a){a=0===a.indexOf("a\x3dcandidate:")?a.substring(12).split(" "):a.substring(10).split(" ");for(var b={foundation:a[0],component:parseInt(a[1],10),protocol:a[2].toLowerCase(),priority:parseInt(a[3],
10),ip:a[4],address:a[4],port:parseInt(a[5],10),type:a[7]},d=8;d<a.length;d+=2)switch(a[d]){case "raddr":b.relatedAddress=a[d+1];break;case "rport":b.relatedPort=parseInt(a[d+1],10);break;case "tcptype":b.tcpType=a[d+1];break;case "ufrag":b.ufrag=a[d+1];b.usernameFragment=a[d+1];break;default:b[a[d]]=a[d+1]}return b};a.writeCandidate=function(a){var b=[];b.push(a.foundation);b.push(a.component);b.push(a.protocol.toUpperCase());b.push(a.priority);b.push(a.address||a.ip);b.push(a.port);var d=a.type;
b.push("typ");b.push(d);"host"!==d&&a.relatedAddress&&a.relatedPort&&(b.push("raddr"),b.push(a.relatedAddress),b.push("rport"),b.push(a.relatedPort));a.tcpType&&"tcp"===a.protocol.toLowerCase()&&(b.push("tcptype"),b.push(a.tcpType));if(a.usernameFragment||a.ufrag)b.push("ufrag"),b.push(a.usernameFragment||a.ufrag);return"candidate:"+b.join(" ")};a.parseIceOptions=function(a){return a.substr(14).split(" ")};a.parseRtpMap=function(a){a=a.substr(9).split(" ");var b={payloadType:parseInt(a.shift(),10)};
a=a[0].split("/");b.name=a[0];b.clockRate=parseInt(a[1],10);b.channels=3===a.length?parseInt(a[2],10):1;b.numChannels=b.channels;return b};a.writeRtpMap=function(a){var b=a.payloadType;void 0!==a.preferredPayloadType&&(b=a.preferredPayloadType);var d=a.channels||a.numChannels||1;return"a\x3drtpmap:"+b+" "+a.name+"/"+a.clockRate+(1!==d?"/"+d:"")+"\r\n"};a.parseExtmap=function(a){a=a.substr(9).split(" ");return{id:parseInt(a[0],10),direction:0<a[0].indexOf("/")?a[0].split("/")[1]:"sendrecv",uri:a[1]}};
a.writeExtmap=function(a){return"a\x3dextmap:"+(a.id||a.preferredId)+(a.direction&&"sendrecv"!==a.direction?"/"+a.direction:"")+" "+a.uri+"\r\n"};a.parseFmtp=function(a){for(var b={},d=a.substr(a.indexOf(" ")+1).split(";"),f=0;f<d.length;f++)a=d[f].trim().split("\x3d"),b[a[0].trim()]=a[1];return b};a.writeFmtp=function(a){var b="",d=a.payloadType;void 0!==a.preferredPayloadType&&(d=a.preferredPayloadType);if(a.parameters&&Object.keys(a.parameters).length){var f=[];Object.keys(a.parameters).forEach(function(b){a.parameters[b]?
f.push(b+"\x3d"+a.parameters[b]):f.push(b)});b+="a\x3dfmtp:"+d+" "+f.join(";")+"\r\n"}return b};a.parseRtcpFb=function(a){a=a.substr(a.indexOf(" ")+1).split(" ");return{type:a.shift(),parameter:a.join(" ")}};a.writeRtcpFb=function(a){var b="",d=a.payloadType;void 0!==a.preferredPayloadType&&(d=a.preferredPayloadType);a.rtcpFeedback&&a.rtcpFeedback.length&&a.rtcpFeedback.forEach(function(a){b+="a\x3drtcp-fb:"+d+" "+a.type+(a.parameter&&a.parameter.length?" "+a.parameter:"")+"\r\n"});return b};a.parseSsrcMedia=
function(a){var b=a.indexOf(" "),d={ssrc:parseInt(a.substr(7,b-7),10)},f=a.indexOf(":",b);-1<f?(d.attribute=a.substr(b+1,f-b-1),d.value=a.substr(f+1)):d.attribute=a.substr(b+1);return d};a.parseSsrcGroup=function(a){a=a.substr(13).split(" ");return{semantics:a.shift(),ssrcs:a.map(function(a){return parseInt(a,10)})}};a.getMid=function(b){if(b=a.matchPrefix(b,"a\x3dmid:")[0])return b.substr(6)};a.parseFingerprint=function(a){a=a.substr(14).split(" ");return{algorithm:a[0].toLowerCase(),value:a[1]}};
a.getDtlsParameters=function(b,d){return{role:"auto",fingerprints:a.matchPrefix(b+d,"a\x3dfingerprint:").map(a.parseFingerprint)}};a.writeDtlsParameters=function(a,d){var b="a\x3dsetup:"+d+"\r\n";a.fingerprints.forEach(function(a){b+="a\x3dfingerprint:"+a.algorithm+" "+a.value+"\r\n"});return b};a.getIceParameters=function(b,d){b=a.splitLines(b);b=b.concat(a.splitLines(d));return{usernameFragment:b.filter(function(a){return 0===a.indexOf("a\x3dice-ufrag:")})[0].substr(12),password:b.filter(function(a){return 0===
a.indexOf("a\x3dice-pwd:")})[0].substr(10)}};a.writeIceParameters=function(a){return"a\x3dice-ufrag:"+a.usernameFragment+"\r\na\x3dice-pwd:"+a.password+"\r\n"};a.parseRtpParameters=function(b){for(var d={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},e=a.splitLines(b)[0].split(" "),f=3;f<e.length;f++){var h=e[f],g=a.matchPrefix(b,"a\x3drtpmap:"+h+" ")[0];if(g){var g=a.parseRtpMap(g),c=a.matchPrefix(b,"a\x3dfmtp:"+h+" ");g.parameters=c.length?a.parseFmtp(c[0]):{};g.rtcpFeedback=a.matchPrefix(b,
"a\x3drtcp-fb:"+h+" ").map(a.parseRtcpFb);d.codecs.push(g);switch(g.name.toUpperCase()){case "RED":case "ULPFEC":d.fecMechanisms.push(g.name.toUpperCase())}}}a.matchPrefix(b,"a\x3dextmap:").forEach(function(b){d.headerExtensions.push(a.parseExtmap(b))});return d};a.writeRtpDescription=function(b,d){var e="",e=e+("m\x3d"+b+" "),e=e+(0<d.codecs.length?"9":"0"),e=e+" UDP/TLS/RTP/SAVPF ",e=e+(d.codecs.map(function(a){return void 0!==a.preferredPayloadType?a.preferredPayloadType:a.payloadType}).join(" ")+
"\r\n"),e=e+"c\x3dIN IP4 0.0.0.0\r\n",e=e+"a\x3drtcp:9 IN IP4 0.0.0.0\r\n";d.codecs.forEach(function(b){e+=a.writeRtpMap(b);e+=a.writeFmtp(b);e+=a.writeRtcpFb(b)});var f=0;d.codecs.forEach(function(a){a.maxptime>f&&(f=a.maxptime)});0<f&&(e+="a\x3dmaxptime:"+f+"\r\n");e+="a\x3drtcp-mux\r\n";d.headerExtensions&&d.headerExtensions.forEach(function(b){e+=a.writeExtmap(b)});return e};a.parseRtpEncodingParameters=function(b){var d=[],e=a.parseRtpParameters(b),f=-1!==e.fecMechanisms.indexOf("RED"),h=-1!==
e.fecMechanisms.indexOf("ULPFEC"),g=a.matchPrefix(b,"a\x3dssrc:").map(function(b){return a.parseSsrcMedia(b)}).filter(function(a){return"cname"===a.attribute}),c=0<g.length&&g[0].ssrc,k,g=a.matchPrefix(b,"a\x3dssrc-group:FID").map(function(a){return a.substr(17).split(" ").map(function(a){return parseInt(a,10)})});0<g.length&&1<g[0].length&&g[0][0]===c&&(k=g[0][1]);e.codecs.forEach(function(a){"RTX"===a.name.toUpperCase()&&a.parameters.apt&&(a={ssrc:c,codecPayloadType:parseInt(a.parameters.apt,10)},
c&&k&&(a.rtx={ssrc:k}),d.push(a),f&&(a=JSON.parse(JSON.stringify(a)),a.fec={ssrc:c,mechanism:h?"red+ulpfec":"red"},d.push(a)))});0===d.length&&c&&d.push({ssrc:c});var m=a.matchPrefix(b,"b\x3d");m.length&&(m=0===m[0].indexOf("b\x3dTIAS:")?parseInt(m[0].substr(7),10):0===m[0].indexOf("b\x3dAS:")?950*parseInt(m[0].substr(5),10)-16E3:void 0,d.forEach(function(a){a.maxBitrate=m}));return d};a.parseRtcpParameters=function(b){var d={},e=a.matchPrefix(b,"a\x3dssrc:").map(function(b){return a.parseSsrcMedia(b)}).filter(function(a){return"cname"===
a.attribute})[0];e&&(d.cname=e.value,d.ssrc=e.ssrc);e=a.matchPrefix(b,"a\x3drtcp-rsize");d.reducedSize=0<e.length;d.compound=0===e.length;b=a.matchPrefix(b,"a\x3drtcp-mux");d.mux=0<b.length;return d};a.parseMsid=function(b){var d=a.matchPrefix(b,"a\x3dmsid:");if(1===d.length)return b=d[0].substr(7).split(" "),{stream:b[0],track:b[1]};b=a.matchPrefix(b,"a\x3dssrc:").map(function(b){return a.parseSsrcMedia(b)}).filter(function(a){return"msid"===a.attribute});if(0<b.length)return b=b[0].value.split(" "),
{stream:b[0],track:b[1]}};a.generateSessionId=function(){return Math.random().toString().substr(2,21)};a.writeSessionBoilerplate=function(b,d,e){d=void 0!==d?d:2;b=b?b:a.generateSessionId();return"v\x3d0\r\no\x3d"+(e||"thisisadapterortc")+" "+b+" "+d+" IN IP4 127.0.0.1\r\ns\x3d-\r\nt\x3d0 0\r\n"};a.writeMediaSection=function(b,d,e,f){d=a.writeRtpDescription(b.kind,d);d+=a.writeIceParameters(b.iceGatherer.getLocalParameters());d+=a.writeDtlsParameters(b.dtlsTransport.getLocalParameters(),"offer"===
e?"actpass":"active");d+="a\x3dmid:"+b.mid+"\r\n";d=b.direction?d+("a\x3d"+b.direction+"\r\n"):b.rtpSender&&b.rtpReceiver?d+"a\x3dsendrecv\r\n":b.rtpSender?d+"a\x3dsendonly\r\n":b.rtpReceiver?d+"a\x3drecvonly\r\n":d+"a\x3dinactive\r\n";b.rtpSender&&(e="msid:"+f.id+" "+b.rtpSender.track.id+"\r\n",d=d+("a\x3d"+e)+("a\x3dssrc:"+b.sendEncodingParameters[0].ssrc+" "+e),b.sendEncodingParameters[0].rtx&&(d+="a\x3dssrc:"+b.sendEncodingParameters[0].rtx.ssrc+" "+e,d+="a\x3dssrc-group:FID "+b.sendEncodingParameters[0].ssrc+
" "+b.sendEncodingParameters[0].rtx.ssrc+"\r\n"));d+="a\x3dssrc:"+b.sendEncodingParameters[0].ssrc+" cname:"+a.localCName+"\r\n";b.rtpSender&&b.sendEncodingParameters[0].rtx&&(d+="a\x3dssrc:"+b.sendEncodingParameters[0].rtx.ssrc+" cname:"+a.localCName+"\r\n");return d};a.getDirection=function(b,d){b=a.splitLines(b);for(var e=0;e<b.length;e++)switch(b[e]){case "a\x3dsendrecv":case "a\x3dsendonly":case "a\x3drecvonly":case "a\x3dinactive":return b[e].substr(2)}return d?a.getDirection(d):"sendrecv"};
a.getKind=function(b){return a.splitLines(b)[0].split(" ")[0].substr(2)};a.isRejected=function(a){return"0"===a.split(" ",2)[1]};a.parseMLine=function(b){b=a.splitLines(b)[0].substr(2).split(" ");return{kind:b[0],port:parseInt(b[1],10),protocol:b[2],fmt:b.slice(3).join(" ")}};a.parseOLine=function(b){b=a.matchPrefix(b,"o\x3d")[0].substr(2).split(" ");return{username:b[0],sessionId:b[1],sessionVersion:parseInt(b[2],10),netType:b[3],addressType:b[4],address:b[5]}};a.isValidSDP=function(b){if("string"!==
typeof b||0===b.length)return!1;b=a.splitLines(b);for(var d=0;d<b.length;d++)if(2>b[d].length||"\x3d"!==b[d].charAt(1))return!1;return!0};"object"===typeof h&&(h.exports=a)},{}]},{},[1])(1)}()}])["default"];
//# sourceMappingURL=erizo.js.map
